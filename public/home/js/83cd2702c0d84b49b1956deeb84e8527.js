ec.pkg("ec.product.remark");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});ec.remark={};ec.remark.prefix=domainRms+"/comment";var loadEvaluate=false;var bFirstLoadEvaluate=false;var pageSize=10;ec.product.remark.loadEvaluate=function(a){new ec.ajax().get({url:domainRms+"/comment/getCommentList.json?t="+new Date().getTime(),data:{pid:ec.product.id,type:a.type?a.type:0,extraType:a.extraType?a.extraType:1,pageSize:pageSize,pageNum:a.pageNumber},dataType:"jsonp",successFunction:function(r){if(r.resultCode!="0"){commentFlag=true;$("#pro-tab-evaluate").hide();return}if(!r.data.comments||r.data.comments.length==0){commentFlag=true;$("#pro-tab-evaluate span").html("("+r.data.count+")");$("#pro-tab-evaluate").show();$("#pro-msg-list").hide();$("#pro-msg-pager").hide();$("#evaluatePageNumber").hide();$("#product-remark-comment-no").show();return}commentFlag=false;$("#pro-tab-evaluate-content").show();$("#productCommentId").show();$("#pro-tab-evaluate").show();$("#product-remark-comment-no").hide();loadEvaluate=true;var f=[],b,o;for(var e=0;e<r.data.comments.length;e++){b=r.data.comments[e];f.push('<li class="clearfix"><div class="product-comment-user"><p class="product-comment-user-img">');var m=imagePath+"/echannel/misc/defaultface_user_small.png";if(b.headImage&&$.trim(b.headImage)!=""){m=b.headImage}f.push('<img src="'+m+'" alt="'+m+'">');var c=b.gradeCode==null?0:b.gradeCode;f.push('<i class="icon-vip-level-'+c+'"></i></p>');f.push('<p class="product-comment-user-name">'+ec.util.escapeHtml(b.userName)+"</p></div>");f.push('<div class="product-user-comment"><div class="product-user-comment-detial"><div class="h clearfix">');f.push('<div class="product-star"><span class="starRating-area"><s style="width:'+(b.score*20)+'%"></s></span>');f.push('</div><div class="product-user-comment-impress">');f.push("<dl>");for(var d=0;d<b.tags.length;d++){f.push("<dd>"+ec.util.escapeHtml(b.tags[d])+"</dd>")}f.push("</dl></div>");var n=b.likes;if(!n||n==null||$.trim(n)==""){n=0}f.push('<div class="fr"><a href="javascript:;" class="product-praise-btn" pid="'+b.productId+'" commentId="'+b.commentId+'" type="0"><span>'+parseInt(n)+"</span></a></div>");f.push("</div>");f.push('<div class="product-user-comment-word" id="'+b.productId+"-"+b.commentId+'">');f.push((ec.util.escapeHtml(b.content)||""));f.push("</div>");if(b.images.length>0){f.push('<div class="user-comment-img">                           ');f.push('	<p class="img-small clearfix">                                  ');for(var d=0;d<b.images.length;d++){var h=b.images[d];f.push('		<a href="javascript:;" '+ec.remark.common.privewMin()+' class="img-wrap" ><img id="'+h.id+'" image-large="'+h.large+'" src="'+h.small+'"></a> ')}f.push("	</p>                                                         ");f.push('	<div class="clearfix">                                       ');f.push(ec.remark.common.privewImg("view"));f.push("	</div>                                                       ");f.push("</div>                                                        ")}f.push('<div class="product-user-comment-time">');f.push(b.creationTime.substring(0,19));f.push("</div></div>");for(var d=0;d<b.replies.length;d++){o=b.replies[d];f.push('<div class="product-admin-reply"><dl class="clearfix">');f.push("<dt>"+(ec.util.escapeHtml(o.replyerName)||"")+"\uff1a</dt>");f.push("<dd>"+(ec.util.escapeHtml(o.replyContent)||"")+"</dd>");f.push("</dl>");var l=o.likes;if(!l||l==null||$.trim(l)==""){l=0}f.push('<div><a href="javascript:;" class="product-admin-praise-btn" pid="'+b.productId+'" commentId="'+b.commentId+'" replyId="'+o.replyId+'" type="1">\u8d5e\u5ba2\u670d\uff08<span>'+parseInt(l)+"</span>\uff09</a></div>");f.push("</div>")}f.push("</div></li>")}var g=$("#pro-msg-list");g.html(f.join(""));if(r.data.comments.length==0){g.hide();$("#product-remark-comment-no").show()}else{g.show()}/*$("#evaluatePageNumber").html("\u5171"+r.data.page.totalRow+"\u6761\u8bc4\u8bba").show();*/$("#pro-tab-evaluate span").html("("+r.data.count+")");if(r.data.page.totalPage>1){$("#pro-msg-pager").show();$("#pro-msg-pager").pager({pageNumber:r.data.page.pageNum,pageCount:r.data.page.totalPage,recordCount:r.data.page.totalRow,type:0,extraType:a.extraType?a.extraType:1,qpageSize:10,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.remark.loadEvaluate})}else{$("#pro-msg-pager").hide()}$("#pro-msg-pager li.link").live("click",function(){$("html,body").animate({scrollTop:$("#pro-tab-evaluate-content").offset().top-$("#product-tab").height()},100)});$(".product-admin-praise-btn,.product-praise-btn").bind("click",function(){ec.product.remark.likes($(this))});$("#pro-msg-list li").each(function(){var u=$(this),i=0,t=$(this).find(".img-wrap"),j=$(this).find(".img-big img"),v=$(this).find(".img-big"),s=$(this).find(".cursor-prev"),p=$(this).find(".cursor-next");if(t.length){t.click(function(){var w=$(this).find("img").attr("image-large");i=$(this).index();v.removeClass("none");t.eq(i).addClass("selected").siblings().removeClass("selected");q(t,j,i);k(i,t.length,s,p)});$(this).bind("click",function(x){var w=x.target.className.split(" ")[0];switch(w){case"cursor-small":$(this).find(".img-big").addClass("none");t.removeClass("selected");i=0;break;case"cursor-prev":i<=0?0:--i;t.eq(i).addClass("selected").siblings().removeClass("selected");q(t,j,i);k(i,t.length,s,p);break;case"cursor-next":i>=t.length-1?t.length-1:++i;t.eq(i).addClass("selected").siblings().removeClass("selected");q(t,j,i);k(i,t.length,s,p);break;default:break}})}});function q(i,j,p){var s=i.eq(p).find("img").attr("image-large");j.attr("src",s)}function k(p,i,j,s){p==i-1?s.hide():s.show();p==0?j.hide():j.show()}},timeoutFunction:function(){commentFlag=true;$("#pro-tab-evaluate-content").hide();$("#productCommentId").hide();$("#pro-tab-evaluate").hide();$(".product-comment-tab").hide()},errorFunction:function(){commentFlag=true;$("#pro-tab-evaluate-content").hide();$("#productCommentId").hide();$("#pro-tab-evaluate").hide()}})};ec.product.remark.loadEvaluateScore=function(){new ec.ajax().get({url:domainRms+"/comment/getCommentScore.json?pid="+ec.product.id+"&t="+new Date().getTime(),dataType:"jsonp",successFunction:function(c){if(c&&c.resultCode=="0"&&c.data){if(c.data.goodRate){$("#pro-evaluate-avgSorce").html(parseInt(c.data.goodRate*100)+"<em>%</em>")}if(c.data.hotTags){var d=[];for(var b=0;b<c.data.hotTags.length;b++){var e=c.data.hotTags[b];if(e.count>0){var a='<li><a href="javascript:;"><em>'+e.tagName+"</em><span>"+e.count+"</span></a></li>";d.push(a)}}$("#pro-score-impress").html(d.join(""))}}else{return}}})};ec.product.remark.bindEvent=function(){$(".product-comment-tab").find("a").bind("click",function(){var a=$(this).attr("extraType");$(this).parent().addClass("current").siblings().removeClass("current");ec.product.remark.loadEvaluate({pageNumber:1,type:0,extraType:a})})};ec.product.remark.likes=function(e){var d=e.attr("pid");var b=e.attr("commentId");var a=e.attr("replyId");var c=e.attr("type");new ec.ajax().get({url:domainRms+"/comment/like.json?t="+new Date().getTime(),data:{pid:d,commentId:b,replyId:a,type:c},dataType:"jsonp",successFunction:function(h){if(h&&h!=undefined&&h.resultCode){var g=h.resultCode;switch(g){case"0":var f=e.find("span").text();e.find("span").text(parseInt(f)+1);e.addClass("click");e.unbind("click");break;case"42003":ec.account.loginName="";ec.account.afterLogin(function(){ec.product.remark.likes(e)});break;default:break}return}}})};ec.product.remark.loadProductInfoEvaluateScore=function(){new ec.ajax().get({url:domainRms+"/comment/getCommentCount.json?pid="+ec.product.id+"&t="+new Date().getTime(),dataType:"jsonp",successFunction:function(a){if(a&&a!=undefined&&a.resultCode=="0"&&a.data){$("#prd-remark-scoreAverage").attr("style","width:"+(a.data.averageScore*20)+"%");$("#prd-remark-scoreAverage").show();$("#prd-remark-jmptoremark").attr("title","\u5171 "+a.data.count+" \u6761\u8bc4\u8bba");$("#prd-remark-jmptoremark").html("\u5171&nbsp;"+a.data.totalPrdCount+"&nbsp;\u6761\u8bc4\u8bba");$("#prd-remark-jmptoremark").show();$("#prd-remark-span-tab-evaluate").html("\u7528\u6237\u8bc4\u4ef7<em>\uff08"+a.data.totalPrdCount+"\uff09</em>");$("#prd-remark-span-tab-evaluate").show()}}})};
ec.pkg("ec.remark.common");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});var _remarkPrivate={showError:function(b,a){$("#error-area-"+a).show();$("#error-area-"+a).find("label").empty().html(b)},hideError:function(a){$("#error-area-"+a).hide()},getSelectedLen:function(a){return $("#tags-"+a).find(".selected").length},getSelectedDiyLen:function(a){return $("#tags-"+a).find(".tag-li-diy-item.selected").length},checkTagNameRepeat:function(b,e){var f=$("#tags-"+b).find("li .impress").find("a");var d=[];for(var c=0;c<f.length;c++){var a=f[c].text;if(a!="\u81ea\u5b9a\u4e49"){d.push(a)}}return $.inArray(e,d)},check:function(a){this.hideError(a);var b=ec.util.trim($("#tag-input-"+a).val());if(b.length==0){this.showError("\u8f93\u5165\u4e0d\u80fd\u4e3a\u7a7a",a);return false}if(/\s/.test(b)){this.showError("\u6807\u7b7e\u4e2d\u4e0d\u53ef\u4ee5\u6709\u7a7a\u683c",a);return false}if(b.len()>=13){this.showError("\u6807\u7b7e\u4e0d\u53ef\u4ee5\u8d85\u8fc76\u4e2a\u6c49\u5b57",a);return false}return true}};ec.remark.common.checkSeletedTagNum=function(e,c,d){var a=_remarkPrivate.getSelectedDiyLen(c);var f=_remarkPrivate.getSelectedLen(c);if(a>=4&&!$(e).hasClass("selected")){var b=true;switch(d){case"tagOnclick":if(a==4&&$(e).hasClass("tag-li-diy-item")){b=false}else{if(f<5){b=true}else{b=false}}break;case"addTag":b=false;break;case"diyOnclick":if($(e).hasClass("tag-li-diy-item")){b=false}break;default:b=false;break}if(!b){if(f>=5){_remarkPrivate.showError("\u6700\u591a\u8d345\u4e2a\u6807\u7b7e\uff0c\u4f60\u5df2\u7ecf\u8d34\u6ee1\u4e86",c)}else{_remarkPrivate.showError("\u6700\u591a\u8d344\u4e2a\u81ea\u5b9a\u4e49\u6807\u7b7e\uff0c\u4f60\u5df2\u7ecf\u8d34\u6ee1\u4e86",c)}}return b}if(f>=5&&!$(e).hasClass("selected")){_remarkPrivate.showError("\u6700\u591a\u8d345\u4e2a\u6807\u7b7e\uff0c\u4f60\u5df2\u7ecf\u8d34\u6ee1\u4e86",c);return false}return true};ec.remark.common.tagOnclick=function(c){var a=$(c).parent().attr("data-sku");if(ec.remark.common.checkSeletedTagNum(c,a,"tagOnclick")){_remarkPrivate.hideError(a);$(c).toggleClass("selected");var b=$(c).find("input")[0];if(b){if(b.checked){b.checked=false}else{b.checked=true}}}};ec.remark.common.diyOnclick=function(b){var a=$(b).parent().parent().parent().attr("data-sku");if(ec.remark.common.checkSeletedTagNum(b,a,"diyOnclick")){$("#diy-area-"+a).addClass("current")}};ec.remark.common.addTag=function(e,a){if(ec.remark.common.checkSeletedTagNum(e,a,"addTag")&&_remarkPrivate.check(a)){var d=ec.util.trim($("#tag-input-"+a).val());var c=_remarkPrivate.checkTagNameRepeat(a,d);if(c>=0){_remarkPrivate.showError("\u60a8\u8f93\u5165\u7684\u6807\u7b7e\u540d\u79f0\u5df2\u7ecf\u5b58\u5728",a);return}else{_remarkPrivate.hideError()}var b=[];b.push('<li class="ce-post-impress-item tag-li-diy-item selected" onclick="ec.remark.common.tagOnclick(this);">');b.push('<div class="impress">');b.push('<input type="checkbox" checked="true" name="diyTags-'+a+'" style="visibility: hidden; position: absolute;" value="'+ec.util.escapeHtml(d)+'" id="diyTags">');b.push('<a href="javascript:;" id="diyTags-a-'+a+'">'+ec.util.escapeHtml(d)+"</a><s></s></div></li>");$("#diy-area-"+a).before(b.join(""));$("#tag-input-"+a).val("");if(_remarkPrivate.getSelectedLen()>=5){$("#diy-area-"+a).removeClass("current")}}};ec.remark.common.login=function(a){ec.account.afterLogin(function(){if(a){a()}})};ec.remark.common.showErrorMsg=function(e,a){if(!e||$.trim(e)==""){e=""}var c='<a href="javascript:;" class="box-cancel"><span>\u786e\u5b9a</span></a>';switch(a){case 1:c='<a href="javascript:;" class="box-cancel"><span>\u786e\u5b9a</span></a>';break;case 2:c='<a href="/member/prdRemarkView?t='+(new Date()).getTime()+'" class="box-cancel" ><span>\u6211\u4e0d\u6539\u4e86</span></a><a href="'+serviceRobotim+'" target="_blank" class="box-ok"><span>\u8054\u7cfb\u5ba2\u670d</span></a>';break;default:c='<a href="javascript:;" class="box-cancel"><span>\u786e\u5b9a</span></a>';break}var b=[];b.push('<div class="box-content" style="height: auto;">                                                         ');b.push('	<div class="box-prompt01-error">                                                                       ');b.push('		<div class="h">                                                                                    ');b.push("			<i></i>                                                                                        ");b.push("		</div>                                                                                             ");b.push('		<div class="b">                                                                                    ');b.push('			<p id="comments-msg-'+a+'">'+e+"</p>                                            ");b.push("		</div>                                                                                             ");b.push("	</div>                                                                                                 ");b.push('	<div class="box-button">                                                                               ');b.push(c);b.push("	</div>                                                                                                 ");b.push("</div>                                                                                                  ");var d=new ec.box(b.join(""),{boxid:"box_remark_tips_common_message",boxclass:"ol_box_4",showButton:false,showTitle:true,showCancel:false,showOk:false,width:600,onclose:function(f){},onopen:function(f){},onok:function(f){}});d.open()};ec.remark.common.privewImg=function(a){var b=[];b.push('		<div class="img-big none">                       ');if("view"!=a){b.push('        <a href="javascript:;" class="comment-img-delete">\u5220\u9664</a>')}b.push('			<img src="">                                 ');b.push('			<div class="cursor-prev" style="cursor:url('+imagePath+'/echannel/icon/arrow-left.cur),auto;"></div>              ');b.push('			<div class="cursor-small" style="cursor:url('+imagePath+'/echannel/icon/zoom-out.cur),auto;"></div>             ');b.push('			<div class="cursor-next" style="cursor:url('+imagePath+'/echannel/icon/arrow-right.cur),auto;"></div>              ');b.push("		</div>                                           ");return b.join("")};ec.remark.common.privewMin=function(){return'style="cursor:url('+imagePath+'/echannel/icon/zoom-in.cur),auto;"'};ec.remark.common.check=function(a,e){var b=false;var d=$("#tags-"+a);var f=$.trim($("#score-"+a).attr("data-score"));var c=$.trim($("#content-"+a).val());if(500<c.length){$("#commodity-content-msg-"+a).html("\u8bc4\u8bba\u6700\u591a\u4e0d\u80fd\u8d85\u8fc7500\u4e2a\u5b57\u54e6").css("display","block");return false}if(!ec.remark.common.checkIllegalChar(c)){$("#commodity-content-msg-"+a).html("\u60a8\u63d0\u4ea4\u7684\u8bc4\u8bba\u5305\u542b[]><\"&#'\u7b49\u7279\u6b8a\u5b57\u7b26,\u8bf7\u4fee\u6539").css("display","block");return false}e.push(a);return true};ec.remark.common.checkIllegalChar=function(b){var a=/(\[|\]|>|<|\\|"|&|#|')/;if(b!=""&&b!=null&&a.test(b)){return false}return true};
ec.pkg("ec.product");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});ec.load("ec.index");ec.load("cloud-zoom",function(){setTimeout(function(){$("#product-img").CloudZoom()},200)});ec.load("ec.product.gift");ec.load("ec.product.coupon");ec.load("rush");ec.load("deposit");ec.load("jquery.fixed",function(){$(function(){$("#pro-tab-all").fixed()})});var value={UID:ec.util.cookie.get("uid"),TID:getPtid(),TIME:getTime(),CONTENT:{productId:$("#product_productId").val(),load:"1"}};ec.code.addAnalytics({hicloud:true});_paq.push(["trackLink","300020001","link",value]);ec.ui.countdown2=function(d,l){var f=$(d),b=f.data("countdown"),k=0,i,j,e=l.now.getTime()-new Date().getTime(),c=0,h=function(){if(k>=l.times.length){return false}i=l.times[k];k++;return true},g=function(){c=Math.round((i.parseDate("yyyy-MM-dd HH:mm:ss").getTime()-new Date().getTime()-e)/1000);c=c<=0?0:c;return c},a=function(){c--;if(c<=0){c=0}j={day:Math.floor(c/(24*60*60)),hour:(l.html.indexOf("{#day}")>=0)?Math.floor(c/60/60)%24:Math.floor(c/60/60),minute:Math.floor(c/60)%60,second:c%60};var m=l.html.replace(/{#day}/g,j.day>9?j.day:"0"+j.day).replace(/{#hours}/g,j.hour>9?j.hour:"0"+j.hour).replace(/{#minutes}/g,j.minute>9?j.minute:"0"+j.minute).replace(/{#seconds}/g,j.second>9?j.second:"0"+j.second);f.html(m);return(c<=0)?false:true};if(!l.times){l.times=[l.endTime]}clearInterval(b);while(h()){if(g()<=0){continue}break}if(!a()){return}b=setInterval(function(){if(!a()){if(l.callback){l.callback(l)}if(!h()){clearInterval(b)}else{g()}}},1000);f.data("countdown",b)};var detailContentHeigh=0;var productParameterHeight=0;var packageServiceHeight=0;var customerServiceHeight=0;var tit1=0;var tit2=0;var tit3=0;var tit4=0;var oTop=0;var clickFlag=false;var packFlag=false;var commentFlag=false;var scollFlag=false;var upDownButton="";var finished=true;ec.product.packageList={};ec.product.warranty={};var playerArray=[];$(function(){$(window).resize(function(){var b=ec.product.getSku();var a=ec.product.getSkuInfo(b);if(upDownButton=="true"){$("#pro-detail-content-"+a.id).height($("#kindPicture-"+a.id).height()+$("#pro-detail-up-btn-"+a.id).height()+40)}if($("#kindPicture-"+a.id).height()<=2000){$("#pro-detail-content-"+a.id).height($("#kindPicture-"+a.id).height());$("#detail-content-button-"+a.id).hide();$("#pro-detail-up-btn-"+a.id).css("display","none")}else{if(upDownButton=="true"){$("#detail-content-button-"+a.id).hide();$("#pro-detail-up-btn-"+a.id).css("display","block")}else{if(upDownButton=="false"){$("#detail-content-button-"+a.id).show();$("#pro-detail-up-btn-"+a.id).css("display","none")}else{$("#pro-detail-content-"+a.id).height("2000");$("#detail-content-button-"+a.id).show();$("#pro-detail-down-btn-"+a.id).click(function(){$("#pro-detail-content-"+a.id).height($("#kindPicture-"+a.id).height()+$("#pro-detail-up-btn-"+a.id).height()+40);$("#detail-content-button-"+a.id).hide();$("#pro-detail-up-btn-"+a.id).css("display","block");upDownButton=="true"});$("#pro-detail-up-btn-"+a.id).click(function(){$("#pro-detail-content-"+a.id).height("2000");$("#detail-content-button-"+a.id).show();$("#pro-detail-up-btn-"+a.id).css("display","none");$("body,html").animate({scrollTop:tit1+1575},0);upDownButton=="false"})}}}});$("#myConsultation").click(function(){$("#myConsultation").hide();$("#upUserAdvisory").removeClass("hide").addClass("show");$("#stopConsultationId").show()});oTop=$(".product-tab").offset().top;$("#pro-tab-feature").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag){tit1=$(".tit1").offset().top-50}clickFlag=true}$("#pro-tab-feature").addClass("selected").siblings().removeClass("selected");$("body,html").animate({scrollTop:tit1+75},0)});$("#pro-tab-parameter").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag){tit1=$(".tit1").offset().top-50}clickFlag=true}$("#pro-tab-parameter").addClass("selected").siblings().removeClass("selected");tit2=tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height();$("body,html").animate({scrollTop:tit2},0)});$("#pro-tab-package-service").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag){tit1=$(".tit1").offset().top-50}clickFlag=true}$("#pro-tab-package-service").addClass("selected").siblings().removeClass("selected");tit3=tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height()+$("#productParameter").height()+$("#hr60Detail").height();$("body,html").animate({scrollTop:tit3},0)});$("#pro-tab-evaluate").click(function(){if(!clickFlag){tit1=$(".tit1").offset().top-150;if(scollFlag){tit1=$(".tit1").offset().top-50}clickFlag=true}$("#pro-tab-evaluate").addClass("selected").siblings().removeClass("selected");tit4=tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height()+$("#productParameter").height()+$("#hr60Detail").height()+$("#packagId").height()+$("#customerServiceLocation").height()+$("#productDetailstips").height();$("body,html").animate({scrollTop:tit4},0)});$(window).scroll(function(){var a=$(this).scrollTop()+1;detailContentHeight=$("#pro-tab-feature-content").height()+$("#hr60Detail").height();productParameterHeight=$("#productParameter").height()+$("#hr60Detail").height();packageServiceHeight=$("#packagId").height();customerServiceHeight=$("#customerServiceLocation").height()+$("#productDetailstips").height();if(a>oTop){$(".product-tab").addClass("product-tab-top").css({position:"fixed",top:"0",background:"#fff",width:"100%","z-index":"100"});$(".product-tab-btn").css({display:"block"});if(!clickFlag){tit1=$(".tit1").offset().top-50}scollFlag=true}else{$(".product-tab").css({position:"static"});$(".product-tab-btn").css({display:"none"});$(".product-tab").removeClass("product-tab-top");if(!clickFlag){tit1=$(".tit1").offset().top-150}scollFlag=false}if(a>=(tit1+75)&&a<(tit1+detailContentHeight)){$("#pro-tab-feature").addClass("selected").siblings().removeClass("selected")}if(packFlag==true){if(a>=(tit1+detailContentHeight)&&a<(tit1+detailContentHeight+productParameterHeight+$("#productDetailstips").height())){$("#pro-tab-parameter").addClass("selected").siblings().removeClass("selected")}}else{if(a>=(tit1+detailContentHeight)&&a<(tit1+detailContentHeight+productParameterHeight)){$("#pro-tab-parameter").addClass("selected").siblings().removeClass("selected")}}if(packFlag==false){if(a>=(tit1+detailContentHeight+productParameterHeight)&&a<(tit1+detailContentHeight+productParameterHeight+packageServiceHeight+customerServiceHeight)){$("#pro-tab-package-service").addClass("selected").siblings().removeClass("selected")}}if(!commentFlag){if(a>=(tit1+detailContentHeight+productParameterHeight+packageServiceHeight+customerServiceHeight)){$("#pro-tab-evaluate").addClass("selected").siblings().removeClass("selected")}}})});ec.ui.proNumer=function(a,b){var c={max:null,min:null,showButton:true,minusBtn:'<a id="pro-quantity-minus" href="javascript:;">&minus;</a>',plusBtn:'<a id="pro-quantity-plus" href="javascript:;">&#43;</a>'},d=$(a),b=$.extend(c,b),e=function(f){var h=f.which,g=parseInt(this.value,10),i=(g<1)?1:g;if((h<37||h>40)&&h!=8&&h!=46){if(i>b.max||i<b.min){f.preventDefault();return false}else{if((h<48||h>57)&&(h<96||h>105)&&h!=9){f.preventDefault();return false}}}};d.each(function(){var i=$.extend({},b),g=$(this).css("ime-mode","disabled");var h=g.attr("max");if(h){b.max=i.max=parseInt(h,10)||i.max}h=g.attr("min");if(h){b.min=i.min=parseInt(h,10)||i.min}if(i.showButton){var k=$(i.minusBtn).click(function(){var l=g.val()||0,m=parseInt(l,10)-1;if(typeof(i.min)=="number"&&m<i.min){return}g.val(m).trigger("blur")}),j=$(i.plusBtn).click(function(){var l=g.val()||0,m=parseInt(l,10)+1;if(typeof(i.max)=="number"&&m>i.max){return}g.val(m).trigger("blur")});var f=$('<p class="product-stock-btn"></p>').append(j).append(k);g.after(f);if(this.value<=1){$("#pro-quantity-minus").removeClass().addClass("disabled")}else{$("#pro-quantity-minus").removeClass()}}g.data("ovalue",g.val()||0).keydown(e).keyup(function(){var l=parseInt(this.value||0);if(typeof(i.min)=="number"&&l<i.min){this.value=i.min;return}else{if(typeof(i.max)=="number"&&l>i.max){this.value=i.max;return}}}).blur(function(){if(this.value<=1){$("#pro-quantity-minus").removeClass().addClass("disabled")}else{$("#pro-quantity-minus").removeClass()}if(typeof i.onchange==="function"){var l=g.data("ovalue"),m=this.value||0,n=parseInt(m,10)-parseInt(l,10);if(n==0){return}g.data("ovalue",m);i.onchange.call(this,m,n)}})})};ec.product.prefix="/product";ec.product.email=ec.util.escapeHtml(ec.account.email);ec.product.mobile=ec.util.escapeHtml(ec.account.mobile);var _skuForGetFeature={};var _giftBuyItemId=new Array();(function(){var g=null,d=true,h={},b={},o={},j={},c=[],n=[],k={},q={},e={},l={},f,a={},m={},i={};ec.product.getSkuPointWeight=function(r){return m[r]};ec.product.setSkuPointWeight=function(r,s){m[r]=s};ec.product.getSkuPointWeightDetail=function(r){return i[r]};ec.product.setSkuPointWeightDetail=function(r,s){i[r]=s};_proGallerysMouseOver=function(){var r=$(this);r.parent().parent().addClass("current").siblings().removeClass("current");clearTimeout(f);f=setTimeout(function(){var s=r.attr("src");$("#product-img").attr("href",s.replace("78_78","800_800")).find("img").attr("src",s.replace("78_78","428_428"));$("#product-img").CloudZoom()},150)},_updateSelect=function(){var r="";$("#pro-skus").find(".selected").each(function(){r+=$(this).children().children("a").attr("title")+" / "});r=r.substring(0,r.length-2);if($("#packageSelect").length>0){$("#packageSelect ul li").each(function(){if($(this).hasClass("selected")){var s=$(this).attr("data-attrname");r+='<div id="package-selected" class="inline">&nbsp;/&nbsp;'+s+"</div>"}})}if($("#giftBuy_dl").length>0){$("#giftBuy_dl ul li").each(function(){if($(this).hasClass("selected")){var s=$(this).find("a").attr("title");r+='<div id="giftBuy-selected" class="inline">&nbsp;/&nbsp;'+s+"</div>"}})}r+="";$("#pro-select-sku").html(r);$("#pro-select-sku").parent().show()};_upadteSkuPrice=function(r){if(r.priceMode!=2){r.price=parseFloat(r.price).toFixed(2)}if(parseFloat(r.originPrice)!=parseFloat(r.price)&&(r.priceMode!=2)){$("#pro-price-label").html("\u62a2\u8d2d\u4ef7");$("#pro-price-label").removeClass("f24").addClass("type");$("#pro-price").html("<em>&yen;</em>"+r.price);$("#pro-price-old").html("&yen;&nbsp;"+r.originPrice);$("#pro-price-label").show();$("#pro-price").show();$("#pro-price-old").show()}else{$("#pro-price-old").hide();$("#pro-price-label").hide();$("#pro-price-old").html("");$("#pro-price-label").html("");if(r.price>0){if(ec.product.productType==4){$("#pro-price-hide").val(r.price);$("#pro-price").show()}else{$("#pro-price").html("<em>&yen;</em>"+r.price);$("#pro-price").show()}}else{$("#pro-price").html("");$("#pro-price").hide();$("#pro-price-label").html("\u6682\u65e0\u62a5\u4ef7");if($("#pro-price-label").hasClass("type")){$("#pro-price-label").removeClass("type").addClass("f24")}$("#pro-price-label").show()}}if(r.priceMode==2||r.price<=0){$("#pro-price").hide();$("#pro-price-old").hide();$("#pro-price-label").html("\u6682\u65e0\u62a5\u4ef7");$("#pro-price-label").show()}};_updateSkuInfo=function(){var Z=ec.product.getSku(),ac;if(!Z||g==Z){return}else{ec.product.videoHide();if($("#extendSelect").next().is("a")){$("#extendSelect").next().remove()}if($("#accidentSelect").next().is("a")){$("#accidentSelect").next().remove()}$("#extendSelect").parent().removeClass("selected");$("#accidentSelect").parent().removeClass("selected")}$("#package_dl").remove();$("#packageList").html("");$("#packageCode").val("");ec.product.setSkuId=g=Z;$("#product-tips").hide();$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#pro-quantity-area").show();$("#pro-quantity-area-nochange").hide();$("#product-operation").hide();var T=$("#bundle-list-"+Z);var ag=$("#comb-list-"+Z);if(ag&&ag.length>0){$(".product-package-tab").hide();$(".product-recommend-con").hide();$("#comb-list-"+Z).show();$("div[id^='comb-pro-"+Z+"-0'] ").show()}else{$("#product-recommend-all").hide()}flag=0;$("div[id^='comb-list-'] input").unbind("click");$("div[id^='comb-list-"+Z+"-'] input").bind("click",function(ay){$(this).attr("disabled","disabled");if(flag!=0){return}if($(this).hasClass("protect")==false){$(this).addClass("protect");$(this).attr("checked",true)}else{$(this).removeClass("protect");$(this).attr("checked",false)}var ax=$(this).attr("data-index");var az=$("#comb-count-"+Z.id+"-"+ax).html();var aw=$("#comb-main-price-"+Z.id+"-"+ax).attr("data-price");var s=parseFloat($("#comb-price-"+Z.id+"-"+ax).html());flag=1;if($(this).attr("checked")==true){price=s+parseFloat($(this).attr("data-price"));az++}else{price=s-parseFloat($(this).attr("data-price"));az--}$("#comb-price-"+Z.id+"-"+ax).html(price.toFixed(2));$("#comb-count-"+Z.id+"-"+ax).html(az);console.log($("#comb-count-"+Z.id+"-"+ax).html());flag=0;$(this).attr("disabled","")});Z=b[Z];ec.product.setType(Z.type);_upadteSkuPrice(Z);var aa=[];aa.push('<a href="javascript:;" class="product-slogan-btn"></a>');if($.trim(Z.timerPromWord).length>0){if($.trim(Z.timerPromLink4PC).length>0){ac='<a href="'+Z.timerPromLink4PC+'" target="_blank" class="product-slogan-link">'+Z.timerPromWord+"</a>"}var al=ec.product.getSysDate();var X=Z.timerPromStarttime;var w=new Date();w.setTime(X.parseDate("yyyy-MM-dd HH:mm:ss"));var O=Z.timerPromEndtime;var N=new Date();N.setTime(O.parseDate("yyyy-MM-dd HH:mm:ss"));if((al-w)>=0&&(N-al)>=0){aa.push(ac||'<span class="product-slogan-link">'+Z.timerPromWord+"</span>")}}if($.trim(Z.skuPromWord).length>0){aa.push("<span>"+Z.skuPromWord+"</span>")}if(0<aa.length){$("#skuPromWord").html(aa.join(" "));$("#skuPromWord").css("display","-webkit-box");$(".product-slogan-btn").hide();$("#skuPromWord").attr("class","product-slogan");var Q=$("#skuPromWord").height();if(Q>40){$("#skuPromWord").attr("class","product-slogan product-slogan-hide");$(".product-slogan-btn").show();$(".product-slogan-btn").mouseenter(function(){if($("#skuPromWord").hasClass("product-slogan-show")){$("#skuPromWord").attr("class","product-slogan product-slogan-hide")}else{$("#skuPromWord").attr("class","product-slogan product-slogan-show")}ec.product.refreshStyle()});$("#skuPromWord").mouseleave(function(){if($("#skuPromWord").hasClass("product-slogan-show")){$("#skuPromWord").attr("class","product-slogan product-slogan-hide");ec.product.refreshStyle()}})}}else{$("#skuPromWord").html("");$("#skuPromWord").hide()}if((!$.trim(Z.skuPromWord).length>0)&&(!$.trim(Z.timerPromWord).length>0)){$("#skuPromWord").hide()}$("#pro-sku-code").val(Z.code);$("#pro-sku-code2").text(Z.code);$("#pro-name").html(Z.name);$("#bread-pro-name").html(Z.name);ec.product.execute("renderInventory",[ec.product.inventory.haveInventory(Z.id)]);$("#product-img").attr("href",ec.mediaPath+Z.photoPath+"800_800_"+Z.photoName).find("img").attr("src",ec.mediaPath+Z.photoPath+"428_428_"+Z.photoName);$("#product-img").CloudZoom();var aa=[];aa.push('<li class="current"><a href="javascript:;"><img src="'+ec.mediaPath+Z.photoPath+"78_78_"+Z.photoName+'" alt="'+Z.name+'"/></a></li>');if(Z.groupPhotoList){for(var ar=0;ar<Z.groupPhotoList.length;ar++){var au=Z.groupPhotoList[ar];aa.push('<li><a href="javascript:;"><img src="'+ec.mediaPath+au.path+"/78_78_"+au.name+'"  alt="'+Z.name+'"/></a></li>')}}aa=$(aa.join(""));aa.find("img").mouseover(_proGallerysMouseOver);$("#pro-gallerys").empty().html(aa);ec.product.imgSlider.reset();aa=[];if(!Z.giftList||Z.giftList.length==0){isShowGifts=false}else{isShowGifts=true}if(isShowGifts){$("#product-info-list-new").show();$("#pro-match-gift").show();$("#pro-gift-list-select").html(ec.product.gift.ftl(ec.product.getSku()))}else{$("#pro-match-gift").hide()}aa=[],htmldetail=[];var I=false;if(!Z.promotionLst||Z.promotionLst.length==0){$(".product-prom-item").eq(0).siblings().remove();if($("#pro-gift-list-select").children().length<0||!Z.giftList||Z.giftList.length==0){$("#product-info-list-new").hide()}}else{if($(".product-prom").parent().hasClass("hide")||$(".product-prom").parent().css("display")=="none"){$(".product-prom").parent().removeClass("hide");$(".product-prom").parent().css("display","")}$(".product-prom-item").eq(0).siblings().remove();htmldetail.push(' <div class="product-prom-item clearfix relative hide" id="promBtn">');htmldetail.push('<p class="fl">');for(var ar=0;ar<Z.promotionLst.length;ar++){htmldetail.push('<em class="tag">'+Z.promotionLst[ar].promoLabel+"</em>");aa.push('<div class="product-prom-item clearfix" >');aa.push('<em class="tag">'+Z.promotionLst[ar].promoLabel+"</em>");aa.push('<div class="product-prom-con" title="'+Z.promotionLst[ar].ruleDescription+'">');aa.push(' <span class="product-prom-word">');aa.push(Z.promotionLst[ar].ruleDescription);aa.push(" </span>");if(Z.promotionLst[ar].isRealNameAuth=="1"){htmldetail.push('<a href="/authmember/accesstoken" target="_blank"  class="product-prom-link">\u9650\u5b9e\u540d\u7528\u6237\u53c2\u52a0 ></a>')}aa.push("</div>");aa.push("</div>")}htmldetail.push('</p><div class="product-prom-btn" id="show-all-prom"  >\u5c55\u5f00\u4fc3\u9500</div></div>');$(".product-prom").append(aa.join(""));I=true;$(".product-prom .product-prom-item").hide();if($("#pro-gift-list-select").find("a").length>0&&isShowGifts){if($("#product-prom-all").children().length>4){for(var ar=0;ar<3;ar++){$(".product-prom-item").eq(ar).show()}$(".product-prom").append(htmldetail.join(""));$("#promBtn").show();for(var ar=0;ar<2;ar++){$("#promBtn em").eq(ar).hide()}}else{$(".product-prom .product-prom-item").show();$(".product-prom").append(htmldetail.join(""))}}else{if($("#product-prom-all").children().length>5){for(var ar=1;ar<4;ar++){$(".product-prom-item").eq(ar).show()}$(".product-prom").append(htmldetail.join(""));$("#promBtn").show();for(var ar=0;ar<3;ar++){$("#promBtn em").eq(ar).hide()}}else{$(".product-prom .product-prom-item").show();$(".product-prom").append(htmldetail.join(""))}}if((!$("#pro-gift-list-select").find("a").length)>0||!isShowGifts){$("#pro-match-gift").hide()}}aa=[];if(ec.product.seCode!=ec.product.productSeCode){aa.push("<p>\u5df2\u5305\u90ae<em></em>\u7531"+ec.product.productshopName+"\u53d1\u8d27\uff0c\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1</p>")}else{if(parseFloat(ec.product.deliveryModeValueFreeBase)>0&&ec.product.productType==0){if(Z.priceMode!=2){if(parseFloat(Z.price)>=parseFloat(ec.product.deliveryModeValueFreeBase)){aa.push("<p>\u5df2\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5df2\u514d\u8fd0\u8d39<em></em>")}else{aa.push("<p>\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5373\u514d\u8fd0\u8d39\uff0c\u5feb\u53bb\u51d1\u5355\u5427<em></em>")}}}else{aa.push("<p>")}aa.push("\u7531\u534e\u4e3a\u5546\u57ce\u8d1f\u8d23\u53d1\u8d27\uff0c\u5e76\u63d0111\u4f9b\u552e\u540e\u670d\u52a1</p>")}if($("#pro-select-gift-service")!=undefined){$("#pro-select-gift-service").remove();_giftBuyItemId=[]}if($("#giftBuy_dl")!=undefined){$("#giftBuy_dl").remove()}var ab=false;if(Z.buttonMode=="11"){ab=true}var af=$("#isPriority").val();$("#package_dl").remove();$("#packageList").html("");$("#packageCode").val("");if(Z.pro_sbomList!=null&&Z.pro_sbomList!=""&&Z.pro_sbomList.length>0&&ec.product.inventory.haveInventory(Z.id)){var W=[];var ad=Z.pro_sbomList;for(var ak=0;ak<ad.length;ak++){if(Z.code==ad[ak].sbomCode){var C=ad[ak].sbomPackageList;if(C!=null&&C!=""&&C.length>0){ec.product.hidebundleView();W.push('<dl class="product-choose clearfix" id="package_dl"><label>\u9009\u62e9\u5957\u9910</label><div class="product-choose-detail relative" id = "packageSelect"><ul>');W.push('<li class="selected" data-attrname="\u5355\u54c1">');W.push('<div class="sku">');W.push('<a href="javascript:;" title="\u5355\u54c1" onclick="ec.product.newpackageView(this,null,\''+Z.code+"')\"><p><span>\u5355\u54c1</span></p></a></div></li>");for(var an=0;an<C.length;an++){var ae=C[an].packageList;W.push('<li class="" data-attrname="'+C[an].name+'">');W.push('<div class="sku"><a href="javascript:;" attr-package='+C[an].packageCode+' title="'+C[an].name+'" onclick="ec.product.newpackageView(this,\''+C[an].packageCode+"','"+Z.code+"')\"><p><span attr-package="+C[an].packageCode+">"+C[an].name+"</span></p></a></div></li>")}W.push('</ul><div id="packageList"><div></div></dl>')}else{$("#bundlePackage").removeClass("hide")}}}if($("#bundlePackage").length>0){$("#bundlePackage").after(W.join(""))}else{$("#pro-skus").after(W.join(""))}}else{$("#packageList").html("")}if(Z.giftBuyLstX.length>0){var z=[];z.push('<dl class="product-choose clearfix" id="giftBuy_dl"><label>\u589e\u503c\u4e1a\u52a1</label><div class="product-choose-detail"><ul>');z.push('<li class="selected" data-attrname="\u65e0\u589e\u503c\u670d\u52a1">');z.push('<a href="javascript:;" title="\u65e0\u589e\u503c\u670d\u52a1"><p><span>\u65e0\u589e\u503c\u670d\u52a1</span></p></a></li>');for(var ao=0;ao<Z.giftBuyLstX.length;ao++){var S=Z.giftBuyLstX[ao];z.push('<li class="'+((S.hasInv=="false"||ab)?"disabled":"")+'" data-skuid="'+S.id+'">');z.push('<a href="javascript:;" title="'+S.name+'" data-code="'+S.sbomCode+'" data-pid="'+S.productId+'"><p><span>'+S.name+"</span></p></a></li>")}z.push('<a href="javascript:;" target="_blank" class="btn-product-more hidden" id="gift-service-detail-link"><span>\u4e86\u89e3\u8be6\u60c5</span>&gt;</a>');z.push("</ul></div></dl>");if($("#conRelItemList").length>0){$("#conRelItemList").after(z.join(""))}else{$("#contractLst").after(z.join(""))}var U=[];U.push('<div id="giftBuy-selected" class="inline">&nbsp;/&nbsp;\u65e0\u589e\u503c\u670d\u52a1</div>');var K=$("#pro-select-sku").html();$("#pro-select-sku").html(K+U.join(""));ec.product.hasRemovedCartButton=false;$("#giftBuy_dl li").find("a").each(function(){if($(this).parent().hasClass("disabled")){return}$(this).click(function(){$(this).parent().addClass("selected").siblings().removeClass("selected");var aw=$(this).attr("data-code");if($("#pro-select-gift-service")!=undefined){$("#pro-select-gift-service").remove()}if(aw!=undefined&&aw.length>0){_giftBuyItemId=[];_giftBuyItemId.push(aw);pushProGiftBuySerMsg();$("#gift-service-detail-link").attr("href","/product/"+$(this).attr("data-pid")+".html");$("#gift-service-detail-link").show();$("#giftBuy-selected").remove();var s=[];s.push('<div id="giftBuy-selected" class="inline">&nbsp;/&nbsp;'+$(this).attr("title")+"</div>");var ax=$("#pro-select-sku").html();$("#pro-select-sku").html(ax+s.join(""));if($("#pro-operation").find("a").length==2&&$("#pro-operation").find("a").first().find("span").html()=="\u52a0\u5165\u8d2d\u7269\u8f66"&&!$("#pro-operation").find("a").first().hasClass("disabled")){$("#pro-operation").find("a").first().remove();$("#pro-operation").find("a").attr("onclick","").click(function(){ec.product.orderNow("2")});ec.product.hasRemovedCartButton=true}}else{_giftBuyItemId=[];$("#gift-service-detail-link").attr("href","");$("#gift-service-detail-link").hide();$("#pro-operation").find("a").attr("onclick","").click(function(){ec.product.orderNow()});if($("#pro-operation").find("a").length==1&&!$("#pro-operation").find("a").hasClass("disabled")&&ec.product.hasRemovedCartButton){$("#pro-operation").find("a").before('<a href="javascript:;" onclick="ec.product.addCart()" class="product-button01"><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a>');ec.product.hasRemovedCartButton=false}if($("#pro-select-gift-service")!=undefined){$("#pro-select-gift-service").remove()}$("#giftBuy-selected").remove();var s=[];s.push('<div id="giftBuy-selected" class="inline">&nbsp;/&nbsp;\u65e0\u589e\u503c\u670d\u52a1</div>');var ax=$("#pro-select-sku").html();$("#pro-select-sku").html(ax+s.join(""))}})})}else{if($("#giftBuy_dl")!=undefined){$("#giftBuy_dl").remove()}}if(Z.prolongLst.length>0){var ah;aa=[];var u=[];var av=[];var Y=[],J=[];var r=[];var at=0;var ap;var V=[],E=[];var B=[];var ai=[],R=[],P=[],am=[];var x=0;var M=0;var F=0;var t=0;var aj=[];var G=[];for(var ar=0;ar<Z.prolongLst.length;ar+=1){ah=Z.prolongLst[ar];if(ah.serviceType==1){Y[at]=ah.name;r[at]=ah.id;aj[at]=ah.sbomCode;u[at]=ah.productId;J[at]=ah.brifeName;ai[at]=ah.price;P[at]=ah.orderPrice;at+=1}if(ah.serviceType==2){V[x]=ah.name;B[x]=ah.id;G[x]=ah.sbomCode;av[x]=ah.productId;E[x]=ah.brifeName;R[x]=ah.price;am[x]=ah.orderPrice;x+=1}}$("#extendProtected").find("ul").html("");$("#accidentProtected").find("ul").html("");$("#pro-service").hide();$("#extendSelect").attr("skuid","");$("#extendSelect").attr("data-scode","");$("#accidentSelect").attr("skuid","");$("#accidentSelect").attr("data-scode","");$("#extendSelect").html("");$("#accidentSelect").html("");$(".product-operation-main").css("min-height","49px");if(at>0||x>0){$("#pro-service").show()}else{$("#pro-service").hide()}if(at>0){$("#extendProtected").parent().parent().show();for(var ar=0;ar<at;ar++){if(ai[ar]<P[ar]){var v='<s class="fl">&nbsp;\uffe5'+P[ar]+"</s>";var L='<em class="product-service-icon">\u4f18\u60e0</em>'}else{var v="";var L=""}ap=$('<li><div class="fl" onclick="checkedThis(this,\''+aj[ar]+'\',\'extendedName\',\'extendProtected\');"><input type="checkbox" name="extendedName"><div id="'+aj[ar]+'" class="product-service-listcon" title="'+J[ar]+'"  skuID="'+r[ar]+'"data-scode="'+aj[ar]+'"data-price="'+ai[ar]+'">'+L+'<span class="fl max-w">'+J[ar]+'</span><p class="f1"><span class="fl">&nbsp;\uffe5'+ai[ar]+"</span>"+v+'<a target="_blank" href="/product/'+u[ar]+'.html">\u8be6\u60c5&nbsp;&gt;</a></p></div></div></li>');ap.appendTo($("#extendProtected").find("ul"))}var A='<span class="fl max-w">'+J[0]+'</span><span class="fl">&nbsp;\uffe5'+ai[0]+"</span>";$("#extendProtected").parent().before('<a href="javascript:;"  onclick="ec.product.click_function(this)"  class="product-service-btn">'+A+"</a>")}else{$("#extendProtected").parent().parent().hide()}if(x>0){$("#accidentProtected").parent().parent().show();for(var ar=0;ar<x;ar++){if(R[ar]<am[ar]){var y='<s class="fl">&nbsp;\uffe5'+am[ar]+"</s>";var H='<em class="product-service-icon">\u4f18\u60e0</em>'}else{var y="";var H=""}var D=$('<li><div class="fl" onclick="checkedThis(this,\''+G[ar]+'\',\'accidentName\',\'accidentProtected\');"><input type="checkbox" name="accidentName" ><div id="'+G[ar]+'" class="product-service-listcon" title="'+E[ar]+'"  skuID="'+B[ar]+'" data-scode="'+G[ar]+'"data-price="'+R[ar]+'">'+H+'<span class="fl max-w">'+E[ar]+'</span><p class="fl"><span class="fl">&nbsp;\uffe5'+R[ar]+"</span>"+y+'<a target="_blank" href="/product/'+av[ar]+'.html">\u8be6\u60c5&nbsp;&gt;</a></p></div></div></li>');D.appendTo($("#accidentProtected").find("ul"))}var aq='<span class="fl max-w">'+E[0]+'</span><span class="fl">&nbsp;\uffe5'+R[0]+"</span>";$("#accidentProtected").parent().before('<a href="javascript:;" onclick="ec.product.click_function(this)" class="product-service-btn">'+aq+"</a>")}else{$("#accidentProtected").parent().parent().hide()}$("#pro-service").show()}else{$("#pro-service").hide();$("#extendSelect").attr("skuid","");$("#extendSelect").attr("data-scode","");$("#accidentSelect").attr("skuid","");$("#accidentSelect").attr("data-scode","");$("#extendSelect").html("");$("#accidentSelect").html("");$("#extendProtected ul").each(function(s){$(this).html("")});$("#accidentProtected ul").each(function(s){$(this).html("")})}_updateSelect();ec.product.initContract(Z);$("#integral").html(Z.integral);ec.product.renderGroup(g);if(ec.product.productType==4){ec.product.depositActivity(ec.product.getSku())}else{$("#goAddressId").hide();if($("#pro-global-parameter").attr("data-skulist-rushbuy")){ec.product.rushbuyActivity()}}var Z=ec.product.getSku();packFlag=false;Z=ec.product.getSkuInfo(Z);upDownButton="";ec.product.getFeature(Z.id);ec.product.getParameter(Z.id,Z.code);ec.product.getPackageAndService(Z.id);ec.product.switchSku();$(".product-tab-btn").css({display:"none"});ec.product.processSupportDisplayDilieryTime(Z);ec.product.queryPointWeight(ec.product.setSkuId||ec.product.defaultSku);ec.product.coupon.loadCoupon(Z.code);$("#product-prom-all").live("mouseenter",function(){$(".product-prom").addClass("show");$("#promBtn").css("display","none");$(".product-prom-item").hide();$(".product-prom-item").show();if(!isShowGifts){$("#pro-match-gift").hide()}$("#promBtn").hide()});$(".product-prom").live("mouseleave",function(){if(isShowGifts){if($("#product-prom-all").children().length<5){return}}else{if($("#product-prom-all").children().length<6){return}}$(".product-prom").removeClass("show");$("#promBtn").css("display","block");$(".product-prom .product-prom-item").hide();if(isShowGifts){for(var s=0;s<3;s++){$(".product-prom-item").eq(s).show()}$("#promBtn").show();for(var s=0;s<2;s++){$("#promBtn em").eq(s).hide()}}else{for(var s=1;s<4;s++){$(".product-prom-item").eq(s).show()}$("#promBtn").show();for(var s=0;s<3;s++){$("#promBtn em").eq(s).hide()}}})};ec.product.tabSkuInfo=function(r){$("#pro-tab-feature-content-"+r+", #pro-tab-feature-content2-"+r+", #pro-tab-parameter-content-"+r+", #pro-tab-package-content-"+r+", #pro-tab-service-content-"+r).show().siblings().hide();$("#comb-pro-area").find(".selected").each(function(){$(this).removeClass("selected")});$("#comb-count").html("0");var t=parseInt($("#comb-count").html(),10)&&0;var u=ec.product.getSkuInfo(r);var s=parseFloat(u.price);if(!(ec.product.productType&&ec.product.productType==4&&ec.product.isDespositSku==1)){$("#comb-price-label").html("\u7ec4\u5408\u4ef7\uff1a&yen;");$("#comb-price").html(s.toFixed(2))}$("#combList-list-"+r).show().siblings().hide();if(!($("#combList-list-"+r).children().eq(0).hasClass("current"))){$("#combList-list-"+r).children().eq(0).addClass("current").siblings().removeClass("current")}};ec.product.addSkuAttr=function(r,u,s,v,w){var y=b[r];if(!y){b[r]={attrIds:[v]}}else{y.attrIds.push(v)}j[v]=r;var x=k[s];if(!x){n.push(s);c.push(u);k[s]=[w]}else{if(x.indexOf(w)==-1){x.push(w)}}var t=q[u+"-"+w];if(!t){q[u+"-"+w]=[v]}else{t.push(v)}if(!l[w]){l[w]=[]}l[w].push(r)};ec.product.setSku=function(r,s){s=s||{};s.id=r;$.extend((b[r]||(b[r]={})),s)};ec.product.getAllSku=function(){return b};ec.product.getSku=function(){var r;$.each(e,function(){if(!r){r=this;return}var v=this,u=[];for(var t=0;t<r.length;t++){for(var s=0;s<v.length;s++){if(r[t]==v[s]){u.push(r[t])}}}r=u});if(!r||r.length!=1){return(g||ec.product.defaultSku)}return r[0]};ec.product.getSkuInfo=function(r){return b[r]};ec.product.setSkuForParement=function(r){h[r]=r};ec.product.getSkuForParement=function(r){return h[r]};ec.product.setSkuForFeature=function(r){_skuForGetFeature[r]=r};ec.product.getSkuForFeature=function(r){return _skuForGetFeature[r]};ec.product.setSkuShowType=function(r,s){o[r]=s};ec.product.setSkuPriority=function(r){a[r]=true};ec.product.getSkuPriority=function(r){return a[r]};ec.product.selectBySku=function(r){var s=b[r];if(!s||!s.attrIds){_upadteSkuPrice(s);if(ec.product.productType==4){ec.product.depositActivity(r)}else{$("#goAddressId").hide();if($("#pro-global-parameter").attr("data-skulist-rushbuy")){ec.product.rushbuyActivity()}}return}$("#pro-skus").find(".attr"+s.attrIds.join(",.attr")).children(".sku").trigger("click")};ec.product.queryPointWeight=function(r){var u=b[r];if(u||u.code){if(ec.product.productType==1||ec.product.productType==2||ec.product.productType==5||ec.product.productType==6){return}if(ec.product.seCode!="VMALL-HUAWEIDEVICE"){return}if(u.contractList&&u.contractList.length>0){return}if(ec.product.getSkuPointWeight(u.code)!=undefined){$("#promBtn p").append(ec.product.getSkuPointWeightDetail(u.code));var t=[];t.push('<div class="product-prom-item clearfix relative" id="promBtn">');t.push($("#promBtn").html());t.push("</div>");$("#promBtn").remove();$(".product-prom").append(ec.product.getSkuPointWeight(u.code));$(".product-prom .product-prom-item").hide();if($("#pro-gift-list-select").find("a").length>0&&isShowGifts){if($("#product-prom-all").children().length>4){for(var s=0;s<3;s++){$(".product-prom-item").eq(s).show()}$(".product-prom").append(t.join(""));$("#promBtn").show();for(var s=0;s<2;s++){$("#promBtn em").eq(s).hide()}}else{$(".product-prom .product-prom-item").show()}}else{if($("#product-prom-all").children().length>5){for(var s=1;s<4;s++){$(".product-prom-item").eq(s).show()}$(".product-prom").append(t.join(""));$("#promBtn").show();for(var s=0;s<3;s++){$("#promBtn em").eq(s).hide()}}else{$(".product-prom .product-prom-item").show()}}if($(".product-prom").parent().hasClass("hide")||$(".product-prom").parent().css("display")=="none"){$(".product-prom").parent().removeClass("hide");$(".product-prom").parent().css("display","")}if((!$("#pro-gift-list-select").find("a").length)>0||!isShowGifts){$("#pro-match-gift").hide()}if($("#pro-promotions-list").parent().parent().hasClass("hide")){$("#pro-promotions-list").parent().parent().removeClass("hide")}ec.product.refreshStyle()}else{$.ajax({url:openApiDomain+"/point/queryPointWeight.json?skuCodes=["+u.code+"]",dataType:"jsonp",timeout:10000,jsonpCallback:"queryPointWeightHandler",success:function(A){var x=1;if(A.resultCode=="200000"){A.pointWeightMap=A.data;if(A.pointWeightMap!=null){for(var w in A.pointWeightMap){if(A.pointWeightMap[w]!=null){x=A.pointWeightMap[w]}}}}var z=[],v=[];if(x==0){return}else{if(x==1){v.push('<em class="tag">\u8d60\u9001\u79ef\u5206</em>');z.push('<div class="product-prom-item clearfix" >');z.push('<em class="tag">\u8d60\u9001\u79ef\u5206</em>');z.push('<div class="product-prom-con">');z.push("\u8d2d\u4e70\u5373\u8d60\u5546\u57ce\u79ef\u5206\uff0c\u79ef\u5206\u53ef\u62b5\u73b0~");z.push("</div>");z.push("</div>")}else{if(x>1){v.push('<em class="tag">\u79ef\u5206\u7ffb\u500d</em>');z.push('<div class="product-prom-item clearfix" >');z.push('<em class="tag">\u79ef\u5206\u7ffb\u500d</em>');z.push('<div class="product-prom-con">');z.push("\u6d3b\u52a8\u8d60\u9001\u7ffb\u500d\u79ef\u5206\uff0c\u79ef\u5206\u53ef\u62b5\u73b0~");z.push("</div>");z.push("</div>")}}}$("#promBtn p").append(v.join(""));var B=[];B.push('<div class="product-prom-item clearfix relative" id="promBtn">');B.push($("#promBtn").html());B.push("</div>");$("#promBtn").remove();$(".product-prom").append(z.join(""));$(".product-prom .product-prom-item").hide();if($("#pro-gift-list-select").find("a").length>0&&isShowGifts){if($("#product-prom-all").children().length>4){for(var y=0;y<3;y++){$(".product-prom-item").eq(y).show()}$(".product-prom").append(B.join(""));$("#promBtn").show();for(var y=0;y<2;y++){$("#promBtn em").eq(y).hide()}}else{$(".product-prom .product-prom-item").show()}}else{if($("#product-prom-all").children().length>5){for(var y=1;y<4;y++){$(".product-prom-item").eq(y).show()}$(".product-prom").append(B.join(""));$("#promBtn").show();for(var y=0;y<3;y++){$("#promBtn em").eq(y).hide()}}else{$(".product-prom .product-prom-item").show()}}if($(".product-prom").parent().hasClass("hide")||$(".product-prom").parent().css("display")=="none"){$(".product-prom").parent().removeClass("hide");$(".product-prom").parent().css("display","")}if((!$("#pro-gift-list-select").find("a").length)>0||!isShowGifts){$("#pro-match-gift").hide()}ec.product.setSkuPointWeight(u.code,z.join(" "));ec.product.setSkuPointWeightDetail(u.code,v.join(" "));ec.product.refreshStyle()}})}}};ec.product.refreshStyle=function(){$(".product-operation-main").removeClass("product-operation-location");var r=$(".product-property").height();if(r<=536){$(".product-property").css("min-height","536px");$(".product-operation-main").addClass("product-operation-location")}else{$(".product-property").css("min-height","0");$(".product-operation-main").removeClass("product-operation-location")}};ec.ready(function(){ec.product.hiddenTips();$(".product-tab-btn").css({display:"none"});var A=[],w,F,H,r;for(var G=0;G<n.length;G++){w=c[G];r=(o[w]=="2");F=n[G];var x='<dl class="product-choose clearfix ';if(r){if(F=="\u5957\u9910"||F=="\u7c7b\u578b"){x+='" id = "bundlePackage" >'}else{x+='">'}}else{if(F=="\u5957\u9910"||F=="\u7c7b\u578b"){x+=' product-choosepic" id = "bundlePackage" >'}else{x+=' product-choosepic">'}}x+="<label>\u9009\u62e9"+F+'</label><div class="product-choose-detail"><ul>';A.push(x);var s=k[F];for(var E=0;E<s.length;E++){H=q[w+"-"+s[E]];A.push('<li class=" attr'+H.join(" attr")+'" data-attrName="'+F+'" data-attrCode="'+w+'" data-attrId="'+H.join(",")+'" data-skuId="'+l[s[E]].join(",")+'"><div class="sku"><a  href="javascript:;" title="'+s[E]+'">');if(r){A.push("<p><span>");A.push(s[E]);A.push("</span></p></a>")}else{var B=b[j[H[0]]];A.push('<img src="'+ec.mediaPath+B.photoPath+"40_40_"+B.photoName+'" alt="'+s[E]+'"/>');A.push("<p><span>"+s[E]+"</span></p></a>")}}A.push("</ol></dd></dl>")}var y=$(A.join(""));var z=function(M,O){var P=O.attr("data-skuId");if(O.parents("#packageSelect").length>0){return true}var K=false;for(var L=0,N=M.length;L<N;L++){if(P.indexOf(M[L]+"")>-1){K=true;break}}return K};var J=function(L){var N=[];var K=true;var M=null;$.each(L.find("li.selected"),function(){var U=$(this);var Q=U.find("a").attr("title");var R=U.closest("dl").next().find("li");if(K){N=l[Q];$.each(R,function(){var V=$(this);if(!z(N,V)){V.addClass("disabled").removeClass("selected")}else{V.removeClass("disabled")}});K=false;M=(g||ec.product.defaultSku);return}var S=[];var T=l[Q];for(var P=0;P<N.length;P++){for(var O=0;O<T.length;O++){if(N[P]==T[O]){S.push(N[P])}}}N=S;if(N.length!=1){M=(g||ec.product.defaultSku);if(N.length>1){$.each(R,function(){var V=$(this);if(!z(N,V)){V.addClass("disabled").removeClass("selected")}else{V.removeClass("disabled")}})}}else{$.each(R,function(){var V=$(this);if(!z(N,V)){V.addClass("disabled").removeClass("selected")}else{V.removeClass("disabled")}});M=N[0]}});return M};y.find(".sku").click(function(){var Q=$(this).parent();if(Q.hasClass("disabled")){return false}var R=Q.attr("data-attrId").split(","),N=Q.attr("data-attrName"),L=[];for(var M=0;M<R.length;M++){L.push(j[R[M]])}e[N]=L;Q.addClass("selected").siblings().removeClass("selected");$("#layoutRelative p a").each(function(){var S=$(this).css("display");if(S!="none"){$(this).addClass("selected").siblings().removeClass("selected");return false}});var P=J(y);var O=null;var K=true;$.each(y.find("ul"),function(){var S=$(this);if(1!=S.find("li.selected").length){O=S.find("li").not(S.find("li.disabled")).first();if(O.length>=1){K=false;return false}}});if(K){B=b[P];_updateSkuInfo();_updateSelect();d=false;ec.product.refreshStyle()}else{if(O){if(!d){$(O).find(".sku").trigger("click")}}}});if($(".hot-area").find("li").size()==0){$(".hot-area").hide();$("#pro-seg-hot").hide()}$("#pro-skus").html(y);A=[],skuId=ec.product.getSku();B=ec.product.getSkuInfo(skuId);if(ec.product.seCode!=ec.product.productSeCode){A.push("\u5df2\u5305\u90ae<em></em>"+ec.product.productshopName+"\u53d1\u8d27\uff0c\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1")}else{if(parseFloat(ec.product.deliveryModeValueFreeBase)>0&&ec.product.productType==0){if(B.priceMode!=2){if(parseFloat(B.price)>=parseFloat(ec.product.deliveryModeValueFreeBase)){A.push("\u5df2\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5df2\u514d\u8fd0\u8d39<em></em>")}else{A.push("\u6ee1"+ec.product.deliveryModeValueFreeBase+"\u5143\u5373\u514d\u8fd0\u8d39\uff0c\u5feb\u53bb\u51d1\u5355\u5427<em></em>")}}}A.push("\u7531\u534e\u4e3a\u5546\u57ce\u8d1f\u8d23\u53d1\u8d27\uff0c\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1")}$("#service-description").html(A.join(" "));if(y.find(".sku").length==0){var B=ec.product.getSku();packFlag=false;B=ec.product.getSkuInfo(B);upDownButton="";ec.product.getFeature(B.id);ec.product.getParameter(B.id,B.code);ec.product.getPackageAndService(B.id);ec.product.processSupportDisplayDilieryTime(B)}ec.product.selectBySku(ec.product.setSkuId||ec.product.defaultSku);var C=ec.product.setSkuId||ec.product.defaultSku,D,u=false,t=false;D=ec.product.getSkuInfo(C);if(!D.promotionLst||D.promotionLst.length==0){u=false}else{u=true}if(!D.giftList||D.giftList.length==0){t=false}else{t=true}if(!u){$("#pro-promotions-list").html("");$("#pro-promotions-list").hide()}if(t){$("#product-info-list-new").show();$("#pro-match-gift").show();$("#pro-gift-list-select").html(ec.product.gift.ftl(ec.product.getSku()))}else{$("#pro-gift").hide()}$("#pro-gallerys").find("img").mouseover(_proGallerysMouseOver);var v=getUrlParaMap4CartBinding();var I=v.isSuccess;if(null!=I&&"0"==I){bindCartResult("ec-binding-phone")}$("#address").hover(function(){var K=ec.product.getSku();K=ec.product.getSkuInfo(K);ec.product.processAddress(K)},function(){})})})();ec.product.disableAddCartButtons=function(){$("#pro-operation a.product-button01").each(function(){$(this).removeClass("product-button01").addClass("product-button01 disabled");this.backup=this.onclick;this.onclick=""});$("#pro-operation a.product-button02").each(function(){$(this).removeClass("product-button02").addClass("product-button02 disabled");this.backup=this.onclick;this.onclick=""});$("#pro-operation a.button-book-2").each(function(){$(this).removeClass("pro-button01 button-style-2").addClass("pro-button01 button-style-disabled-2");this.backup=this.onclick;this.onclick=""});$("a.button-add-cart-2, a.button-add-cart-3").each(function(){$(this).removeClass("pro-button01 button-style-1").addClass("pro-button01 button-style-disabled-2");this.backup=this.onclick;this.onclick=""})};ec.product.enableAddCartButtons=function(){$("#pro-operation a.product-button01").each(function(){$(this).removeClass("product-button01 disabled").addClass("product-button01").css("background-position-y","8px");this.onclick=this.backup;this.backup=""});$("#pro-operation a.product-button02").each(function(){$(this).removeClass("product-button02 disabled").addClass("product-button02").css("background-position-y","8px");this.onclick=this.backup;this.backup=""});$("#pro-operation a.button-book-2").each(function(){$(this).removeClass("pro-button01 button-style-disabled-2").addClass("pro-button01 button-style-2");this.onclick=this.backup;this.backup=""});$("a.button-add-cart-2, a.button-add-cart-3").each(function(){$(this).removeClass("pro-button01 button-style-disabled-2").addClass("pro-button01 button-style-1");this.onclick=this.backup;this.backup=""})};ec.product.addCart=function(){var g=parseInt($("#pro-quantity").val()),u=parseInt($("#header-cart-total").html());$("#header-cart-total").html(u+g);var j=$("#pro-skus").find("dl");for(p=0;p<j.length;p++){var q=false;var z=j.get(p);if($(z).parent().parent().parent().attr("id")=="goodsRecommend-recommend"){break}$(z).children(".product-choose-detail").children("ul").find("li").each(function(A){if($(this).hasClass("selected")){q=true;return}});if(!q){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var d;var h=ec.product.getSku();var s=parseInt($("#pro-quantity").val());var e=ec.cart.productTypeCorrespondence(ec.product.productType);var l=$("#extendSelect").attr("skuid");var m=$("#accidentSelect").attr("skuid");var r=ec.product.gift.finalMainSbomGiftMap[h];var k="";var n=[];var a="";var f=[];var t=ec.product.finalGift();d={salePortal:1,saleChannel:1001,needResultset:0,cartjson:t.cartjson};var i=[];var w={};var f=t.gifts2Order;w.itemId=$("#pro-sku-code").val();w.qty=$("#pro-quantity").val();w.itemType="S0";w.gifts=f;i.push(w);var c=$("#extendSelect").attr("data-scode");var y=$("#accidentSelect").attr("data-scode");var x=[],o={},v={};if(c.length>0){o.itemId=c;o.qty=$("#pro-quantity").val();o.itemType="S1";o.itemProp={main_skucode:$("#pro-sku-code").val()};i.push(o);if(y.length>0){v.itemId=y;v.qty=$("#pro-quantity").val();v.itemType="S6";v.itemProp={main_skucode:$("#pro-sku-code").val()};i.push(v)}}else{if(y.length>0){v.itemId=y;v.qty=$("#pro-quantity").val();v.itemType="S6";v.itemProp={main_skucode:$("#pro-sku-code").val()};i.push(v)}}var b=ec.lang.json.stringify(i);ec.cart.add(d,{successFunction:function(B){if(B.resultCode==200000){var A=B.cartInfo;$("#cart-tips").show();$("#cart-tips").find("p").html($("#pro-name").text());$(".pro-add-success-total").hide();$("#header-cart-total").html(B.cartNumber)}ec.product.enableAddCartButtons()},errorFunction:function(A){$("#popup-tips-msg").html(A.msg);$("#popup-tips").show();ec.product.enableAddCartButtons()}});ec.product.clickHide=function(A){$(document).click(function(){$("#"+A).hide()});$("#"+A).click(function(B){B.stopPropagation()})};ec.product.clickHide("cart-tips")};ec.product.finalGift=function(t){ec.product.packageGetSkuCode();var v="";var k="";var g=ec.product.getSku();var d;var c=$("#pro-sku-code").val();var u=parseInt($("#pro-quantity").val());var l=$("#extendSelect").attr("data-scode");var n=$("#accidentSelect").attr("data-scode");var s=ec.product.gift.finalMainSbomGiftMap[g];var o=[];var a=[];var f=[];var j=[];var b=1;var m="";if(($("#packageCode").val())!=""){d="P";m={package_code:$("#packageCode").val()};var e=($("#packageListCode").val()).split(",");for(var r=0;r<e.length;r++){cartTemp={itemCode:e[r],itemType:"P",qty:u};j.push(cartTemp)}}else{d="S0"}if(s){for(var w in s){var q={sbomCode:s[w].giftSkuCode};var h={sbomCode:s[w].giftSkuId};a.push(h);f.push(q);cartTemp={itemCode:s[w].giftSkuCode,itemType:"G",qty:u};j.push(cartTemp)}if(l.length>0&&n.length>0){j.push({itemCode:l,itemType:"S1",qty:u});j.push({itemCode:n,itemType:"S6",qty:u});k=JSON.stringify({itemCode:c,itemType:d,qty:u,subs:j,attrs:m})}else{if(l.length>0){j.push({itemCode:l,itemType:"S1",qty:u});k=JSON.stringify({itemCode:c,itemType:d,qty:u,subs:j,attrs:m})}else{if(n.length>0){j.push({itemCode:n,itemType:"S6",qty:u});k=JSON.stringify({itemCode:c,itemType:d,qty:u,subs:j,attrs:m})}else{k=JSON.stringify({itemCode:c,itemType:d,qty:u,subs:j,attrs:m})}}}}else{if(l.length>0&&n.length>0){j.push({itemCode:l,itemType:"S1",qty:u});j.push({itemCode:n,itemType:"S6",qty:u});k=JSON.stringify({itemCode:c,itemType:d,qty:u,subs:j,attrs:m})}else{if(l.length>0){j.push({itemCode:l,itemType:"S1",qty:u});k=JSON.stringify({itemCode:c,itemType:d,qty:u,subs:j,attrs:m})}else{if(n.length>0){j.push({itemCode:n,itemType:"S6",qty:u});k=JSON.stringify({itemCode:c,itemType:d,qty:u,subs:j,attrs:m})}else{cartjson0={itemCode:c,itemType:d,qty:u,attrs:m,subs:j};k=JSON.stringify(cartjson0)}}}}v={cartjson:k,};return v};ec.product.orderNowCover=function(){ec.product.isCover=true;ec.account.afterLogin(function(){var f=$("#pro-skus").find("dl");for(p=0;p<f.length;p++){var h=false;var i=f.get(p);$(i).children(".product-choose-detail").children("ul").find("li").each(function(k){if($(this).hasClass("selected")){h=true;return}});if(!h){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var g;var c;var b;var d;var e=[];g=ec.product.getSku();g=$("#pro-sku-code").val();c=$("#pro-quantity").val();b=$("#extendSelect").attr("skuid");d=$("#accidentSelect").attr("skuid");var j="";j='<input name="sbomCode" type="text" value="'+g+'">';j+='<input name="quantity" type="text" value="'+c+'">';if(b){j+='<input name="extendServiceSKU" type="text" value="'+b+'">'}if(d){j+='<input name="exceptionServiceSKU" type="text" value="'+d+'">'}j+='<input name="state" type="text" value="0">';var a=gid("order-cover-form");a.innerHTML=j;ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){a.action=domainMain+"/uidesign/edit";a.submit()},500)})})};ec.product.orderEasyBuy=function(){var b=$("#pro-skus").find("dl");for(p=0;p<b.length;p++){var e=false;var g=b.get(p);$(g).children(".product-choose-detail").children("ul").find("li").each(function(m){if($(this).hasClass("selected")){e=true;return}});if(!e){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}var i=ec.product.getSku();var h=ec.product.getSkuInfo(i);var a=ec.product.gift.finalMainSbomGiftMap[i];var d=$("#pro-sku-code").val(),l=$("#extendSelect").attr("data-scode"),k=$("#accidentSelect").attr("data-scode"),c="";if(a){var f=[];for(var j in a){f.push(a[j].giftSkuCode)}c=f.join(",")}if(h.easyBuyPcUrl!=""){window.location.href=h.easyBuyPcUrl}};ec.product.isEasyBuy=function(){var g=ec.product.getSkuInfo(ec.product.getSku());var c=$("#isPriority").val();var f=ec.product.getSkuPriority(ec.product.getSku());if(c==1&&f==true){return false}if(g&&g.showEasyBuy=="1"){var e=g.easyBuyStartTime;var b=g.easyBuyEndTime;if(e!=""&&b!=""){var h=ec.product.getSysDate();var d=new Date();d.setTime(e.parseDate("yyyy-MM-dd HH:mm:ss"));var a=new Date();a.setTime(b.parseDate("yyyy-MM-dd HH:mm:ss"));if((h-d)>0&&(h-a)<0){if(g.webEnabled=="1"){return true}}}else{if(e!=""){var h=ec.product.getSysDate();var d=new Date();d.setTime(e.parseDate("yyyy-MM-dd HH:mm:ss"));if((h-d)>0){if(g.webEnabled=="1"){return true}}}}}return false};ec.product.renderVisitorButton=function(f){var d=ec.util.cookie.get("isValCas"),e=ec.util.cookie.get("CASLOGIN"),c=ec.util.cookie.get("uid"),a=ec.util.cookie.get("displayName");if(ec.account.isLogin()||d!=null||e!=null||c!=null||a!=null){return}var b=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);skuId=b.id;if(ec.product.isSupportVisitorMode!="1"||ec.product.productType==4||rush.sbom.isRushProduct()||rush.sbom.isRushSbom(skuId)){return}$("#product-deposit-agreement-area").next().remove()};ec.product.orderNowByVisitor=function(f){var l=$("#pro-skus").find("dl");for(p=0;p<l.length;p++){var o=false;var x=l.get(p);$(x).children(".product-choose-detail").children("ul").find("li").each(function(y){if($(this).hasClass("selected")){o=true;return}});if(!o){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var j=[];var t={};t.itemId=$("#pro-sku-code").val();t.qty=$("#pro-quantity").val();t.itemType="S0";if(ec.product.productType==9){t.itemType="S9"}var r=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];if(r){var h=[];for(var w in r){var q={sbomCode:r[w].giftSkuCode};h.push(q)}t.gifts=h}t.subOrderItemReqArgs=[];var m=$("#packageCode").val();if(m!=""){t.itemType="P";var b={package_code:m};t.itemProp=b}var i=$("#packageListCode").val();if(i!=""){$.each(i.split(","),function(z,A){var y={itemId:A,qty:$("#pro-quantity").val(),itemType:"P"};t.subOrderItemReqArgs.push(y)})}var g=$("#extendSelect").attr("data-scode");var v=$("#accidentSelect").attr("data-scode");var u=[],n={},s={};if(g.length>0){u[0]=g;if(v.length>0){u[1]=v}}else{if(v.length>0){u[0]=v}}var e={};if(f==2&&_giftBuyItemId.length>0){e.itemId=_giftBuyItemId[0];e.qty=$("#pro-quantity").val();e.itemType="S10";e.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(e)}var n={};var s={};if(g.length>0){n.itemId=u[0];n.qty=$("#pro-quantity").val();n.itemType="S1";n.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(n);if(v.length>0){s.itemId=u[1];s.qty=$("#pro-quantity").val();s.itemType="S6";s.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(s)}}else{if(v.length>0){s.itemId=u[0];s.qty=$("#pro-quantity").val();s.itemType="S6";s.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(s)}}j.push(t);var d=ec.lang.json.stringify(j);var k="";k+='<input name="orderReqJson" type="text" value=\''+d+"'>";k+='<input name="state" type="text" value="0">';if(f==2&&_giftBuyItemId.length>0){k+='<input name="routingTag" type="hidden" value="30">'}if(ec.product.productType==9){k+='<input name="routingTag" type="text" value="28">'}var a=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(parseInt(a.buttonMode)==13){$("#order-confirm-form").attr("action","/order/o2oConfirm")}if(ec.product.isSupportVisitorMode=="1"){$("#order-confirm-form").attr("action","/visitor/vistorConfirm")}var c=gid("order-confirm-form");c.innerHTML=k;c.submit()};ec.product.orderNow=function(a){ec.product.isGift=a;ec.product.isCover=false;ec.product.isComb=false;ec.account.afterLogin(function(){var l=$("#pro-skus").find("dl");for(p=0;p<l.length;p++){var o=false;var x=l.get(p);if($(x).parent().parent().parent().attr("id")=="goodsRecommend-recommend"){break}$(x).children(".product-choose-detail").children("ul").find("li").each(function(y){if($(this).hasClass("selected")){o=true;return}});if(!o){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var j=[];var t={};t.itemId=$("#pro-sku-code").val();t.qty=$("#pro-quantity").val();t.itemType="S0";if(ec.product.productType==9){t.itemType="S9"}var r=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];if(r){var h=[];for(var w in r){var q={sbomCode:r[w].giftSkuCode};h.push(q)}t.gifts=h}t.subOrderItemReqArgs=[];var m=$("#packageCode").val();if(m!=""){t.itemType="P";var c={package_code:m};t.itemProp=c}var i=$("#packageListCode").val();if(i!=""){$.each(i.split(","),function(z,A){var y={itemId:A,qty:$("#pro-quantity").val(),itemType:"P"};t.subOrderItemReqArgs.push(y)})}var g=$("#extendSelect").attr("data-scode");var v=$("#accidentSelect").attr("data-scode");var u=[],n={},s={};if(g.length>0){u[0]=g;if(v.length>0){u[1]=v}}else{if(v.length>0){u[0]=v}}var f={};if(a==2&&_giftBuyItemId.length>0){f.itemId=_giftBuyItemId[0];f.qty=$("#pro-quantity").val();f.itemType="S10";f.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(f)}var n={};var s={};if(g.length>0){n.itemId=u[0];n.qty=$("#pro-quantity").val();n.itemType="S1";n.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(n);if(v.length>0){s.itemId=u[1];s.qty=$("#pro-quantity").val();s.itemType="S6";s.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(s)}}else{if(v.length>0){s.itemId=u[0];s.qty=$("#pro-quantity").val();s.itemType="S6";s.mainSkuCode=$("#pro-sku-code").val();t.subOrderItemReqArgs.push(s)}}j.push(t);var e=ec.lang.json.stringify(j);var k="";k+='<input name="orderReqJson" type="text" value=\''+e+"'>";k+='<input name="state" type="text" value="0">';if(a==2&&_giftBuyItemId.length>0){k+='<input name="routingTag" type="hidden" value="30">'}if(ec.product.productType==9){k+='<input name="routingTag" type="text" value="28">'}var b=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(parseInt(b.buttonMode)==13){$("#order-confirm-form").attr("action","/order/o2oConfirm")}var d=gid("order-confirm-form");d.innerHTML=k;ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){d.submit()},500)})})};ec.product.addCartWithLogin=function(){ec.account.afterLogin(ec.product.addCart)};ec.product.buyBundle=function(g,h){var a=$(h).html();var e=$("#pro-sku-code").val();var c=$("#pro-quantity").val();var d=$("#packageCode").val();var f=$("#packageListCode").val();pushBottonMsg(a,c,e,d,f,"300020402");ec.product.disableAddCartButtons();var b=ec.product.finalGift(g);paras={cartjson:b.cartjson};ec.cart.add(paras,{successFunction:function(i){ec.product.enableAddCartButtons();$("#order-shoppingCart-form").submit()},errorFunction:function(i){ec.product.enableAddCartButtons();alert(i.msg)}})};ec.product.addComb=function(h){var j=$(h).attr("data-index");var e=[];var a=ec.product.getSku(),d=[a],b=[1],i=[1],f=$("#isPriority").val();skuCode=$("#pro-sku-code").val();var k={};k.itemCode=$("#pro-sku-code").val();k.qty=1;k.itemType="S0";e.push(k);var c=[];var g={itemCode:skuCode,itemType:"S0",qty:1};c.push(g);$('[id="comb-pro-'+a+"-"+j+'"]').find("input[name=skuId]:checked").each(function(){d.push(this.value);b.push(1);i.push(1);var n={};n.itemId=this.value;n.qty=1;n.itemType="S0";e.push(n);var o={itemType:"S0",qty:1,itemCode:$(this).attr("data-scode")};c.push(o)});var m={number:1,cartjson:JSON.stringify(c)};if(f==1){if(ec.product.getSkuPriority(a)==true){return ec.product.buy("sku",d)}}$("#order-confirm-form").attr({action:"/order/nowConfirmcart",method:"post"});ec.product.disableAddCartButtons();var l=ec.lang.json.stringify(e);ec.cart.add(m,{successFunction:function(n){ec.product.enableAddCartButtons();$("#order-shoppingCart-form").submit()},errorFunction:function(n){ec.product.enableAddCartButtons();alert(n.msg)}})};ec.product.orderComb=function(a){ec.product.isComb=true;ec.account.afterLogin(function(){var g=$("#pro-skus").find("dl");for(p=0;p<g.length;p++){var i=false;var j=g.get(p);$(j).children(".product-choose-detail").children("ul").find("li").each(function(q){if($(this).hasClass("selected")){i=true;return}});if(!i){alert("\u8bf7\u9009\u62e9\u9700\u8981\u8d2d\u4e70\u7684\u7c7b\u578b");return false}}ec.product.disableAddCartButtons();var m=$(a).attr("data-index");var h=[];var k={};$('[id="comb-pro-'+ec.product.getSku()+"-"+m+'"]').find("input[name=skuId]:checked").each(function(){var q={};q.itemId=$(this).attr("data-scode");q.qty=1;q.itemType="S0";h.push(q)});k.itemId=$("#pro-sku-code").val();k.qty=$("#pro-quantity").val();k.itemType="S0";if(ec.product.productType==9){k.itemType="S9"}var d=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];if(d){var c=[];for(var n in d){var f={sbomCode:d[n].giftSkuCode};c.push(f)}k.gifts=c}h.push(k);var o=ec.lang.json.stringify(h);var l="";l+='<input name="orderReqJson" type="text" value=\''+o+"'>";l+='<input name="state" type="text" value="0">';if(ec.product.productType==9){l+='<input name="routingTag" type="text" value="28">'}var e=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);if(parseInt(e.buttonMode)==13){$("#order-confirm-form").attr("action","/order/o2oConfirm")}var b=gid("order-confirm-form");b.innerHTML=l;ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){b.submit()},500)})})};ec.product.buy=function(a,b){ec.account.afterLogin(function(){var l="";if(a=="sku"){var h=[];var k={};k.itemId=$("#pro-sku-code").val();k.qty=1;k.itemType="S0";var e=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];if(e){var d=[];for(var n in e){var f={sbomCode:e[n].giftSkuCode};d.push(f)}k.gifts=d}k.subOrderItemReqArgs=[];var q=$("#extendSelect").attr("data-scode");var g=$("#accidentSelect").attr("data-scode");var i=[],m={},j={};if(q.length>0){i[0]=q;if(g.length>0){i[1]=g}}else{if(g.length>0){i[0]=g}}var m={};var j={};if(q.length>0){m.itemId=i[0];m.qty=$("#pro-quantity").val();m.itemType="S1";m.mainSkuCode=$("#pro-sku-code").val();k.subOrderItemReqArgs.push(m);if(g.length>0){j.itemId=i[1];j.qty=$("#pro-quantity").val();j.itemType="S6";j.mainSkuCode=$("#pro-sku-code").val();k.subOrderItemReqArgs.push(j)}}else{if(g.length>0){j.itemId=i[0];j.qty=$("#pro-quantity").val();j.itemType="S6";j.mainSkuCode=$("#pro-sku-code").val();k.subOrderItemReqArgs.push(j)}}h.push(k);var o=ec.lang.json.stringify(h);l='<input name="orderReqJson" type="text" value=\''+o+"'>"}var c=gid("order-confirm-form");c.innerHTML=l;ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){c.submit()},500)})})};ec.product.timingBuy=function(){var c=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku);var d=ec.product.getSysDate();var a=c.startTime;var b=new Date();b.setTime(a.parseDate("yyyy-MM-dd HH:mm:ss"));var i=[];i.push(a);var j=c.countDown;$("#pro-operation").css("visibility","visible");$("#product-operation").show();if((d-b)>=0){var e=c.endTime;var f=new Date();if(null==e||""==e){f=new Date(2999,1,1,0,0,0)}else{f.setTime(e.parseDate("yyyy-MM-dd HH:mm:ss"))}if((d-f)<0){var h=ec.product.inventory.haveInventory(c.id);if(h){var g='<a href="javascript:;" onclick="ec.product.addCart()" class="product-button01" ><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a><a href="javascript:;" onclick="ec.product.orderNow()" class="product-button02" ><span>\u7acb\u5373\u4e0b\u5355</span></a><span class="product-button-tips">\u9650\u65f6\u62a2\u8d2d\u8fdb\u884c\u4e2d</span>';ec.product.renderVisitorButton($("#pro-operation"));$("#pro-operation").html(g);$("#product-operation").show()}else{$("#pro-quantity-area").hide();$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#product-operation").show();$("#product-recommend-all").hide()}}else{$("#pro-operation").html('<a href="javascript:;" class="product-button02 disabled">\u6d3b\u52a8\u5df2\u7ed3\u675f</a>');$("#pro-operation").css("visibility","visible");$("#product-operation").show();$("#product-recommend-all").hide()}}else{if(!ec.util.isEmpty(c.gotoUrl)&&((b-d)/(1000*3600)>j)){if(1==c.isShowReminder){$("#pro-operation").html('<a target="_blank" href="'+c.gotoUrl+'" class="product-button02" ><span>\u5f00\u552e\u63d0\u9192</span></a>');$("#product-operation").show()}else{if(0==c.isShowReminder){var g='<a href="javascript:;" class="product-button01 disabled" ><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a><a href="javascript:;"  class="product-button02 disabled" ><span>\u7acb\u5373\u4e0b\u5355</span></a><div class="product-time"></div>';$("#pro-operation").html(g);$("#product-operation").show();ec.ui.countdown2($(".product-time"),{html:"<p>\u79bb\u62a2\u8d2d\u5f00\u59cb\u8fd8\u6709\uff1a</p><ul><li><span>{#day}</span></li><li><em>\u5929</em></li><li><span>{#hours}</span></li><li><em>:</em></li><li><span>{#minutes}</span></li><li><em>:</em></li><li><span>{#seconds}</span></li>",now:d,times:i,callback:function(k){var l='<a href="javascript:;" onclick="ec.product.addCart()" class="product-button01" ><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a><a href="javascript:;" onclick="ec.product.orderNow()" class="product-button02" ><span>\u7acb\u5373\u4e0b\u5355</span></a>';$("#pro-operation").html(l);$("#product-operation").show()}})}}}else{var g='<a href="javascript:;" class="product-button01 disabled" ><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a><a href="javascript:;"  class="product-button02 disabled" ><span>\u7acb\u5373\u4e0b\u5355</span></a><div class="product-time"></div>';$("#pro-operation").html(g);$("#product-operation").show();ec.ui.countdown2($(".product-time"),{html:"<p>\u79bb\u62a2\u8d2d\u5f00\u59cb\u8fd8\u6709\uff1a</p><ul><li><span>{#day}</span></li><li><em>\u5929</em></li><li><span>{#hours}</span></li><li><em>:</em></li><li><span>{#minutes}</span></li><li><em>:</em></li><li><span>{#seconds}</span></li>",now:d,times:i,callback:function(k){var l='<a href="javascript:;" onclick="ec.product.addCart()" class="product-button01" ><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a><a href="javascript:;" onclick="ec.product.orderNow()" class="product-button02" ><span>\u7acb\u5373\u4e0b\u5355</span></a>';$("#pro-operation").html(l);$("#product-operation").show()}})}}};ec.product.arrival=function(){ec.account.afterLogin(function(){ec.product.syncCustomSession();var b=ec.product.email;var a=ec.product.mobile;var d="";var c=new ec.box($("#product-arrival-html").val(),{boxid:"product-arriva-box",boxclass:"ol_box_4",title:"\u5230\u8d27\u901a\u77e5",showButton:false,onopen:function(e){if(ec.util.isEmpty(b)){$("#arrival-email").css({cursor:"pointer"});$("#arrival-email").click(function(){window.open("/member/account");ec.product.bind()});$("#arrival-email").attr("class","disabled");$("#account-email").html('\u672a\u7ed1\u5b9a\u5b89\u5168\u90ae\u7bb1&nbsp;<a href="javascript:;" target="_blank">\u53bb\u7ed1\u5b9a</a>')}else{$("#arrival-email").bind("click",function(){d=ec.product.chooseNoticeType("email")});$("#account-email").html(b)}if(ec.util.isEmpty(a)){$("#arrival-mobile").css({cursor:"pointer"});$("#arrival-mobile").click(function(){window.open("/member/account");ec.product.bind()});$("#arrival-mobile").attr("class","disabled");$("#account-mobile").html('\u672a\u7ed1\u5b9a\u5b89\u5168\u624b\u673a&nbsp;<a href="javascript:;" target="_blank">\u53bb\u7ed1\u5b9a</a>')}else{$("#arrival-mobile").bind("click",function(){d=ec.product.chooseNoticeType("mobile")});$("#account-mobile").html(ec.product.splitMobile(a))}},onok:function(g){if(d.length==0){$("#arrival-error span").html("\u8bf7\u9009\u62e9\u4e00\u79cd\u901a\u77e5\u65b9\u5f0f\uff01");$("#arrival-error").removeClass("hide");return}var f="1";var e=b;if(d=="mobile"){f="3";e=a}new ec.ajax().submit({url:"/product/arrivalMail.json",data:{informWay:e,type:f,skuId:ec.product.getSku(),skuCode:$("#pro-sku-code2").html()},timeout:10000,timeoutFunction:function(){$("#arrival-error span").html("\u64cd\u4f5c\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01");$("#arrival-error").removeClass("hide")},beforeSendFunction:ec.ui.loading.show,afterSendFunction:ec.ui.loading.hide,successFunction:function(h){if(!h.success){$("#arrival-error span").html(h.msg);$("#arrival-error").removeClass("hide");return}alert("\u8bbe\u7f6e\u6210\u529f\uff01");$("#arrival-error").addClass("hide");g.close();$(".ol_box_mask").remove()}})},onclose:function(e){$(".ol_box_mask").remove()}});c.open();ec.product.bind=function(){c.close();$(".ol_box_mask").remove()}})};ec.product.chooseNoticeType=function(a){$("#arrival-email").removeClass("selected");$("#arrival-mobile").removeClass("selected");$("#arrival-"+a).attr("class","selected");return a};ec.product.attention=function(){var a=new ec.box($("#product-attention-html").val(),{boxid:"product-attention-box",title:"\u5173\u6ce8\u5546\u54c1",width:580,focus:"input[name=email]",showButton:false,onok:function(e){var d=e.find("input[name=email]").val(),c=e.find("input[name=mobile]").val(),b=/^0?(13|14|15|17|18)[0-9]{9}$/;if(!d){alert("\u8bf7\u8f93\u5165email\uff01");return}if(!ec.util.isEmail(d)){alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684email\uff01");return}if(!c){alert("\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801\uff01");return}if(!b.test(c)){alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\uff01");return}new ec.ajax().submit({url:"/product/saveAttention.json",data:{email:d,phone:c,skuId:ec.product.getSku()},timeout:10000,timeoutFunction:function(){alert("\u64cd\u4f5c\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},beforeSendFunction:ec.ui.loading.show,afterSendFunction:ec.ui.loading.hide,successFunction:function(f){if(!f.success){ec.showError(f);return}alert("\u8bbe\u7f6e\u6210\u529f\uff01");e.close()}})}});a.open();a.find("input[name=email]").focus()};ec.product.checkExtend=function(){var a=ec.product.getSku();val=$.trim($("#extend-text").val()),$succussMsg=$("#extend-msg-succuss"),$errorMsg=$("#extend-msg-error"),msgText='<span class="fcn">*</span>&nbsp;',link="";if(val.length>5){new ec.ajax().get({url:"/tcs/query.json?_t="+(new Date()).getTime()+"&skuId="+a+"&imei="+val,timeout:10000,timeoutFunction:function(){$("#pro-extend-result-id").removeClass("hide");$errorMsg.html(msgText+"\u64cd\u4f5c\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01").show();$succussMsg.hide()},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:ec.ui.loading.hide,successFunction:function(b){if(!b.success){if(b.otherPrdId){link='&nbsp;&nbsp;<a href="/product/'+b.otherPrdId+".html#"+b.otherSkuId+',0">\u524d\u53bb\u8d2d\u4e70>></a>'}$("#pro-extend-result-id").removeClass("hide");$errorMsg.html(msgText+b.msg+link).show();$succussMsg.hide();$("#button-extend").attr("class","pro-button01 button-style-disabled-1 button-go-extend-checkout-disabled");return}$("#pro-extend-result-id").removeClass("hide");$succussMsg.html(msgText+b.msg).show();$errorMsg.hide();$("#button-extend").attr("class","pro-button01 button-style-1 button-go-extend-checkout")}})}else{$succussMsg.hide();$("#pro-extend-result-id").removeClass("hide");$errorMsg.html(msgText+"\u8bf7\u8f93\u5165\u6b63\u786e\u7684IMEI/SN/MEID\u4fe1\u606f").show();$("#button-extend").attr("class","pro-button01 button-style-disabled-1 button-go-extend-checkout-disabled")}return false};ec.product.extendBuyNow=function(){$("#extend-text").val("");$("#extend-msg-succuss,#extend-msg-error").hide();$("#button-extend")[0].className="pro-button01 button-style-disabled-1 button-go-extend-checkout-disabled";$("#popup-extend").show()};ec.product.extendBuy=function(b){var a=$.trim($("#extend-text").val());if(b.className!="pro-button01 button-style-1 button-go-extend-checkout"||!a){return}ec.account.afterLogin(function(){var f=ec.product.getSku(),c="",e=gid("order-confirm-extend-form");if(!ec.util.isArray(f)){f=[f]}for(var d=0;d<f.length;d++){c+='<input name="skuIds" type="text" value="'+f[d]+'">'}c+='<input name="imei" type="text" value="'+a+'">';e.innerHTML=c;ec.binding.isBindedMobileOrEnterpriseUser(function(){setTimeout(function(){e.submit()},500)})})};ec.product.initContract=function(d){if(d.contractList.length>0){var a,b;html=[];for(var c=0;c<d.contractList.length;c+=1){a=d.contractList[c];html.push('<li data-id="'+a.id+'"> <div class="sku"><a title="'+a.name+'" href="javascript:;"><p><span>'+a.name+"</span></p></a><s></s></div ></li>")}b=$(html.join(""));$(".sku",b).click(function(){$(this).parent().toggleClass("selected").siblings().removeClass("selected")});$("#contractList-ol").html(b);$("#contractLst").show();$("#contractLst .sku").unbind("click").click(function(){$(this).parent().toggleClass("selected").siblings().removeClass("selected");var j=$("#pro-quantity-area"),f=$("#contractLst li.selected"),i=$("#pro-operation"),h=$("#contractForm"),e,k;ec.product.addCartBtn=ec.product.addCartBtn||i.html();e=ec.product.getSku();k=ec.product.inventory.haveInventory(e);if(ec.product.status==3){ec.product.execute("renderInventory",[k]);j.show()}else{if(f.length>0&&k){j.hide();i.html($('<a class="product-button02" href="javascript:;"><span>\u7acb\u5373\u8d2d\u4e70</span></a>').click(function(){var m=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];var l=[];if(m){for(var n in m){l.push(m[n].giftSkuCode)}}var o=gid("contractForm");o.innerHTML='<input name="gifts" type="text" value="'+l+'">';setTimeout(function(){var q=h.attr("action");h.attr("action",q.replace("{id}",f.attr("data-id"))).submit()},200)})).css("visibility","visible");$("#product-operation").show()}else{if(f.length>0&&!k){var g=$("#pro-operation");$("#pro-quantity-area").hide();g.css("visibility","visible");g.html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#tab-notice-button").show();$("#product-operation").show();j.show()}else{ec.product.execute("renderInventory",[k]);j.show()}}}});$("#contractLst .sku").eq(0).click();if(parseInt(ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku).buttonMode)>13||parseInt(ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku).buttonMode)==0){$("#product-operation").remove()}}else{$("#contractLst").hide()}};ec.product.jmptoRemark=function(){$("#pro-tab-evaluate").click();ec.ui.scrollTo("#pro-tab-evaluate")};ec.product.combClick=function(a){if($(a).hasClass("selected")==false){$(a).addClass("selected");$(a).children("input").attr("checked",true)}else{$(a).removeClass("selected");$(a).children("input").attr("checked",false)}var b=$(a).children("input");count=parseInt($("#comb-count").html(),10)||0,price=parseFloat($("#comb-price").html())||0;if(b.attr("checked")==true){price+=parseFloat(b.attr("data-price"));count++}else{price-=parseFloat(b.attr("data-price"));count--}if(!(ec.product.productType&&ec.product.productType==4&&ec.product.isDespositSku==1)){$("#comb-price").html(price.toFixed(2))}$("#comb-count").html(count)};(function(){var a=0,b;ec.ready(function(){b=$("#pro-gallerys").css("left","0").children().length});ec.product.imgSlider={prev:function(){if(a==0){return}a--;$("#pro-gallerys").animate({left:a*-74},100)},next:function(){if(a+5>=b){return}a++;$("#pro-gallerys").animate({left:a*-74},100)},reset:function(){b=$("#pro-gallerys").css("left","0").children().length;a=0}}})();(function(c){var b,a=function(d){var e=$("#comb-pro-"+d);var g=c.getSkuInfo(d),f=parseFloat(g.price);e.find("input[name=skuId]:checked").each(function(){f+=parseFloat(this.getAttribute("data-price"))});if(!(ec.product.productType&&ec.product.productType==4&&ec.product.isDespositSku==1)){$("#comb-price").html(f.toFixed(2))}};c.renderGroup=function(e){var f=[],d=$("#bundle-list-"+e),g=$("#comb-list-"+e);if(d.length>0){f.push("#tab-bundle");d.show().siblings().hide();c.renderBundle(e)}if(!g.length>0){$("#product-recommend-all").hide()}else{if(parseInt(ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku).buttonMode)>13||parseInt(ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku).buttonMode)==0){$("#product-recommend-all").hide()}else{$("#product-recommend-all").show()}}$("#tab-bundle,#tab-comb").hide();if(f.length==0){$("#group-area").hide();return}if(f.length>1){f.push("#tab-split")}f.push("#group-area");$(f.join(",")).show()};c.renderBundle=function(d){var e=$("#bundle-list-"+d);this.showBundle(e.children("li.current").attr("data-id"))};c.showBundle=function(e){$("#bundle-pro-"+e+",#bundle-price-"+e).show().siblings().hide();b=e;var d=$("#bundle-pro-"+e)}})(ec.product);(function(){var a;_options={};_options["default"]={};_options.normal={renderInventory:function(e){var h=ec.product.getSkuInfo(ec.product.getSku()||ec.product.defaultSku),f=$("#pro-msg"),g=$("#pro-quantity-area,#pro-operation"),b=$("#pro-operation"),c=$("#isPriority").val();$("#tab-addcart-button").hide();$("#tab-notice-button").hide();$("#product-tips").html("");$("#product-tips").hide();if(ec.product.status==3){f.show();$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u5df2\u4e0b\u67b6");b.css("visibility","hidden");$("#pro-skus").html("");$("#pro-skus").hide();$(".product-operation-main").hide();$("#package_dl").remove();return}if(ec.product.status==5){f.show();$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u4e0d\u5728\u6b64\u9500\u552e\u524d\u7aef\u9500\u552e");b.css("visibility","hidden");$("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u4e0d\u5728\u6b64\u9500\u552e\u524d\u7aef\u9500\u552e");$("#product-tips").show();$("#product-operation").hide();return}if(h.tipsContent.length>1){f.show();$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a"+h.tipsContent);$("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a"+h.tipsContent);$("#product-tips").show()}else{f.hide();$("#product-tips").hide()}if(h.priceMode==2){$("#pro-price-label").html("\u6682\u65e0\u62a5\u4ef7");$("#pro-price-label").show();$("#pro-price").hide();$("#pro-price-old").hide();$("#pro-price").html("");$("#pro-price-old").hide()}if(c==1){if(ec.product.getSkuPriority(h.id)==true){b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.buy(\'sku\');return false;"><span>\u7acb\u5373\u8d2d\u4e70</span></a>');$("#pro-quantity-area").hide();b.css("visibility","visible");$("#product-operation").show();$("#order-confirm-form").attr({action:"/order/priorityConfirm",method:"post"});return}}$("#order-confirm-form").attr({action:"/order/nowConfirmcart",method:"post"});$("#product-deposit-agreement-area").next().remove();switch(parseInt(h.buttonMode,10)){case 5:b.css("visibility","hidden");$("#pro-quantity-area").hide();return;case 4:b.css("visibility","hidden");$("#pro-quantity-area").hide();return;case 2:b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.buy(\'sku\');return false;"><span>\u7acb\u5373\u8d2d\u4e70</span></a>');$("#pro-quantity-area").show();b.css("visibility","visible");$("#product-operation").show();return;case 6:if(e){b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.extendBuyNow();return false;"><span>\u7acb\u5373\u8d2d\u4e70</span></a>');$("#pro-quantity-area").show();b.css("visibility","visible");$("#product-operation").show()}else{$("#pro-quantity-area").hide();b.css("visibility","visible");$("#product-operation").show();b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#tab-notice-button").show()}return;case 7:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();b.html('<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>\u4f18\u4eab\u8d2d</span></a><a target="_blank" href="'+h.gotoUrl+'" class="product-button02" ><span>'+h.buttonText+"</span></a>")}else{b.html('<a target="_blank" href="'+h.gotoUrl+'" class="product-button02" ><span>'+h.buttonText+"</span></a>")}b.css("visibility","visible");$("#product-operation").show();return;case 8:return;case 9:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();b.html('<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>\u4f18\u4eab\u8d2d</span></a><a target="_blank" href="'+h.gotoUrl+'" class="product-button02" ><span>\u5f00\u552e\u63d0\u9192</span></a>')}else{b.html('<a target="_blank" href="'+h.gotoUrl+'" class="product-button02" ><span>\u5f00\u552e\u63d0\u9192</span></a>')}b.css("visibility","visible");$("#product-operation").show();return;case 10:ec.product.timingBuy();return;case 11:if(e){$("#pro-quantity-area").show();b.css("visibility","visible");$("#product-operation").show();var d='<a href="javascript:;" onclick="ec.product.orderNowCover()" class="product-button02" ><span>\u7acb\u5373\u4e0b\u5355</span></a>';b.html(d)}else{$("#pro-quantity-area").hide();b.css("visibility","visible");$("#product-operation").show();b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#tab-notice-button").show()}return;case 12:if(ec.product.productType==9){if(e){$("#pro-quantity-area").show();b.css("visibility","visible");b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.orderNow()"><span>\u7acb\u5373\u4e0b\u5355</span></a>');$("#product-operation").show()}else{$("#pro-quantity-area").hide();b.css("visibility","visible");$("#product-operation").show();b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#tab-notice-button").show()}return}b.css("visibility","hidden");$("#pro-quantity-area").hide();return;case 13:if(e){$("#pro-quantity-area").show();b.css("visibility","visible");b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.orderNow()"><span>O2O\u4e0b\u5355</span></a>');$("#product-operation").show()}else{$("#pro-quantity-area").hide();b.css("visibility","visible");$("#product-operation").show();b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#tab-notice-button").show()}return;case 15:b.css("visibility","hidden");$("#pro-quantity-area").hide();$("#product-operation").hide();if(h.tipsContent.length>1){$("#pro-msg-title").html("\u6e29\u99a8\u63d0\u793a\uff1a"+h.tipsContent)}else{$("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u6682\u4e0d\u552e\u5356")}$("#product-tips").show();return;case 3:case 1:if(e){$("#pro-quantity-area").show();b.css("visibility","visible");$("#product-operation").show();if(h.groupType=="1"){b.html('<a href="javascript:;" onclick="ec.product.addCart()" class="product-button02" ><span>\u7acb\u5373\u56e2\u8d2d</span></a>')}else{var d='<a href="javascript:;" onclick="ec.product.addCart()" class="product-button01" ><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a><a href="javascript:;" onclick="ec.product.orderNow()" class="product-button02" ><span>\u7acb\u5373\u4e0b\u5355</span></a>';ec.product.renderVisitorButton(b);b.html(d);$("#tab-addcart-button").show()}}else{$("#pro-quantity-area").hide();b.css("visibility","visible");$("#product-operation").show();if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();b.html('<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>\u4f18\u4eab\u8d2d</span></a><a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>')}else{b.html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#tab-notice-button").show();$("#product-recommend-all").hide()}}return;default:b.css("visibility","hidden");$("#pro-quantity-area").hide();$("#product-tips").html("\u6e29\u99a8\u63d0\u793a\uff1a\u8be5\u5546\u54c1\u6682\u672a\u552e\u5356");$("#product-tips").show();$("#product-operation").hide()}}};_options.reservation={renderInventory:function(b){$("#pro-msg").hide();if(b){$("#pro-quantity-area").show();$("#pro-operation").html('<a href="javascript:;"  onclick="ec.product.addCartWithLogin()" class="product-button02" ><span>\u9884\u7ea6\u8d2d\u4e70</span></a>');$("#product-operation").show()}else{$("#pro-quantity-area").hide();$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()"><span>\u5230\u8d27\u901a\u77e5</span></a>');$("#product-operation").show()}}};_options.queue={renderInventory:function(b){if(b){$("#sale-buy-btn").show();$("#sale-sell-out").hide()}else{$("#sale-buy-btn").hide();$("#sale-sell-out").show()}}};_options.seckill={renderInventory:function(b){if(b){$("#sale-buy-btn").show();$("#sale-sell-out").hide()}else{$("#sale-buy-btn").hide();$("#sale-sell-out").show()}}};ec.product.execute=function(e,c){var d=_options[a],b=d[e]||_options["default"][e];if(b){b.apply(ec.product,c)}};ec.product.setType=function(b){a=b;switch(b){case"normal":case"reservation":ec.product.isSale=false;break;default:ec.product.isSale=true}ec.product.prefix=ec.product.isSale?"/sale":"/product"}})();ec.ready(function(){$(function(){var f=$(".product-gallery");var h=$(".gallery-scroll-bottom");var k=f.offset().top,j=f.height();var g,i;$(window).scroll(function(){var l=Math.max(document.body.scrollTop,document.documentElement.scrollTop);if(h.length>0){g=$(".header").height()+(($(".hr-10").height())*4)+$(".g").height()+$(".product").height();i=g-l-j}if(k<l){f.addClass("positionFixed");f.removeClass("positionStatic");if((h.length>0)&&(g<(l+j))){f.css({top:i})}else{f.css({top:0})}}else{f.addClass("positionStatic");f.removeClass("positionFixed")}})});var d=ec.product;ec.ui.proNumer("#pro-quantity",{max:999,min:1});ec.product.tabSkuInfo(ec.product.setSkuId||ec.product.defaultSku);var b=false;var c=function(){if(loadEvaluate){return}ec.product.remark.loadEvaluateScore();$("#pro-tab-evaluate-content").show();ec.product.remark.loadEvaluate({pageNumber:1,type:0,extraType:1});ec.product.remark.bindEvent()};c();var d=ec.product;_bindEvent();$("#pro-tab-feature , #pro-tab-parameter , #pro-tab-package-service , #pro-tab-evaluate").click(function(){var f=$(this),g=this.id});ec.product.history.add(ec.product.id);$(window).scroll(function(){var g=$(this).scrollTop(),f=$(window).height(),h=$("#product-history-area").offset().top;if(finished&&g>=(h-f)){finished=false;d.history.load(function(l){if(l.length==0){$("#product-history-area").hide();return}var k=[],m;for(var j=0;j<l.length;j++){m=l[j];m.price=(m.priceMode==2)?'<em  class="disabled">\u6682\u65e0\u62a5\u4ef7</em>':"<em>&yen;"+m.price+"</em>";k.push('<li class="swiper-slide">');k.push('<a href="/product/'+m.id+'.html"  title="'+m.name+'"  onclick="pushProHistoryMsg(\''+m.code+"','"+(j+1)+'\')" target="_blank">');k.push('<img src="'+ec.mediaPath+m.photoPath+"142_142_"+m.photoName+'" alt="'+m.name+'"/>');k.push('<div class="product-link-detail">');k.push("<p><span>"+m.name+"</span></p>");k.push(""+m.price+"");k.push("</div>");k.push("</a>");k.push("</li>")}$("#product-history-list").html("");$("#product-history-list").html(k.join(" "));$("#product-history-area").show();ec.product.scroll("product-history-scroll",5)},null,ec.product.isSale?null:ec.product.id)}});d.renderGroup(d.setSkuId||d.defaultSku);var a;d.renderBundle(d.setSkuId||d.defaultSku);var e=ec.product.getSku();e=ec.product.getSkuInfo(e);ec.product.initContract(e);ec.form.input.label("#extend-text","\u8f93\u5165IMEI/SN/MEID\u4fe1\u606f");$(".product-button02").live("click",function(){var f="";var i=$("#pro-sku-code").val();if(this.id!=null&&this.id!=""&&typeof(this.id)!="undefined"){return}f=$(this).find("span").html();if(f==""||f==null){f=$(this).html()}var g=$("#gift-service-detail-link").attr("href");var k=false;if(g!=""&&g!=null&&g.indexOf("javascript:;")<0){k=true}var h=$("#packageCode").val();var j=$("#packageListCode").val();pushBottonMsg(f,null,i,h,j,"300020501",k)});$(".product-button01").live("click",function(){var f="";var i=$("#pro-sku-code").val();var g=$("#pro-quantity").val();f=$(this).find("span").html();var h=$("#packageCode").val();var j=$("#packageListCode").val();pushBottonMsg(f,g,i,h,j,"300020401")});$("#extendProtected").parent().parent().mouseover(function(){var f=$("#extendProtected").parent().parent().data("flag");if(f==1){$("#extendProtected").parent().parent().data("flag","")}else{$("#extendProtected").parent().parent().addClass("hover")}});$("#extendProtected").parent().parent().mouseout(function(){$("#extendProtected").parent().parent().data("flag","");$("#extendProtected").parent().parent().removeClass("hover")});$("#accidentProtected").parent().parent().mouseover(function(){var f=$("#accidentProtected").parent().parent().data("flag");if(f==1){$("#accidentProtected").parent().parent().data("flag","")}else{$("#accidentProtected").parent().parent().addClass("hover")}});$("#accidentProtected").parent().parent().mouseout(function(){$("#accidentProtected").parent().parent().data("flag","");$("#accidentProtected").parent().parent().removeClass("hover")})});ec.product.divchange=function(a){if(a==1){$("#prddetail_counsel_all").show();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_1").attr("class","selected")}else{if(a==2){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").show();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_2").attr("class","selected");ec.product.counselloadprd({pageNumber:1})}else{if(a==3){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").show();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_3").attr("class","selected");ec.product.paycounselload({pageNumber:1})}else{if(a==4){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").show();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_4").attr("class","selected");ec.product.transcounselload({pageNumber:1})}else{if(a==5){$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").show();$("#prddetail_counsel_ques").hide();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_6").removeAttr("class");$("#prd_detail_counsel_5").attr("class","selected");ec.product.sercounselload({pageNumber:1})}else{$("#prddetail_counsel_all").hide();$("#prddetail_counsel_prd").hide();$("#prddetail_counsel_pay").hide();$("#prddetail_counsel_trans").hide();$("#prddetail_counsel_service").hide();$("#prddetail_counsel_ques").show();$("#prd_detail_counsel_1").removeAttr("class");$("#prd_detail_counsel_3").removeAttr("class");$("#prd_detail_counsel_4").removeAttr("class");$("#prd_detail_counsel_5").removeAttr("class");$("#prd_detail_counsel_2").removeAttr("class");$("#prd_detail_counsel_6").attr("class","selected")}}}}}};ec.product.counselloadall=function(a){new ec.ajax().submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{prdId:ec.product.id,dataType:0,pageNumber:a.pageNumber,pageSize:3},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(c){if(!c.success){ec.showError(c);return}var b=[];b=ec.product.createcounselhtml(c);$("#all_prd_counsel_content").html(b.join(""));ec.product.allrenderPage(c.page)}})};ec.product.allrenderPage=function(a){$("#all_prd_counsel").show();$("#all_prd_counsel").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:3,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.counselloadall});ec.product.pagerScroll("all_prd_counsel")};ec.product.counselloadprd=function(a){new ec.ajax().submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{prdId:ec.product.id,dataType:1,pageNumber:a.pageNumber,pageSize:3},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(c){if(!c.success){ec.showError(c);return}var b=[];b=ec.product.createcounselhtml(c);$("#prd_prd_counsel_content").html(b.join(""));if(c.page.totalRow>0){$("#prddetail_counsel_prd_total > div:first-child").html("\u5171"+c.page.totalRow+"\u6761")}else{$("#prddetail_counsel_prd_total").hide()}ec.product.prdrenderPage(c.page)}})};ec.product.prdrenderPage=function(a){$("#prd_prd_counsel").show();$("#prd_prd_counsel").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:3,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.counselloadprd});ec.product.pagerScroll("prd_prd_counsel")};ec.product.paycounselload=function(a){new ec.ajax().submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{prdId:ec.product.id,dataType:2,pageNumber:a.pageNumber,pageSize:3},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(c){if(!c.success){ec.showError(c);return}var b=[];b=ec.product.createcounselhtml(c);$("#pay_prd_counsel_content").html(b.join(""));if(c.page.totalRow>0){$("#prddetail_counsel_pay_total > div:first-child").html("\u5171"+c.page.totalRow+"\u6761")}else{$("#prddetail_counsel_pay_total").hide()}ec.product.payrenderPage(c.page)}})};ec.product.payrenderPage=function(a){$("#pay_prd_counsel_page").show();$("#pay_prd_counsel_page").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:3,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.paycounselload});ec.product.pagerScroll("pay_prd_counsel_page")};ec.product.transcounselload=function(a){new ec.ajax().submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{prdId:ec.product.id,dataType:3,pageNumber:a.pageNumber,pageSize:3},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(c){if(!c.success){ec.showError(c);return}var b=[];b=ec.product.createcounselhtml(c);$("#trans_prd_counsel_content").html(b.join(""));if(c.page.totalRow>0){$("#prddetail_counsel_trans_total > div:first-child").html("\u5171"+c.page.totalRow+"\u6761")}else{$("#prddetail_counsel_trans_total").hide()}ec.product.transrenderPage(c.page)}})};ec.product.transrenderPage=function(a){$("#trans_prd_counsel_page").show();$("#trans_prd_counsel_page").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:3,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.transcounselload});ec.product.pagerScroll("trans_prd_counsel_page")};ec.product.sercounselload=function(a){new ec.ajax().submit({url:"/product/query/consultation/"+ec.product.id+".json",data:{prdId:ec.product.id,dataType:4,pageNumber:a.pageNumber,pageSize:3},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(c){if(!c.success){ec.showError(c);return}var b=[];b=ec.product.createcounselhtml(c);$("#ser_prd_counsel_content").html(b.join(""));if(c.page.totalRow>0){$("#prddetail_counsel_serv_total > div:first-child").html("\u5171"+c.page.totalRow+"\u6761")}else{$("#prddetail_counsel_serv_total").hide()}ec.product.serrenderPage(c.page)}})};ec.product.serrenderPage=function(a){$("#ser_prd_counsel_page").show();$("#ser_prd_counsel_page").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:3,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.sercounselload});ec.product.pagerScroll("ser_prd_counsel_page")};ec.product.quescounselload=function(a){new ec.ajax().submit({url:"/product/query/frequentyQuestions/"+ec.product.id+".json",data:{prdId:ec.product.id,pageNumber:a.pageNumber,pageSize:10},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},successFunction:function(d){if(!d.success){ec.showError(d);return}var c=[];if(d.page.totalRow>0){for(var b=0;b<d.prdFrequentyQuestionsList.length;b++){var e=d.prdFrequentyQuestionsList[b];c.push("<li>");c.push("<h2>"+((a.pageNumber-1)*10+b+1)+"\u3001"+e.question+"</h2>");c.push("<p>"+e.reply+"</p>");c.push("</li>")}}else{c.push('<div class="product-inquire-list"><div class="product-inquire-no">\u6682\u65e0\u76f8\u5173\u5185\u5bb9</div></div>')}$("#ques_prd_counsel_content").html(c.join(""));if(d.page.totalRow>0){$("#prddetail_counsel_ques_total div:first-child").html("\u5171"+d.page.totalRow+"\u6761")}else{$("#prddetail_counsel_ques_total").hide()}ec.product.quesrenderPage(d.page)}})};ec.product.quesrenderPage=function(a){$("#ques_prd_counsel_page").show();$("#ques_prd_counsel_page").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:10,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.product.quescounselload});ec.product.pagerScroll("ques_prd_counsel_page")};ec.product.createcounselhtml=function(e){var d=[];if(e.page.totalRow>0){d.push('<ul class="product-inquire-list">');for(var c=0;c<e.prdConsultationList.length;c++){p=e.prdConsultationList[c];var g=p.userName;var b=p.gradeCode;var a=new Date(p.createTime);var f=new Date(p.answerTime);d.push('<li> <div class="product-inquire-user">\u7f51\u53cb');d.push("<span>"+g+"</span>");d.push("<label>"+b+"</label>");d.push("<em>"+a.format("yyyy-MM-dd HH:mm:ss")+"</em></div>");d.push('<div class="product-inquire-question">');d.push("<label>\u54a8\u8be2\u5185\u5bb9\uff1a</label><span>"+ec.util.escapeHtml(p.question)+"</span></div>");d.push('<div class="product-inquire-answer">');d.push("<p><label>\u56de\u590d\uff1a</label>"+ec.util.escapeHtml(p.answer)+"</p>");d.push("<em>"+f.format("yyyy-MM-dd HH:mm:ss")+"</em>");d.push("</div></li>")}d.push("</ul>")}else{d.push('<div class="product-inquire-list"><div class="product-inquire-no">\u6682\u65e0\u76f8\u5173\u5185\u5bb9</div></div>')}return d};ec.product.loginCheckBefCoun=function(){if(!ec.account.isLogin()){location.href="/account/login?url="+encodeURIComponent(window.location.pathname+"#counseltextid")}else{$("#counseltextid").focus();$("#error-span").hide()}};ec.product.submitCounsel=function(){var a=$("<div/>").text($("#counseltextid").val()).html();var b=ec.product.optCompany(a);if(b==null||b.length<1){$("#error-span").show();$("#error-span").html("\u63d0\u4ea4\u5185\u5bb9\u4e3a\u7a7a");return}if(b.length>100){$("#error-span").show();$("#error-span").html("\u8f93\u5165\u7684\u6587\u5b57\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57,\u8bf7\u91cd\u65b0\u8f93\u5165");return}new ec.ajax().get({url:domainMain+"/member/addUserRemarkView.json?t="+new Date().getTime(),dataType:"json",data:{orderCode:"comments"},timeout:10000,timeoutFunction:function(){alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01");return false},successFunction:function(c){if(!c.success){ec.account.syncCustomSession()}new ec.ajax().submit({url:"/product/save/consultation.json",form:"#counsel_content_form",data:{productId:ec.product.id,productName:ec.product.name},successFunction:function(d){if(!d.success){if(d.msg=="notRealName"){ec.product.commentsTip()}else{$("#error-span").show();$("#error-span").html(d.msg)}}else{if($("#safeEmail").attr("checked")){ec.product.counselSuccess(d.changeEmailUrl)}else{alert("\u63d0\u4ea4\u6210\u529f,\u8bf7\u8010\u5fc3\u7b49\u5f85\u5ba2\u670d\u4eba\u5458\u7684\u7b54\u590d\uff01")}$("#counsel_content_form")[0].reset();$("#error-span").hide();return}}})}})};ec.product.commentsTip=function(){new ec.box($("#realNameComment").val(),{boxclass:"ol_box_4",title:"",width:540,showButton:false,autoHeight:false,onok:function(){}}).open()};ec.product.optCompany=function(a){return a.replace(/(^\s*)|(\s*$)/g,"")};ec.product.counselSuccess=function(a){ec.account.afterLogin(function(){ec.product.syncCustomSession();var b=ec.product.email;var c=new ec.box($("#product-counsel-html").val(),{boxid:"product-counsel-box",boxclass:"ol_box_4",showButton:false,onopen:function(d){if(ec.util.isEmpty(b)){$("#counsel-success-msg").html("\u56de\u590d\u5c06\u53d1\u9001\u5230\u60a8\u7684\u5b89\u5168\u90ae\u7bb1\uff0c\u60a8\u8fd8\u672a\u7ed1\u5b9a\uff0c\u8bf7\u5148\u7ed1\u5b9a\u5b89\u5168\u90ae\u7bb1\u3002");$("#counsel-bind-email").html('<a href="'+a+'" class="box-change box-pro-button01 button-style-2" target="_blank" onclick="ec.product.secEmailOper()"><span>\u53bb\u7ed1\u5b9a</span></a>')}else{$("#counsel-success-msg").html("\u5ba2\u670d\u56de\u590d\u5c06\u53d1\u9001\u5230\u60a8\u7684\u5b89\u5168\u90ae\u7bb1&nbsp;"+b+"\uff0c\u53ef\u70b9\u51fb\u4fee\u6539\u5b89\u5168\u90ae\u7bb1\u3002");$("#counsel-bind-email").html('<a href="'+a+'" class="box-change box-pro-button01 button-style-2" target="_blank" onclick="ec.product.secEmailOper()"><span>\u4fee\u6539\u5b89\u5168\u90ae\u7bb1</span></a>')}},onok:function(d){},onclose:function(d){$(".ol_box_mask").remove()}});c.open();ec.product.secEmailOper=function(){c.close();$(".ol_box_mask").remove()}})};ec.product.combChange=function(e){var c=$(e).parent();c.addClass("current");c.siblings().not(c).removeClass("current");var g=c.parent().attr("id");var b=g.substring(14,g.length);var d=c.index();var a=$("#comb-pro-"+ec.product.getSku()+"-"+d);var f=a.eq(d);a.show();a.siblings(".product-recommend-con").hide()};ec.product.syncCustomSession=function(){new ec.ajax().get({async:false,url:"/account/syncEmailAndMobile.json",timeout:10000,successFunction:function(a){if(!ec.util.isEmpty(a.customerInfo)){ec.product.email=a.customerInfo.email;ec.product.mobile=a.customerInfo.mobile}return},timeoutFunction:function(){return},errorFunction:function(){return}})};ec.product.giftshow=function(){var a=new ec.box($("#pro-gift-box").html(),{boxclass:"ol_box_4",title:"\u9009\u62e9",width:484,showButton:false,autoHeight:false,});a.open();$(".box-content").find("#pro-gift-list-detail").parent().siblings().show().html('<a href="javascript:;" class="box-ok" onclick="ec.product.boxCancle()"><span>\u53d6\u6d88</span></a><a href="javascript:;" class="box-sure" id="box-sures" ><span>\u786e\u8ba4</span></a>');$("div[id^='pro-gift-list-detail'] li a").bind("click",function(f){if($(this).parent().hasClass("selected")){$(this).parent().parent().find("li").removeClass("new");$(this).parent().addClass("new");return}$(this).parent().parent().find("li").removeClass("selected");$(this).parent().addClass("selected");$(this).parent().parent().find("li").removeClass("new");$(this).parent().addClass("new");var e=ec.product.getSku();var d=ec.product.gift.mainSkuGiftMap[e];var c=ec.product.gift.finalMainSbomGiftMap[e];var b=$(this).attr("key");var g=d[b];var h=$(this).attr("defaultGiftKey");c[h]=g;$("#ol_box").find("#gift-detail-"+h).find("img").attr("src",ec.mediaPath+g.photoPath+ec.product.gift.middleImgSize+g.photoName);$("#ol_box").find("#gift-detail-"+h).attr("href","/product/"+g.giftId+".html#"+g.giftSkuId);$("#ol_box").find("#gift-detail-name"+h).html(g.giftName)});$("#box-sures").bind("click",function(c){$("div[id^='ol_box'] li.selected").each(function(){var g=ec.product.getSku();var f=ec.product.gift.mainSkuGiftMap[g];var e=ec.product.gift.finalMainSbomGiftMap[g];var d=$(this).children("a").attr("key");var h=f[d];var i=$(this).children("a").attr("defaultGiftKey");e[i]=h;$("#ol_box").find("#gift-detail-"+i).find("img").attr("src",ec.mediaPath+h.photoPath+ec.product.gift.middleImgSize+h.photoName);$("#ol_box").find("#gift-detail-"+i).attr("href","/product/"+h.giftId+".html#"+h.giftSkuId);$("#ol_box").find("#gift-detail-name"+i).html(h.giftName);$("#gift-"+i).attr("href","/product/"+h.giftId+".html#"+h.giftSkuId);$("#gift-"+i).attr("title",h.giftName);$("#gift-"+i).attr("key",d);$("#gift-"+i).find("img").attr("src",ec.mediaPath+h.photoPath+ec.product.gift.middleImgSize+h.photoName);$("#gift-"+i).find("img").attr("alt",h.giftName)});var b=$("#ol_box").find("#pro-gift-list-detail").html();$("#pro-gift-list-detail").html("");$("#pro-gift-list-detail").append(b);$(".ol_box_mask").remove();$("#ol_box").hide()})};ec.product.boxCancle=function(){$(".ol_box_mask").remove();$("#ol_box").remove()};ec.product.getSysDate=function(){var a=new Date();new ec.ajax().get({async:false,url:"/system/getSysDate.json",timeout:10000,successFunction:function(b){if(!ec.util.isEmpty(b.now)){a.setTime(b.now.parseDate("yyyy-MM-dd HH:mm:ss"))}}});return a};ec.product.splitMobile=function(b){var a="";for(var c=0;c<(b.length);c++){if((b.length-c)%4==0){a+="&nbsp;&nbsp;"}a+=b.substring(c,c+1)}return a};ec.product.getPackageAndService=function(b){var e=ec.product.packageList[b];var f=ec.product.warranty[b];var d=e?true:false;var c=f?true:false;var a=d&&c;packFlag=!d&&!c;$("#pro-tab-package-service-content").empty();$("#pro-tab-service-content").empty();$("#pro-tab-package-service-content").hide();$("#packagTitleId").hide();$("#customerServiceTitle").hide();$("#customerServiceDiv").hide();$("#pro-tab-package-service").hide();if(d){$("#pro-tab-package-service-content").html(e);$("#pro-tab-package-service-content").show();$("#packagTitleId").show();$("#pro-tab-package-service").show()}if(c){$("#pro-tab-service-content").html(f);$("#customerServiceTitle").show();$("#customerServiceDiv").show();$("#pro-tab-package-service").show()}};ec.product.getFeature=function(a){if(ec.product.getSkuForFeature(a)!=undefined||$("#pro-detail-content-"+a).length>0){$("#pro-tab-parameter").removeClass("selected");$("#pro-tab-feature").addClass("selected").show();$("#pro-detail-contents").show();$("#pro-detail-content-"+(ec.product.setSkuId||a)).show().siblings().hide();if(masterPlayer){masterPlayer.dispose()}ec.product.payVideo();return}new ec.ajax().get({url:"/product/querySkuDetailFeature/"+ec.product.getSku()+".json",timeout:10000,timeoutFunction:function(){$("#pro-detail-contents > div:first-child").html("\u6b63\u5728\u52a0\u8f7d...")},successFunction:function(d){if(!d.success){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-detail-contents").hide();return}if(d.length==0){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-tab-feature").hide();$("#pro-detail-contents").hide();return}$("#pro-tab-parameter").removeClass("selected");$("#pro-tab-feature").addClass("selected");$("#pro-tab-feature").show();$("#pro-detail-contents").show();ec.product.setSkuForFeature(a);var e=[];e.push('<div id="pro-detail-content-'+d.id+'" class="pro-detail-see">');e.push('<div id="kindPicture-'+d.id+'">');e.push(d.detail);e.push("</div>");e.push('<div id="detail-content-button-'+d.id+'" class="product-shade hide"><p>');e.push('<a id="pro-detail-down-btn-'+d.id+'" class="product-detail-btn">');e.push("\u67e5\u770b\u5168\u90e8\u4ea7\u54c1\u8be6\u60c5</a></p></div>");e.push('<a href="javascript:;" id="pro-detail-up-btn-'+d.id+'" class="product-detail-btnup hide">\u6536\u8d77\u5168\u90e8\u4ea7\u54c1\u8be6\u60c5</a>');e.push("</div>");var c=$("#pro-tab-feature-content > div:first-child");c.prepend(e.join(""));if(masterPlayer){setTimeout(function(){masterPlayer.dispose()},300)}ec.product.payVideo();$("#pro-detail-content-"+(ec.product.setSkuId||a)).show().siblings().hide();var b=0;$("#pro-detail-content-"+(ec.product.setSkuId||a)+" img").each(function(f){$(this).load(function(){b=b+$(this).height();if(b>=2000){$("#pro-detail-content-"+d.id).height("2000");$("#detail-content-button-"+d.id).show();$("#pro-detail-down-btn-"+d.id).click(function(){$("#pro-detail-content-"+d.id).height($("#kindPicture-"+d.id).height()+$("#pro-detail-up-btn-"+d.id).height()+40);$("#detail-content-button-"+d.id).hide();$("#pro-detail-up-btn-"+d.id).css("display","block");upDownButton="true"});$("#pro-detail-up-btn-"+d.id).click(function(){$("#pro-detail-content-"+d.id).height("2000");$("#detail-content-button-"+d.id).show();$("#pro-detail-up-btn-"+d.id).css("display","none");upDownButton="false";$("body,html").animate({scrollTop:tit1+1575},0)});return false}})});if(b<2000){$("#detail-content-button-"+d.id).hide()}},errorFunction:function(){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-detail-contents").hide()},timeoutFunction:function(){$("#pro-tab-feature").removeClass("selected").hide();$("#pro-tab-parameter").addClass("selected");$("#pro-detail-contents").hide()}})};var masterPlayer;ec.product.payVideo=function(){var a=ec.product.getSku();var b=$("#pro-detail-content-"+a).find(".J_videoTrigger");$("#player-container-id").remove();if(b){if(!$("#pro-detail-content-"+a).find("video")||$("#pro-detail-content-"+a).find("video").length==0){var e=b.attr("data-video");var d=b.attr("data-video-poster");if(e&&e!=""){b.append("<span class='video-btn'></span>");var c="player-container-id-"+a;b.click(function(){e=$(this).attr("data-video");var g='<video id="'+c+'" preload="auto"  playsinline webkit-playinline x5-playinline src="'+e+'"></video>';var f=new ec.box(g,{boxid:"video-box",boxclass:"ol_box_4 video-detail",width:800,height:450,draggable:false,showButton:false,zIndex:700,onclose:function(h){masterPlayer.dispose()}}).open();masterPlayer=TCPlayer(c,{autoplay:true})})}}}};ec.product.rushbuyActivity=function(a){rush.business.doIfSbomChanged(a)};ec.product.switched=function(b,a){$("input[name='type']").val(b);$(a).addClass("selected").siblings().removeClass("selected")};ec.product.getParameter=function(d,f){$("#parameterDetailTips").hide();if(ec.product.getSkuForParement(d)!=undefined){$("#main-parameter-content-"+(ec.product.setSkuId||skuId)).show().siblings().hide();$("#content-"+(ec.product.setSkuId||skuId)).show().siblings().hide();$("#productParameterId").show();$("#productParameterHr30").show();return}var c=d.split(",");var b=f.split(",");var a="";for(var e=0;e<b.length;e+=1){a+="sbomCode="+b[e];if(e<b.length-1){a+="&"}}$.ajax({url:pmsHttpDomain+"product/querySpecificationMulti.json?"+a,dataType:"jsonp",jsonp:"callback",jsonpCallback:"flightHandler",timeout:20000,success:function(F){if(!F.success){$("#parameterDetailTips").show();return}$("#parameterDetailTips").hide();ec.product.setSkuForParement(d);for(var A=0;A<c.length;A+=1){var o=c[A];var C=b[A];var z=null;var u=null;for(var B=0;B<F.data.length;B+=1){var y=F.data[B];if(C==y.sbomCode){z=y.specificationList;u=y.majorSpecificationList;break}}var k=[];if(u!=null&&u.length>0){var v;k.push("<h2>\u4e3b\u8981\u53c2\u6570</h2>");k.push("<ul>");for(var D=0;D<u.length;D++){v=u[D];if(v.value!=null&&v.value!=""&&v.value!=undefined){k.push("<li><label>"+v.name+"</label><span>"+v.value+"</span></li>")}}k.push("</ul>")}$("#product-parameter-main").append('<div id="main-parameter-content-'+o+'" class="product-parameter-main clearfix hide">'+k.join("")+"</div>");$("#main-parameter-content-"+(ec.product.setSkuId||o)).show().siblings().hide();var s=[];if(z){var x;var t=[];for(var E=0;E<z.length;E++){x=z[E];var r=[];if("0"==x.parentCode){r.push('<div class="product-parameter-list clearfix">');r.push("<h2>"+x.name+"</h2>");var g=x.code;var q=[];q.push("<ul>");for(var D=0;D<z.length;D++){var h=z[D];if(h.parentCode!="0"&&h.parentCode==g){q.push("<li><label>"+h.name+"</label><span>"+ec.util.escapeHtml(h.value)+"</span></li>")}}q.push("</ul>");if(q.length>2){t.push(r.join(""));t.push(q.join(""));t.push("</div>")}}}t.push('<div class="product-parameter-list clearfix">');t.push("<h2>\u5546\u54c1\u7f16\u7801</h2>");t.push("<ul><li><label>"+C+"</label><span></span></li></ul></div>");if(t.length>0){s.push('<div id="content-'+o+'" >');s.push('<div id="parameterContentButton-'+o+'" class="product-shade hide">');s.push('<p><a id="parameterDownButton-'+o+'"  href="javascript:;"  class="product-detail-btn">\u67e5\u770b\u5168\u90e8\u53c2\u6570</a></p>');s.push("</div>");s.push('<div id="pro-tab-parameter-content-'+o+'" class="layout">');s.push('<div id="parameter-content-'+o+'">');s.push(t.join(""));s.push("</div>");s.push("</div>");s.push('<a id="parameterUpButton-'+o+'" href="javascript:;" class="product-detail-btnup hide">\u6536\u8d77\u53c2\u6570\u8be6\u60c5</a>');s.push("</div>")}}$("#productDetailParameter").prepend(s.join(""));$("#content-"+(ec.product.setSkuId||o)).show().siblings().hide()}$("#productParameterId").show();$("#productParameterHr30").show();var w=ec.product.getSku();w=ec.product.getSkuInfo(w);var l=$("#parameter-content-"+w.id).height();if(l<=540&&l>0){$("#parameterContentButton-"+w.id).removeClass("show").addClass("hide")}else{$("#parameterContentButton-"+w.id).removeClass("hide").addClass("show");$("#pro-tab-parameter-content-"+w.id).css({height:"540",overflow:"hidden"});$("#parameterDownButton-"+w.id).click(function(){$("#pro-tab-parameter-content-"+w.id).height($("#parameter-content-"+w.id).height());$("#parameterContentButton-"+w.id).removeClass("show").addClass("hide");$("#parameterUpButton-"+w.id).removeClass("hide").addClass("show")});$("#parameterUpButton-"+w.id).click(function(){$("#parameterContentButton-"+w.id).removeClass("hide").addClass("show");$("#parameterUpButton-"+w.id).removeClass("show").addClass("hide");$("#pro-tab-parameter-content-"+w.id).height("540");$("body,html").animate({scrollTop:tit1+$("#pro-tab-feature-content").height()+$("#hr60Detail").height()+270},0)})}},error:function(){$("#parameterDetailTips").show()}})};function stopConsultation(){$("#stopConsultationId").hide();$("#myConsultation").show();$("#upUserAdvisory").removeClass("show").addClass("hide")}ec.product.switchSku=function(){oTop=$(".product-tab").offset().top;clickFlag=false};ec.product.pagerScroll=function(a){$("#"+a+" li.link").click(function(){$("html, body").animate({scrollTop:$("#productAsk").offset().top-$("#product-tab").height()})})};ec.product.serverCommodity=function(c){var a=$("#"+c+" ul li").length,b=Math.ceil((a-1)/2);liHeight=$("#"+c+" ul li").height();$("#"+c+" ul li").eq(0).css({height:(b*24)-6})};ec.product.scroll=function(e,c){var b=$("#"+e).parent().parent();var a=b.find(".swiper-slide").length;if(a<=c){b.find(".swiper-button-prev").addClass("disabled");b.find(".swiper-button-next").addClass("disabled")}else{b.find(".swiper-button-next").removeClass("disabled")}var d=new Swiper("#"+e,{slidesPerView:c,slidesPerGroup:c});b.find(".swiper-button-prev").click(function(){d.swipePrev()});b.find(".swiper-button-next").click(function(){d.swipeNext()})};$(document).ready(function(){var d=$(".swiper-container"),b=[];d.each(function(c,a){b.push($(this).attr("id"))});$.each(b,function(h,e){var a=$("#"+e).find(".swiper-slide").length;if(a<=5){$("#"+e).parent().find(".swiper-button-prev").hide();$("#"+e).parent().find(".swiper-button-next").hide()}else{$("#"+e).find(".swiper-button-next").show()}var c=new Swiper("#"+e,{slidesPerView:5,slidesPerGroup:5});$("#"+e).parent().find(".btn-prev").click(function(){c.swipePrev()});$("#"+e).parent().find(".btn-next").click(function(){c.swipeNext()})});$("#pro-relation-scroll").find("li").mousedown(function(){return false})});function pushProHistoryMsg(b,a){var c={UID:ec.util.cookie.get("uid"),TID:getPtid(),TIME:getTime(),CONTENT:{SKUCode:b,click:"1"}};ec.code.addAnalytics({hicloud:true});_paq.push(["trackLink","300020801","link",c])}function pushProGiftBuySerMsg(){var a=$("#pro-sku-code").val();var b={UID:ec.util.cookie.get("uid"),TID:getPtid(),TIME:getTime(),CONTENT:{selectGiftbuy:"1",SKUCode:a,click:"1"}};ec.code.addAnalytics({hicloud:true});_paq.push(["trackLink","300021001","link",b])}function checkedThis(g,d,j,q){var r=document.getElementsByName(j);var m=false;var l=$(g).children("input:first-child")[0];if($("#"+d).hasClass("red")){l.checked=false;$("#"+q).parent().parent().removeClass("hover")}else{for(var h=0;h<=r.length-1;h++){if(r[h]==l){r[h].checked=true;if(q=="extendProtected"){$("#extendProtected").parent().parent().removeClass("hover")}if(q=="accidentProtected"){$("#accidentProtected").parent().parent().removeClass("hover")}}else{r[h].checked=false;if(q=="extendProtected"){$("#extendProtected").parent().parent().removeClass("hover")}if(q=="accidentProtected"){$("#accidentProtected").parent().parent().removeClass("hover")}}}}if($("input[name="+j+"]:checked").length==0){$("#"+d).removeClass("red");$("#"+q).parent().parent().removeClass("selected");var o=$("#"+q).parent().parent().find("span").eq(0).attr("id");$("#"+o).html("");$("#"+o).attr("skuid","");$("#"+o).attr("data-scode","");if(q=="extendProtected"){$("#extend-selected").remove()}if(q=="accidentProtected"){$("#accident-selected").remove()}}else{var n=[];if($("#"+d).hasClass("red")){$("#"+d).removeClass("red")}if(q=="extendProtected"){$("#extendProtected").parent().parent().find("a").eq(0).remove();var f=$("#"+d).attr("id"),a=$("#"+d).attr("title");$("#extendSelect").html(a);$("#extendSelect").attr("skuid",$("#"+d).attr("skuID"));$("#extendSelect").attr("data-scode",$("#"+d).attr("data-scode"));var c='<span class="fl max-w">'+$("#"+d).attr("title")+'</span><span class="fl">&nbsp;\uffe5'+$("#"+d).attr("data-price")+"</span>";$("#extendProtected").parent().before('<a href="javascript:;" onclick="ec.product.click_function(this)" class="product-service-btn">'+c+"</a>");$("#extendProtected").parent().parent().addClass("selected");$("#"+d).addClass("red");$("#extendProtected ul li .product-service-listcon").not("#"+d).removeClass("red");$("#extend-selected").remove();var e=$("#extendSelect").text();if(e!=""){n.push('<div id="extend-selected" class="inline">&nbsp;/&nbsp;'+e+"</div>");var k=$("#pro-select-sku").html();$("#pro-select-sku").html(k+n.join(""))}}if(q=="accidentProtected"){$("#accidentProtected").parent().parent().find("a").eq(0).remove();var f=$("#"+d).attr("id"),a=$("#"+d).attr("title");$("#accidentSelect").html(a);$("#accidentSelect").attr("skuid",$("#"+d).attr("skuID"));$("#accidentSelect").attr("data-scode",$("#"+d).attr("data-scode"));var c='<span class="fl max-w">'+$("#"+d).attr("title")+'</span><span class="fl">&nbsp;\uffe5'+$("#"+d).attr("data-price")+"</span>";$("#accidentProtected").parent().before('<a href="javascript:;" onclick="ec.product.click_function(this)" class="product-service-btn">'+c+"</a>");$("#accidentProtected").parent().parent().addClass("selected");$("#"+d).addClass("red");$("#accidentProtected ul li .product-service-listcon").not("#"+d).removeClass("red");$("#accident-selected").remove();var b=$("#accidentSelect").text();if(b!=""){n.push('<div id="accident-selected" class="inline">&nbsp;/&nbsp;'+b+"</div>");var k=$("#pro-select-sku").html();$("#pro-select-sku").html(k+n.join(""))}}}}ec.product.click_function=function(f){var g=$(f).parent().find(".product-service-list").attr("id");$(f).parent().data("flag","1");$("#"+g).parent().parent().removeClass("hover");if($(f).parent().hasClass("selected")){$(f).parent().removeClass("selected");$(f).parent().find("p").removeClass("red");var e=$(f).parent().find("span").eq(0).attr("id");$("#"+e).attr("skuid","");$("#"+e).attr("data-scode","");if(g=="extendProtected"){$("#extendProtected").parent().parent().find("a").eq(0).remove();$("#extendProtected ul").find("li").find("input").attr("checked",false);$("#extendProtected ul").find("li").find(".product-service-listcon").removeClass("red");$("#extend-selected").remove();var a=$("#extendProtected ul").find("li").eq(0).find(".product-service-listcon");var b='<span class="fl max-w">'+a.attr("title")+'</span><span class="fl">&nbsp;\uffe5'+a.attr("data-price")+"</span>";$("#extendProtected").parent().before('<a href="javascript:;" onclick="ec.product.click_function(this)" class="product-service-btn">'+b+"</a>")}if(g=="accidentProtected"){$("#accidentProtected").parent().parent().find("a").eq(0).remove();$("#accidentProtected ul").find("li").find("input").attr("checked",false);$("#accidentProtected ul").find("li").find(".product-service-listcon").removeClass("red");$("#accident-selected").remove();var c=$("#accidentProtected ul").find("li").eq(0).find(".product-service-listcon");var d='<span class="fl max-w">'+c.attr("title")+'</span><span class="fl">&nbsp;\uffe5'+c.attr("data-price")+"</span>";$("#accidentProtected").parent().before('<a href="javascript:;" onclick="ec.product.click_function(this)" class="product-service-btn">'+d+"</a>")}}else{}};ec.product.newpackageView=function(x,r,a){var s=[];var m=ec.product.getSku();var z=ec.product.getSkuInfo(m);ec.product.packageViewChange(x,r);$("#packageCode").val(r);$("#packageList").html("");_giftBuyItemId=[];if(r==null){if($("#giftBuy_dl").length>0){if($("#giftBuy_dl").hasClass("hide")){$("#giftBuy_dl").removeClass("hide")}$.each($("#giftBuy_dl").find("li"),function(){if($(this).attr("data-attrname")=="\u65e0\u589e\u503c\u670d\u52a1"){$(this).addClass("selected");$("#giftBuy-selected").html("/ \u65e0\u589e\u503c\u670d\u52a1")}});if($("#pro-operation").find("a").length==2&&$("#pro-operation").find("a").first().find("span").html()=="\u52a0\u5165\u8d2d\u7269\u8f66"){$("#pro-operation").find("a").first().attr("onclick","").click(function(){ec.product.addCart()})}if($("#pro-operation").find("a").length==1&&$("#pro-operation").find("a").first().find("span").html()=="\u7acb\u5373\u4e0b\u5355"){$("#pro-operation").find("a").first().attr("onclick","").click(function(){ec.product.orderNow()});$("#pro-operation").find("a").before('<a href="javascript:;" onclick="ec.product.addCart()" class="product-button01"><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a>')}}$("#pro-price-label").addClass("f24").removeClass("type");$("#pro-price-label").hide();$("#pro-price").html("<em>\u00a5</em>"+z.price+"");return}if($("#giftBuy_dl").length>0){if(!$("#giftBuy_dl").hasClass("hide")){$("#giftBuy_dl").addClass("hide")}$("#giftBuy_dl").find("li").removeClass("selected");$("#giftBuy-selected").html("");if($("#pro-operation").find("a").length==2&&$("#pro-operation").find("a").first().find("span").html()=="\u52a0\u5165\u8d2d\u7269\u8f66"){$("#pro-operation").find("a").first().attr("onclick","").click(function(){ec.product.addCart()})}if($("#pro-operation").find("a").length==1&&$("#pro-operation").find("a").first().find("span").html()=="\u7acb\u5373\u4e0b\u5355"){$("#pro-operation").find("a").first().attr("onclick","").click(function(){ec.product.orderNow()});$("#pro-operation").find("a").before('<a href="javascript:;" onclick="ec.product.addCart()" class="product-button01"><span>\u52a0\u5165\u8d2d\u7269\u8f66</span></a>')}}var e=z.pro_sbomList;var f="";var c="";for(var w=0;w<e.length;w++){if(a==e[w].sbomCode){f=e[w].sbomPackageList;break}}if(f!=""&&f.length>0){for(var q=0;q<f.length;q++){if(r==f[q].packageCode){c=f[q];break}}}var d=[];var b=$("#product_productId").val();if(c!=""&&c!=null){d.push('<div class="product-recommend product-package-mini">');d.push('<div class="product-recommend-con clearfix">');d.push('<div class="product-recommend-main">');d.push('<div class="product-recommend-thumbs">');d.push('<ul class="clearfix">');d.push('<li> <a> <img src="'+ec.mediaPath+z.photoPath+"100_100_"+z.photoName+'">');d.push('<p title="'+z.name+'">'+z.name+"</p>");d.push("</a></li></ul></div></div>");var y=c.packageList;if(y!=""&&y.length>0){d.push('<div class="goods-rolling product-recommend-detail">');d.push('<div id="btn-prev" class="grid-btn btn-prev disabled">');d.push("<span></span></div>");d.push('<div id="btn-next" class="grid-btn btn-next"><span></span></div>');d.push('<div id="goodsRecommend-recommend" class="swiper-container product-recommend-thumbs">');d.push('<ul class=" swiper-wrapper clearfix" style="width: 1000px;">');for(var v=0;v<y.length;v++){d.push('<li class="swiper-slide" attr-packageSkuCode="'+y[(v)].sbomCode+'"><a href="/product/'+y[v].disPrdId+'.html" target="_blank"><img src="'+ec.mediaPath+y[v].photoPath+"100_100_"+y[v].photoName+'">');d.push('<p title="'+y[v].sbomName+'">'+y[v].sbomName+"</p></a>");var h=y[v].gbomAttrList;if(h!=""&&h.length>0){d.push('<dl class="color clearfix">');for(var n=0;n<h.length;n++){if(n==0){d.push('<dd class="selected"><a href="javascript:;" onclick="ec.product.packageChangeColor(this)" attr-name="'+y[v].sbomName+'" attr-imgSrc="'+ec.mediaPath+y[(v)].photoPath+"100_100_"+y[(v)].photoName+'" attr-prdId="'+y[v].disPrdId+'" attr-packageSkuCode="'+y[v].sbomCode+'">'+h[n].attrValue+"</a></dd>")}else{d.push('<dd><a href="javascript:;" onclick="ec.product.packageChangeColor(this)" attr-name="'+y[v].sbomName+'" attr-imgSrc="'+ec.mediaPath+y[(v)].photoPath+"100_100_"+y[(v)].photoName+'" attr-prdId="'+y[v].disPrdId+'" attr-packageSkuCode="'+y[v].sbomCode+'">'+h[n].attrValue+"</a></dd>")}if(v!=(y.length-1)){var u=v;for(var l=1;l<(y.length-u);l++){if(y[u].disPrdId==y[(u+l)].disPrdId){h=y[(u+l)].gbomAttrList;d.push('<dd><a href="javascript:;" onclick="ec.product.packageChangeColor(this)" attr-name="'+y[(u+l)].sbomName+'" attr-imgSrc="'+ec.mediaPath+y[(u+l)].photoPath+"100_100_"+y[(u+l)].photoName+'" attr-prdId="'+y[(u+l)].disPrdId+'" attr-packageSkuCode="'+y[(u+l)].sbomCode+'">'+h[0].attrValue+"</a></dd>");v=u+l}}}}d.push("</dl></li>")}}d.push("</ul></div></div></div>")}var g=(c.totalPrice-c.packageTotalPrice).toFixed(2);d.push('<div class="product-package-mini-tool clearfix">');d.push('<p><span class="f14">\u5957\u9910\u4ef7\uff1a</span><strong class="red">\uffe5'+c.packageTotalPrice+'</strong><span class="save"> <strong>\u7701</strong><em>\uffe5'+g+"</em> </span></p>");d.push('<a href="#" class="product-package-mini-btn" onclick="ec.product.buyBundle(1,this)">\u52a0\u5165\u8d2d\u7269\u8f66</a>');d.push("</div></div>")}$("#packageList").html(d.join(""));ec.product.packageGetSkuCode();$("#pro-price-label").html("\u5957\u9910\u4ef7");$("#pro-price-label").removeClass("f24").addClass("type");$("#pro-price-label").show();$("#pro-price").html("<em>&yen;</em>"+c.packageTotalPrice);ec.product.newPackageSwiper()};ec.product.packageViewChange=function(b,a){if($(b).parent().parent().hasClass("selected")){if($(b).parent().parent().hasClass("click")){$(b).parent().parent().removeClass("click");$("#packageList").addClass("hide")}else{if(a==null){$("#packageList").html("");return}else{$(b).parent().parent().addClass("click");$("#packageList").removeClass("hide")}}}else{$(b).parent().parent().parent().find("li").removeClass("selected click");if(a==null){$(b).parent().parent().addClass("selected");$("#packageList").html("");$("#packageCode").val("");$("#packageListCode").val("")}else{$(b).parent().parent().addClass("selected click");$("#packageList").removeClass("hide")}$("#package-selected").html();$("#package-selected").html("&nbsp;/&nbsp;"+$(b).parent().parent().attr("data-attrname"))}};$("body").live("click",function(a){if(!($("#package_dl").length>0)){return}if($(a.target).parents("#packageList").length>0||$(a.target).parents("#packageSelect").length>0){return}else{if($("#packageList").hasClass("hide")){return}$("#packageSelect").find(".click").removeClass("click");$("#packageList").addClass("hide");ec.product.packageGetSkuCode()}});ec.product.packageChangeColor=function(a){if($(a).parent().hasClass("selected")){return}else{$(a).parent().parent().find("dd").removeClass("selected");$(a).parent().addClass("selected");ec.product.packageGetSkuCode()}};ec.product.packageGetSkuCode=function(){var a=[];$("#packageSelect").find("ul").find("dl").find(".selected").find("a").each(function(){if($(this).attr("attr-packageskucode")!=""){$(this).parent().parent().parent().attr("attr-packageskucode",$(this).attr("attr-packageskucode"));$(this).parent().parent().parent().find("img").attr("src",$(this).attr("attr-imgSrc"));$(this).parent().parent().parent().find("p").attr("title",$(this).attr("attr-name"));$(this).parent().parent().parent().find("p").html($(this).attr("attr-name"))}});$("#goodsRecommend-recommend").find("li").each(function(){a.push($(this).attr("attr-packageskucode"))});$("#packageListCode").val(a)};ec.product.newPackageSwiper=function(){var a=$("#goodsRecommend-recommend").find(".swiper-slide").length;if(a<=2){$("#btn-prev").addClass("disabled");$("#btn-next").addClass("disabled")}else{$("#btn-next").removeClass("disabled")}var b=new Swiper("#goodsRecommend-recommend",{slidesPerView:2,slidesPerGroup:2});$("#btn-prev").click(function(){b.swipePrev();ec.product.showSwiper()});$("#btn-next").click(function(){b.swipeNext();ec.product.showSwiper()})};ec.product.showSwiper=function(){var a=$("#goodsRecommend-recommend").find("li").length;$.each($("#goodsRecommend-recommend").find("li"),function(b,c){if(b==0&&$(c).hasClass("swiper-slide-visible")){$("#btn-prev").addClass("disabled")}else{if(b==0&&!$(c).hasClass("swiper-slide-visible")){$("#btn-prev").removeClass("disabled")}}if(b==(a-1)&&$(c).hasClass("swiper-slide-visible")){$("#btn-next").addClass("disabled")}else{if(b==(a-1)&&!$(c).hasClass("swiper-slide-visible")){$("#btn-next").removeClass("disabled")}}})};ec.product.hidebundleView=function(){if($("#bundlePackage").length>0&&$("#bundlePackage").find("li").length>1){return}else{if($("#bundlePackage").find("li").length==1){$("#bundlePackage").addClass("hide")}}};
ec.pkg("ec.product");ec.load("ajax");ec.load("ec.dh");ec.load("ec.aes");ec.load("ec.rc4");var _defaultAddress=["\u5e7f\u4e1c","\u6df1\u5733","\u9f99\u5c97\u533a"];var _defaultTimeOut=10000;var address=[];var tree_url=domainShoppingConfig+"/data/region/tree/{id}.json";var children_url=domainShoppingConfig+"/data/region/children/{id}.json";var addressInfoMap={};var commonAddress={};var _tempAddress=[];var _tempAddressIds=[];var addressConfig=null;var cache={},ajaxer;var skuAddress;var ipAddress=[];var ipAddressCookie=[];var sbomCode=null;ec.product.parseUrl=function(a,b){return a.replace(/{id}/g,b)};ec.product.processAddress=function(b){_tempAddressIds=[];_tempAddress=[];skuAddress=b;var c=address[0];var a=[];a.push("<dt>\u9009\u62e9\u65b0\u5730\u5740</dt>");if(c!=null&&c!=""){a.push('<dd id="provice" level-value="1" data-value="" class="current">'+c+"</dd>")}else{a.push('<dd id="provice" level-value="1" data-value="">\u8bf7\u9009\u62e9</dd>')}a.push('<dd id="city" level-value="2" data-value="">\u8bf7\u9009\u62e9</dd>');a.push('<dd id="district" level-value="3" data-value="">\u8bf7\u9009\u62e9</dd>');$("#provice_info").html(a.join(""));$("#provice_info").find("dd").bind("click",ec.product.againSelectAddress);ec.product.queryData(ec.product.parseUrl(tree_url,"0"),true,1,ec.product.queryProvince)};ec.product.againSelectAddress=function(){var c=$(this).attr("data-value");var a=parseInt($(this).attr("level-value"));if((c==null||c=="")&&a!=1){return}$(".address-new").find("dd").removeClass();switch(a){case 1:$("#provice").addClass("current");$("#city").html("\u8bf7\u9009\u62e9");break;case 2:$("#provice").removeClass("current");$("#city").addClass("current");break;case 3:$("#provice").removeClass("current");$("#city").removeClass("current");$("#district").addClass("current");break}if(a==1){ec.product.queryData(ec.product.parseUrl(tree_url,"0"),true,1,ec.product.queryProvince)}else{var b=parseInt(c);ec.product.queryData(ec.product.parseUrl(children_url,b),true,a,ec.product.queryProvince)}};ec.product.selectedAddress=function(){var c=$(this).attr("districtId");var a=$(this).attr("id");var b=skuAddress.price;ec.util.cookie.set("selectedAddress",$(this).attr("provinceId")+"|"+$(this).attr("cityId")+"|"+c,{expires:30,domain:".vmall.com"});ec.util.cookie.set("shopAddressID",a,{expires:30,domain:".vmall.com"});ec.product.showAddress(commonAddress[a]);ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,c,b,null,sbomCode)};ec.product.changeAddress=function(){var c=$(this).attr("id");_tempAddressIds.push(c);_tempAddress.push($(this).html());var a=ec.product.replaceChar($(this).html());var b=parseInt($(this).attr("addrType"));$(".address-new").find("dd").removeClass();switch(b){case 1:$("#provice").html(a);$("#city").attr("data-value",c);$("#provice").removeClass("current");$("#city").addClass("current");break;case 2:$("#city").html(a);$("#district").attr("data-value",c);$("#provice").removeClass("current");$("#city").removeClass("current");$("#district").addClass("current");break;case 3:$("#district").html(a);$("#district").attr("data-value",c);$("#provice").removeClass("current");$("#city").removeClass("current");$("#district").addClass("current");$("#address_table").hide();break}if(b<3){ec.product.queryData(ec.product.parseUrl(children_url,c),true,b+1,ec.product.queryProvince)}else{if(b==3&&_tempAddress.length==3&&_tempAddressIds.length==3){address=_tempAddress;ec.product.showAddress(address);ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,_tempAddressIds[2],skuAddress.price,null,sbomCode);ec.util.cookie.set("selectedAddress",_tempAddressIds[0]+"|"+_tempAddressIds[1]+"|"+_tempAddressIds[2],{expires:30,domain:".vmall.com"})}}};ec.product.userAddress=function(g,h){var f=[],d=g;f.push("<dt>\u5e38\u7528\u5730\u5740</dt>");commonAddress={};for(var c=0;c<d.length;c++){var e=[];var j=d[c].provinceName;var l=d[c].cityName;var k=ec.product.replaceChar(d[c].districtName);var b=d[c].streetName==null?"":d[c].streetName;addressInfoMap[d[c].id]=j+"&nbsp;"+l+"&nbsp;"+k+b+"&nbsp;"+ec.util.escapeHtml(d[c].address);var a=addressInfoMap[d[c].id];f.push('<dd title="'+a+'" id="'+d[c].id+'" provinceId="'+d[c].province+'" cityId="'+d[c].city+'" districtId = "'+d[c].district+'">'+l+"&nbsp;"+k+"</dd>");e.push(j);e.push(l);e.push(d[c].districtName);commonAddress[d[c].id]=e}$("#in_common_use_address").html(f.join(""));$("#in_common_use_address").find("dd").bind("click",ec.product.selectedAddress)};ec.product.queryTips=function(a,b){$("#deatilAddress").html(addressInfoMap[a]);$("#deatilAddress").css("position","absolute");$("#deatilAddress").css("z-index","9999");$("#deatilAddress").css("top",(parseInt(b.position().top)+b.innerHeight()+12)+"px");$("#deatilAddress").css("display","block");$("#deatilAddress").show()};ec.product.queryProvince=function(f,g,h){var c;if(g==1){c=f.data[0]}else{c=f.data}var e=[];var a=c.length;e.push('<table style="min-height=180px;" width="100%" border="0" cellpadding="0" cellspacing="0">');e.push("<tbody>");var d=0;for(var b=0;b<a;b++){if(d==0){e.push("<tr>")}var j=ec.product.replaceChar(c[b].name);e.push('<td id="'+c[b].id+'" addrType="'+g+'">'+j+"</td>");d=d+1;if(d==4||b==a-1){d=0;e.push("</tr>")}}e.push("</tbody>");e.push("</table>");$("#address_table").css({"min-height":"180px"}).html(e.join(""));$("#address_table").find("td").bind("click",ec.product.changeAddress);$("#address_table").show();if(ec.account.isLogin()){ec.addr.list(ec.product.userAddress)}};ec.product.queryData=function(a,c,d,e){var b;if(c&&(b=cache[a])){return e(b,d)}if(ajaxer){ajaxer.abort()}ajaxer=$.ajax({url:a,type:"get",dataType:"jsonp",success:function(f){if(c){cache[a]=f}e(f,d)},error:function(g,f){logger.warn("load data fail.")}})};var isSucTemp=false;ec.product.processExpectDelivery=function(i){address=[];skuAddress=i;var e=true;if(ec.product.status==3){ec.product.hiddenTips();e=false}if(ec.product.seCode!=ec.product.productSeCode||parseInt(ec.product.productType)!=0){ec.product.hiddenTips();e=false}var j=skuAddress.buttonMode;if(parseInt(j)!=1&&parseInt(j)!=10){ec.product.hiddenTips();e=false}if(parseInt(j)==10){var f=ec.product.getSysDate();var g=ec.product.getSkuInfo(skuAddress.id||ec.product.defaultSku).endTime;var h=new Date();if(null==g||""==g){h=new Date(2999,1,1,0,0,0)}else{h.setTime(g.parseDate("yyyy-MM-dd HH:mm:ss"))}if((f-h)>0){ec.product.hiddenTips();e=false}}if(ec.product.isSupportDisTime=="0"){e=false}if(!e){var d=$.parseJSON(ec.product.deliveryArrival);if(d!=undefined&&d!=""){ec.product.processPreDeliveryAndArrivalTime(d[skuAddress.id],false)}else{ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,null,null,null,i.code)}return}isSucTemp=true;var c=ec.util.cookie.get("selectedAddress");if(c==null){if(ec.account.isLogin()){ec.product.getUserDefaultAddress()}else{ec.product.parseCookie()}}else{var b=c.split("|");if(b.length==3){var a=b[2];ec.product.queryData(ec.product.parseUrl(tree_url,a),true,1,ec.product.getCitydistrict)}}};ec.product.processSupportDisplayDilieryTime=function(a){sbomCode=a.code;ec.product.processExpectDelivery(a)};ec.product.parseCookie=function(){var b=ec.util.cookie.get("ipaddress");if(b!=null){var e=b.split(",");var a=[];for(var d=0;d<3;d++){a[d]=e[d]}ec.product.showAddress(a);var c=skuAddress.price;ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,e[3],c,"-1",sbomCode)}else{ec.product.getUserAddressByIP(ec.product.addressCall)}};ec.product.getCitydistrict=function(g){address=[];var l=g.values;var b=g.data[0];for(var e=0;e<b.length;e++){var k=b[e];if(k.id==l[0]){address.push(k.name)}}var d=g.data[1];for(var e=0;e<d.length;e++){var k=d[e];if(k.id==l[1]){address.push(k.name)}}var j=g.data[2];for(var e=0;e<j.length;e++){var k=j[e];if(k.id==l[2]){address.push(k.name)}}var h=l[2];if($.trim(h)==""){ec.product.hiddenTips();return}ec.product.showAddress(address);var f=skuAddress.price;var a=ec.util.cookie.get("selectedAddress");if(a==null){var c=$.parseJSON(ec.product.deliveryArrival);if(c!=undefined&&c!=""){ec.product.processPreDeliveryAndArrivalTime(c[skuAddress.id],false)}}else{ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,h,f,null,sbomCode)}};ec.product.addressCall=function(a){var b=[];ipAddress=[];ipAddressCookie=[];if(a!=null&&a!=undefined&&a.success&&(a.address.province!=null&&a.address.province!="null"&&$.trim(a.address.province)!="")){b.push(a.address.province);ipAddress.push(a.address.province);if(a.address.city=="null"||a.address.city==null||$.trim(a.address.city)==""){b.push(null);ec.product.getAddressId(b,ec.product.queryAddressByName)}else{if(a.address.district=="null"||a.address.district==null||$.trim(a.address.district)==""){b.push(a.address.city);ipAddress.push(a.address.city);b.push(null);ec.product.getAddressId(b,ec.product.queryAddressByName)}else{b.push(a.address.city);b.push(a.address.district);address=b;ipAddressCookie[0]=b;ec.product.getAddressId(address,ec.product.setIpCookie)}}}else{address=_defaultAddress;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}};ec.product.queryAddressByName=function(b,f){var a=[];var d=b.provinceId;var e=b.cityId;var c=b.districtId;if((e!=null&&e!="")&&(c==null||c=="")){ec.product.queryData(ec.product.parseUrl(children_url,parseInt(e)),true,2,ec.product.queryCitydistrict)}else{ec.product.queryData(ec.product.parseUrl(children_url,parseInt(d)),true,1,ec.product.queryCitydistrict)}};ec.product.queryCitydistrict=function(a,c){var b=a.data;if(b==null||$.trim(b)==""||b==undefined){address=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}else{var d=b[0].id;ipAddress.push(b[0].name);if(parseInt(c)==1){ec.product.queryData(ec.product.parseUrl(children_url,parseInt(d)),true,2,ec.product.queryCitydistrict)}else{address=ipAddress;ipAddressCookie.push(ipAddress);ec.product.getAddressId(ipAddress,ec.product.setIpCookie)}}};ec.product.saveIPAddressToCookie=function(a){ec.util.cookie.set("ipaddress",a,{expires:1/12,domain:".vmall.com"})};ec.product.setIpCookie=function(b){var a=b.districtId;ipAddressCookie.push(a);ec.product.saveIPAddressToCookie(ipAddressCookie);ec.product.getAddressIdCallBack(b)};ec.product.getUserDefaultAddress=function(){var d="13232376895198612407547930718267435757728527029623408872245156039757713029036368719146452186041204237350521785240337048752071462798273003935646236777459223";var e="5421644057436475141609648488325705128047428394380474376834667300766108262613900542681289080713724597310673074119355136085795982097390670890367185141189796";var a=ec.encipher.randomInt(128);var f=ec.encipher.bigPowMod(e,a,d);var c=[];$.ajax({url:domainShoppingConfig+"/member/myAddresses/default.json",dataType:"json",data:{pubkey:f,seType:"r"},timeout:_defaultTimeOut,async:false,beforeSend:function(b){b.withCredentials=true},success:function(b){if(!b.success||b.shoppingConfg==null||b.shoppingConfg==""){ec.product.parseCookie();return}ec.util.cookie.set("sc_p",b.pubkey);var g=ec.lang.json.parse(b);g=b.shoppingConfg;c.push(g.provinceName);c.push(g.cityName);c.push(g.districtName);if(c==null||c.length==0){ec.product.parseCookie()}else{address=c;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}},error:function(){address=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}})};ec.product.showSupportDisplayDilieryTime=function(e,d){var b="";if(!d){if(e.length){var a=e.deliveryTime;var c=ec.product.getEffectivenessTime(a);b="23:00\u524d\u5b8c\u6210\u652f\u4ed8\uff0c\u9884\u8ba1"+c+"\u9001\u8fbe"}}$("#pro-predict").find("span:first").html(b);ec.product.showTips();if(d){$("#order_confirm_tips").hide()}};ec.product.getUserAddressByIP=function(a){$.ajax({url:"/ip/location.json",type:"get",dataType:"jsonp",jsonpCallback:"callback",timeout:_defaultTimeOut,success:function(b){if(b.success){a(b)}else{address=_defaultAddress;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}},error:function(){address=_defaultAddress;ec.product.getAddressId(address,ec.product.getAddressIdCallBack)}})};ec.product.getAddressIdCallBack=function(c){var a=c.districtId;if($.trim(a)==""){ec.product.hiddenTips();return}ec.product.showAddress(address);var b=skuAddress.price;ec.prescription.queryPreDeliveryAndArrival(ec.product.processPreDeliveryAndArrivalTime,a,b,null,sbomCode)};ec.product.getAddressId=function(a,b){$.ajax({url:domainShoppingConfig+"/matchRegion.json",type:"get",dataType:"jsonp",data:{provinceName:a[0],cityName:a[1],districtName:a[2]},jsonpCallback:"addressCallback",timeout:_defaultTimeOut,success:function(c){if(c.success){b(c)}else{a=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}},error:function(){a=_defaultAddress;ec.product.getAddressId(_defaultAddress,ec.product.getAddressIdCallBack)}})};ec.product.showAddress=function(a){$("#address").find("a").html(a[0]+"&nbsp;&gt;&nbsp;"+a[1]+"&nbsp;&gt;&nbsp;"+ec.product.replaceChar(a[2]))};ec.product.hiddenTips=function(){$("#product-pulldown1").addClass("product-description");$("#pro-predict").hide()};ec.product.showTips=function(){$("#product-pulldown1").removeClass("product-description");$(".product-operation-main").removeClass("product-operation-location");$("#pro-predict").show();var a=$(".product-property").height();if(a<=526){$(".product-operation-main").addClass("product-operation-location")}else{$(".product-operation-main").removeClass("product-operation-location")}};ec.product.showExpectTime=function(a){$("#product-pulldown1").removeClass("product-description");$(".product-operation-main").removeClass("product-operation-location");if(a==1){$("#address").parent().hide()}else{if($("#address").find("a").html().length>1){$("#address").parent().show()}else{$("#address").parent().hide()}}$("#pro-predict").show();var b=$(".product-property").height();if(b<=536){$(".product-operation-main").addClass("product-operation-location")}else{$(".product-operation-main").removeClass("product-operation-location")}};ec.product.getEffectivenessTime=function(b,c){var f;var e=ec.product.getSysDate();var h=e.getHours();var d=e.getTime();var g=new Date();g.setTime(d);c=c.substring(0,2);if(h>=0&&h<c){g.setHours(parseInt(c)+b)}else{g.setHours(parseInt(c)+b)}var a=(parseInt(g.getMonth())+1)+"\u6708"+g.getDate()+"\u65e5\uff08"+ec.product.getWeekByTime(g)+"\uff09";return a};ec.product.getWeekByTime=function(a){var c=a.getDay();var e="";switch(c){case 0:e="\u5468\u65e5";break;case 1:e="\u5468\u4e00";break;case 2:e="\u5468\u4e8c";break;case 3:e="\u5468\u4e09";break;case 4:e="\u5468\u56db";break;case 5:e="\u5468\u4e94";break;case 6:e="\u5468\u516d";break}var d=new Date();var b=d.diff(a);if(b==0){e="\u4eca\u5929"}if(b==1){e="\u660e\u5929"}return e};Date.prototype.diff=function(a){return Math.floor((a.getTime()-new Date(new Date().setHours(0,0,0,0)).getTime())/(24*60*60*1000))};ec.product.replaceChar=function(a){if(a!=null&&a!=""&&a=="-"){return"\u5176\u5b83\u5730\u533a"}else{return a}};ec.product.processPreDeliveryAndArrivalTime=function(l,c){var j=false;var g=null,h=0;var f=skuAddress.buttonMode;var k=ec.product.inventory.haveInventory(skuAddress.id);if(!c){if(l&&l.success){var b=l.info;if(b.shippingDate&&b.shippingDate.length>0){if(((f==1)&&(!k))){j=true}else{h=1;g=b.shippingDate;$("#expectTimeDesc").html("\u201d\u9884\u8ba1\u53d1\u8d27\u65f6\u95f4\u201c\u662f\u6839\u636e\u5546\u54c1\u5e93\u5b58\u7684\u4fe1\u606f\u8ba1\u7b97\u51fa\u6765\u7684\uff0c\u4e3a\u60a8\u63d0\u4f9b\u4f18\u8d28\u7684\u670d\u52a1\u4f53\u9a8c\uff0c\u53d7\u8bf8\u591a\u56e0\u7d20\u5f71\u54cd\u53ef\u80fd\u4f1a\u4ea7\u751f\u504f\u5dee\uff0c\u6211\u4eec\u4f1a\u4e3a\u60a8\u79ef\u6781\u5907\u8d27\uff1b\u76f8\u540c\u6216\u7c7b\u4f3c\u7684\u6536\u8d27\u5730\u5740\uff0c\u540c\u4e00\u8054\u7cfb\u65b9\u5f0f\uff0c\u540c\u4e00\u4ed8\u6b3e\u8d26\u6237\uff0c\u540c\u4e00\u6536\u8d27\u4eba\u7684\u8ba2\u5355\u53ef\u80fd\u5b58\u5728\u5ef6\u8fdf\u53d1\u8d27\uff0c\u611f\u8c22\u60a8\u7684\u7406\u89e3\u4e0e\u652f\u6301\u3002")}}else{if(b.estimatedArrivalTime!=null&&b.estimatedArrivalTime!=""){h=2;var a="";var e="";var i=b.estimatedArrivalTime;if(l.beforeAndAfterFlag=="1"){a=i.earlyArrivalTime;e="\u4eca\u5929"}else{a=i.lateArrivalTime;e="\u660e\u5929"}var d=ec.product.getEffectivenessTime(a,i.deadlineTime);g="<span class='red'>\u73b0\u8d27</span>\uff0c"+e+i.deadlineTime+"\u524d\u4ed8\u6b3e\uff0c\u9884\u8ba1"+d+"\u9001\u8fbe";$("#expectTimeDesc").html("\u201d\u9884\u8ba1\u9001\u8fbe\u65f6\u95f4\u201d\u529f\u80fd\u5904\u4e8e\u8bd5\u8fd0\u8425\uff0c\u53ef\u80fd\u4f1a\u7565\u6709\u504f\u5dee\uff0c\u6700\u7ec8\u4ee5\u5b9e\u9645\u5230\u8d27\u65f6\u95f4\u4e3a\u51c6\uff0c\u5982\u6709\u7591\u95ee\u8bf7\u60a8\u8054\u7cfb\u5546\u57ce\u5ba2\u670d\u3002\u611f\u8c22\u60a8\u5bf9\u534e\u4e3a\u5546\u57ce\u7684\u652f\u6301\u548c\u7406\u89e3\uff01")}}if(g!=null){$("#pro-predict").find("span:first").html(g);ec.product.showTips();ec.product.showExpectTime(h)}else{if(j){ec.product.hiddenTips()}if(b.arrivalTimeStatus=="1"){ec.product.hiddenTips()}if(b.arrivalTimeStatus=="2"){if(isSucTemp){$("#address").parent().show();ec.product.showTips();$("#pro-predict").find("span:first").html("<span class='red'>\u73b0\u8d27</span>");$(".product-address-prompt").find("em").eq(0).remove()}else{ec.product.hiddenTips()}}}ec.product.deliveryArrival=""}}};
ec.pkg("ec.product.gift");ec.product.gift={proGiftChosenImgSrc:"",proGiftChosenImgAlt:"",proGiftGallerys:[],giftTrees:[],data:"",giftArrays:{},defaultGift:[],mainSkuGiftMap:{},mainSkuGiftKeyMap:{},defaultGiftMap:{},finalMainSbomGiftMap:{},tempMainSbomGiftMap:{},isChange:"true",picMediaServer:ec.mediaPath,sku:"",middleImgSize:"55_55_",navImgSize:"55_55_",ITEM_WIDTH:52,isChange:false,popupHtml:function(){var e=[],f=[],b=0,a=0;var k="";var h=ec.product.getSku();defaultGift=this.defaultGiftMap[h];multiGiftVO=this.mainSkuGiftMap[h];multiGiftVOKeys=this.mainSkuGiftKeyMap[h];finalGift=this.finalMainSbomGiftMap[h]||{};giftSize=multiGiftVOKeys.length;var j=[],g=[];for(var d=0;d<giftSize;d++){var c=multiGiftVO[multiGiftVOKeys[d]];if(multiGiftVOKeys[d].indexOf("_")<0){if(d>0){f.push(this.renderSingleGift(g,j));j=[];g=[]}j.push(c);g.push(multiGiftVOKeys[d])}if((multiGiftVOKeys[d].indexOf("_")>0&&d>0)){j.push(c);g.push(multiGiftVOKeys[d])}if(d==(giftSize-1)){f.push(this.renderSingleGift(g,j));j=[];g=[]}}e.push(f.join(" "));return e.join(" ")},renderSingleGift:function(d,c){var a=c.length;defaultGift=c[0];finalGift=this.finalMainSbomGiftMap[this.sku];choseGift=finalGift[d[0]];if(d.length!=c.length){}html=[];html.push('<div class="product-partscolor-layer">');html.push('<div class="product-partscolor-detail clearfix"> ');html.push('<a id="gift-detail-'+d[0]+'"   href="/product/'+choseGift.giftId+".html#"+choseGift.giftSkuId+'" target="_blank">');html.push('<img class="product-partscolor-detailimg" src="'+ec.mediaPath+choseGift.photoPath+this.middleImgSize+choseGift.photoName+'">');html.push("</a>");html.push('<div class="product-partscolor-list"> ');html.push('<h2 id="gift-detail-name'+d[0]+'">'+choseGift.giftName+"</h2>");html.push('<ul class="clearfix">');for(var b=0;b<a;b++){if(choseGift.giftSkuId==c[b].giftSkuId){html.push('<li class="selected h">')}else{html.push('<li class="h">')}html.push('<a href="javascript:;" key="'+d[b]+'" defaultGiftKey="'+d[0]+'" title="'+c[b].giftAttrVal+'">');html.push('<img src="'+ec.mediaPath+c[b].photoPath+this.navImgSize+c[b].photoName+'">');html.push("<p><span>"+c[b].giftAttrVal+"</span></p>");html.push('<input name= "box-value" type="hidden"  choseGiftKey="'+d[b]+'" defaultGiftKey= "'+d[0]+'"/>');html.push("</a>");html.push("</li>")}html.push("</ul>");html.push("</div>");html.push("</div> ");html.push("</div> ");return html.join(" ")},ftl:function(e){this.sku=ec.product.getSku();var c=[];var b=this.defaultGiftMap[e];var d=this.mainSkuGiftMap[e];var a=this.finalMainSbomGiftMap[e]||{};for(var f=0;f<b.length;f++){var g=d[b[f]];if(g){a[g.giftId]=g;c.push('<a id="gift-'+g.giftId+'"  href="/product/'+g.giftId+".html#"+g.giftSkuId+'" target="_blank" title="'+g.giftName+'">');c.push('<img src="'+ec.mediaPath+g.photoPath+this.navImgSize+g.photoName+'" alt="'+g.giftName+'"></a>')}}this.finalMainSbomGiftMap[e]=a;$("#pro-gift-list-detail").html(this.popupHtml());return c.join("")},init:function(j,k){if(!k&&!j){return}var b={};var d=[];var c=[];this.giftArrays=k;var e=[];var h=0,a=0;for(var g=0;g<k.length;g++){var f=b[k[g].giftId];if(!f){c.push(k[g].giftId);b[k[g].giftId]=k[g];d.push(k[g].giftId);++a}else{b[k[g].giftId+"_"+h]=k[g];d.push(k[g].giftId+"_"+h);h++}}this.mainSkuGiftMap[j]=b;this.mainSkuGiftKeyMap[j]=d;this.defaultGiftMap[j]=c},cloneObj:function(c){var d,b=c.constructor===Array?[]:{};if(typeof c!=="object"){return}else{if(window.JSON){d=JSON.stringify(c),b=JSON.parse(d)}else{for(var a in c){b[a]=typeof c[a]==="object"?cloneObj(c[a]):c[a]}}}return b},getGiftsSize:function(){var c=ec.product.getSku(),a=0;multiGiftVOKeys=this.mainSkuGiftKeyMap[c];giftSize=multiGiftVOKeys.length;for(var b=0;b<giftSize;b++){if((multiGiftVOKeys[b].indexOf("_")<0)){++a}}return a}};
ec.pkg("ec.product.coupon");ec.load("ec.box");ec.product.coupon={sbomCouponList:{},applyResultList:{},loadCoupon:function(a){ec.product.coupon.loadCouponEx(a,function(d){if(d&&d.success&&d.couponList&&d.couponList.length>0){ec.product.coupon.sbomCouponList[a]=d.couponList;$("#couponBtn").show();$("#couponTag").html("");var b=[];if(d.couponList.length>3){for(var c=0;c<d.couponList.length;c++){if(c<3){if(d.couponList[c].couponTag!=null){b.push("<span onclick=\"ec.product.coupon.clickBtn('"+a+'\')" class="product-ticket">'+d.couponList[c].couponTag+"</span>")}}if(c>=3){break}}}else{for(var c=0;c<d.couponList.length;c++){if(d.couponList[c].couponTag!=null){b.push("<span onclick=\"ec.product.coupon.clickBtn('"+a+'\')" class="product-ticket">'+d.couponList[c].couponTag+"</span>")}}}b.push(' <a href="javascript:;" class="product-ticket-link" onclick="ec.product.coupon.clickBtn(\''+a+"')\">立即领取&nbsp;&gt;</a>");$("#couponTag").html(b.join(" "))}else{$("#couponBtn").hide()}},function(b){},function(){})},loadCouponEx:function(d,a,c,b){new ec.ajax().get({url:"/product/queryCoupon.json?sbom="+d,type:"get",timeout:10000,timeoutFunction:function(){b()},successFunction:function(e){a(e)},errorFunction:function(e){c(e)}})},clickBtn:function(a){ec.product.coupon.showDialog(a)},closeDialog:function(){$("#pro-roll-page").hide()},showDialog:function(a){$("#pro-roll-message").html("");$("#pro-roll-list").html("");$("#pro-roll-page").hide();var b=ec.product.coupon.sbomCouponList[a];if(b){ec.product.coupon.showDialogEx(a,b)}else{ec.product.coupon.loadCouponEx(a,function(c){if(c&&c.success&&c.couponList&&c.couponList.length>0){ec.product.coupon.sbomCouponList[a]=c.couponList;ec.product.coupon.showDialogEx(a,c.couponList)}else{}},function(){},function(){})}},showDialogEx:function(a,c){var b=new ec.box($("#pro-roll-textarea").val(),{boxid:"successBox",boxclass:"ol_box_4",width:700,title:"- 领取优惠券 -",showButton:false,onopen:function(d){ec.product.coupon.couponBuildText(a,c);d.setPosition()},onclose:function(d){ec.product.coupon.closeDialog()}});b.open()},couponBuildText:function(j,g){var d=[];for(var c=0;c<g.length;c++){paramsReceiveCoupon="'"+g[c].activityCode+"','"+g[c].batchCode+"','"+j+"'";var b=g[c].activityCode+"-"+g[c].batchCode;var a="";var h="";var e="";var f="";if(g[c].couponType==1&&g[c].deliveryFree==0){e="<span>"+g[c].amount+"</span><p><strong>优惠券</strong></p>";f="<em>&yen;</em>"}else{if(g[c].couponType==2&&g[c].deliveryFree==0){h=" roll-discount";e="<span>"+g[c].discount*10+"</span><p><b>折</b></p>"}else{h=" roll-type";e="<span>免邮券</span>"}}switch(g[c].state){case -1:d.push('<li id="roll-detail-'+b+'" class="roll-detail receive'+h+'" title="'+g[c].batchName+'">');d.push(' <a id="roll-link-'+b+'" href="javascript:;" >'+f);a="已<br>领<br>完";break;case 1:d.push('<li id="roll-detail-'+b+'" class="roll-detail'+h+'" title="'+g[c].batchName+'">');d.push(' <a id="roll-link-'+b+'" href="javascript:;"  onclick="ec.product.coupon.receiveCoupon('+paramsReceiveCoupon+')">'+f);a="立<br>即<br>领<br>取";break;case 2:d.push('<li id="roll-detail-'+b+'" class="roll-detail receive'+h+'" title="'+g[c].batchName+'">');d.push(' <a id="roll-link-'+b+'" href="javascript:;" >'+f);a="已<br>领<br>取";break;case 3:d.push('<li id="roll-detail-'+b+'" class="roll-detail begin'+h+'" title="'+g[c].batchName+'">');d.push(' <a id="roll-link-'+b+'" href="javascript:;" >'+f);a="即<br>将<br>开<br>始";break;case 4:d.push('<li id="roll-detail-'+b+'" class="roll-detail disabled'+h+'" title="'+g[c].batchName+'">');d.push(' <a id="roll-link-'+b+'" href="javascript:;" >'+f);a="已<br>结<br>束";break;default:d.push('<li id="roll-detail-'+b+'" class="roll-detail'+h+'" title="'+g[c].batchName+'">');d.push(' <a id="roll-link-'+b+'" href="javascript:;" >'+f);a="";break}d.push(' <div class="roll-info">');d.push('  <div class="roll-price clearfix">');d.push(e);d.push("  </div>");d.push(' <p class="roll-word">'+g[c].batchName+"</p>");d.push(' <p class="roll-time">'+new Date(g[c].beginDate).format("yyyy.MM.dd")+" - "+new Date(g[c].endDate).format("yyyy.MM.dd")+"</p>");d.push("</div>");d.push('<div id="roll-state-'+b+'" class="roll-btn">'+a+"</div>");d.push("</a></li>")}var d='<ul class="clearfix">'+d.join(" ")+"</ul>";$("#pro-roll-list").html(d);if(g.length==1){$("#pro-roll-list ul li").removeClass("disabled");$("#pro-roll-list ul li").addClass("roll-detail-one")}$("#pro-roll-page").show()},goLogin:function(){var a=domainMain+"/account/login?url="+encodeURIComponent(window.location.pathname+"#"+ec.product.getSku())+"&_t="+new Date().getTime();window.location.href=a},showMsg:function(c,b){b=""+b;var a="";a="<span>"+c+"</span>";switch(b){case"9206":a+='<a href="javascript:;" onclick="ec.product.coupon.goLogin()" >马上登录</a>';break;case"9208":a+='<a href="'+$("#accountCenterUrl").val()+'" target="_blank" >去绑定</a>';break;case"9209":a+='<a href="'+$("#authUrl").val()+'" target="_blank" >去认证</a>';break;case"9210":a+='<a href="'+$("#notFinishAllUPDataURL").val()+'" target="_blank" >完善资料</a>';break;default:a+=""}$("#pro-roll-message").html(a);$("#pro-roll-message").addClass("product-layer-tips")},receiveCoupon:function(b,d,a){var c=b+"-"+d;ec.product.syncCustomSession();$("#pro-roll-message").html("");$("#pro-roll-message").removeClass();$.ajax({url:domainAms+"/couponCodeActivity/receive.json?activityCode="+b+"&batchCode="+d+"&t="+new Date().getTime(),dataType:"jsonp",timeout:10000,success:function(e){if(e&&e.state){switch(e.state){case -1:$("#roll-detail-"+c).addClass("receive");$("#roll-state-"+c).html("已<br>领<br>完");$("#roll-link-"+c).removeAttr("onclick");break;case 1:break;case 2:$("#roll-detail-"+c).addClass("receive");$("#roll-state-"+c).html("已<br>领<br>取");$("#roll-link-"+c).removeAttr("onclick");break;case 3:$("#roll-detail-"+c).addClass("begin");$("#roll-state-"+c).html("即<br>将<br>开<br>始");$("#roll-link-"+c).removeAttr("onclick");break;case 4:$("#roll-detail-"+c).addClass("disabled");$("#roll-state-"+c).html("已<br>结<br>束");$("#roll-link-"+c).removeAttr("onclick");break;default:break}}if(e&&e.success){$("#pro-roll-message").html("<span>"+e.pcReviceSuccTip+"</span>");$("#pro-roll-message").addClass("product-layer-tips product-layer-success");delete ec.product.coupon.sbomCouponList[a];return}if(!e.code){$("#pro-roll-message").addClass("product-layer-tips");$("#pro-roll-message").html("<span>亲，瞬间被你的热情吓到了，容我缓缓，请稍候再来哦~</span>");return}ec.product.coupon.showMsg(e.errorTip,e.code)},error:function(){$("#pro-roll-message").addClass("product-layer-tips");$("#pro-roll-message").html("<span>亲，瞬间被你的热情吓到了，容我缓缓，请稍候再来哦~</span>")}})}};ec.pkg("rush");rush.account={isLogin:function(){return ec.account.isLogin()},getUid:function(){return ec.account.uid}};rush.sbom={getSbom:function(a){return ec.product.getSkuInfo(a)},isRushProduct:function(){return $("#pro-global-parameter").attr("data-skulist-rushbuy")?true:false},isRushSbom:function(a){var b=$("#pro-global-parameter").attr("data-skulist-rushbuy");var d=","+b+",",c=","+a+",";if(d.indexOf(c)!=-1){return true}return false},getCurrSbom:function(){return ec.product.getSkuInfo(ec.product.getSku())},getCurrSkuId:function(){return ec.product.getSku()}};rush.activity={_loadStatus:0,_activityMap:{},getActivity:function(a){return rush.activity._activityMap[a]},isLoaded:function(){return rush.activity._loadStatus==1?true:false},afterLoaded:function(c){if(c.sbom.id!=rush.business.runningSkuId){return}btnStatus=rush.business.newBtnStatus("A3U3Q3S3",c.sbom.id);rush.business.displayBtnStatus(c.sbom,null,btnStatus);if(rush.activity.isLoaded()){c.doCallBack(c.sbom)}else{var b=$("#pro-global-parameter").attr("data-skulist-rushbuy");var a=domainRush+"/getSkuRushbuyInfo.json?skuIds="+b+"&t="+new Date().getTime();$.ajax({url:a,dataType:"jsonp",timeout:5000,success:function(g){if(g){rush.business.setOffsetTime(new Date().getTime(),g.currentTime);if(g.success==true&&g.skuRushBuyInfoList){var e=g.skuRushBuyInfoList;for(var f=0;f<e.length;f++){if(e[f]&&e[f].skuId){rush.activity._activityMap[e[f].skuId]=e[f];if(e[f].startTime&&e[f].endTime){rush.activity._activityMap[e[f].skuId].startTime=new Date(e[f].startTime).format("yyyy-MM-dd HH:mm:ss");rush.activity._activityMap[e[f].skuId].endTime=new Date(e[f].endTime).format("yyyy-MM-dd HH:mm:ss")}}}rush.activity._loadStatus=1}}else{var d='<a onclick="rush.business.clickBtn()" class="button-book-2 button-style-1" ><span>立即申购</span></a>';$("#pro-operation").html(d);$("#pro-operation").css("visibility","visible")}},complete:function(f,e){if(e=="timeout"){var d='<a onclick="rush.business.clickBtn()" class="button-book-2 button-style-1" ><span>立即申购</span></a>';$("#pro-operation").html(d);$("#pro-operation").css("visibility","visible")}else{c.doCallBack(c.sbom)}}})}}};rush.qualification={afterChecked:function(c){if(c.sbom.id!=rush.business.runningSkuId){return}var e,d;var a=c.act;if(!a||!a.isRushBuySku){return}if(!rush.account.isLogin()){e=0;c.doCallBack(c.sbom,c.act,e);return}activityId=a.activityId;uid=rush.account.getUid();e=ec.util.cookie.get("isqueue-"+activityId+"-"+uid);d=ec.util.cookie.get("queueSign-"+activityId+"-"+uid);if(e&&d){c.doCallBack(c.sbom,c.act,e)}else{e=0;c.doCallBack(c.sbom,c.act,e);var f=a.qids?a.qids:"0";var b=domainYY+"/ivy/isqueue.jsp?uid="+uid+"&qid="+f+"&t="+new Date().getTime();$.ajax({url:b,dataType:"jsonp",timeout:10000,jsonpCallback:"callbackqueue",success:function(g){if(g){if(g.isqueue&&g.queueSign){var h={expires:a.endTime,domain:".vmall.com"};e=g.isqueue;d=g.queueSign;if(e&&d){ec.util.cookie.set("isqueue-"+activityId+"-"+uid,e,h);ec.util.cookie.set("queueSign-"+activityId+"-"+uid,d,h);e=ec.util.cookie.get("isqueue-"+activityId+"-"+uid);d=ec.util.cookie.get("queueSign-"+activityId+"-"+uid);c.doCallBack(c.sbom,c.act,e)}}}}})}}};rush.business={offsetTime:0,setOffsetTime:function(b,a){rush.business.offsetTime=a-b},getSysDate:function(){return new Date(new Date().getTime()+rush.business.offsetTime)},timer:null,btnStatus:{},btnSt2Mode:{AXUXQXSX:0,A0UXQXSX:1,AXUXQXS2:2,A3UXQXS1:3,A1U1Q0S1:4,A1U1Q1S1:4,A1U1Q2S1:5,A2U1Q2S1:5,A1U0QXS1:6,A2U1Q0S1:7,A2U0QXS1:7,A2U1Q1S1:7,A3U3Q3S3:8,A4U1Q0S1:9,},newBtnStatus:function(b,a){var c={};c.btnStatus=b;c.btnMode=rush.business.btnSt2Mode[b];c.skuId=a;return c},runningSkuId:null,doGoLogin:function(){var a=domainMain+"/account/login?url="+encodeURIComponent(window.location.pathname+"#"+rush.sbom.getCurrSkuId())+"&_t="+new Date().getTime();window.location.href=a},doGoRush:function(){var c=rush.sbom.getCurrSbom();var f={};f.mainSku=c.id;f.targetUrl=c.gotoUrl;f.backUrl=domainMain+window.location.pathname+"#"+c.id;var b=$("#extendSelect").attr("skuid");var d=$("#accidentSelect").attr("skuid");var e=[];if(b){e.push(b)}if(d){e.push(d)}f.accessoriesSkus=e.join(",");var a="";if(f.targetUrl&&f.mainSku&&f.mainSku.length>0){a=f.targetUrl+"?mainSku="+f.mainSku;if(f.accessoriesSkus&&f.accessoriesSkus.length>0){a+="&accessoriesSkus="+f.accessoriesSkus}if(f.backUrl&&f.backUrl.length>0){a+="&backUrl="+encodeURIComponent(f.backUrl)+""}a+="&_t="+new Date().getTime();window.location.href=a}else{return}},clickBtn:function(){if(rush.account.isLogin()){rush.business.doGoRush()}else{rush.business.doGoLogin()}},displayBtnStatus:function(e,f,d){if(e.id!=rush.business.runningSkuId){return}if(rush.business.btnStatus&&rush.business.btnStatus.btnMode==d.btnMode){return}rush.business.btnStatus=d;if(rush.business.timer){clearInterval(rush.business.timer);rush.business.timer=null}$("#pro-operation").html("");$("#pro-operation-msg").html("");var a="";switch(d.btnMode){case 0:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a class="product-button02 disabled"><span>暂时缺货</span></a>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 1:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a class="product-button02 disabled"><span>暂时缺货</span></a>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 2:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a class="product-button02 disabled"><span>已售完</span></a>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 3:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a class="product-button02 disabled"><span>暂时缺货</span></a>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 4:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}if(ec.product.productType==4){a+='<a class="product-button02 disabled">支付订金</a></div><div id="pro-operation-countdown" class="product-time"></div>'}else{a+='<a class="product-button02 disabled">立即申购</a></div><div id="pro-operation-countdown" class="product-time"></div>'}$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 5:a='<i></i><div class="tips-text"><p><span>温馨提示：</span><span id="pro-msg-title">您不符合本次购买条件。</span></p></div>';a='<div class="tips-style-2 tips-area" style="width:100%">'+a+"</div>";$("#product-tips").html("温馨提示：您不符合本次购买条件。");$("#product-tips").show();$("#product-operation").css("visibility","hidden");break;case 6:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a onclick="rush.business.clickBtn()" class="product-button02" ><span>提前登录</span></a><div id="pro-operation-countdown" class="product-time"></div>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 7:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}if(ec.product.productType==4){a+='<a onclick="rush.business.clickBtn()" class="product-button02" ><span>支付订金</span></a>'}else{a+='<a onclick="rush.business.clickBtn()" class="product-button02" ><span>立即申购</span></a>'}$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 8:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a class="product-button02 disabled"><span>正在加载...</span></a>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;case 9:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a class="product-button02 disabled" ><span>已售完</span></a>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break;default:if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();a+='<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a>'}a+='<a class="product-button02 disabled"><span>暂时缺货</span></a>';$("#pro-operation").html(a);$("#pro-operation").css("visibility","visible");$("#product-operation").show();break}if((d.btnMode==4||d.btnMode==6)&&$("#pro-operation-countdown")&&f&&f.startTime){var g=f.startTime.parseDate("yyyy-MM-dd HH:mm:ss").format("MM月dd日 HH:mm");var c=rush.business.getSysDate();ec.ui.countdown2($("#pro-operation-countdown"),{html:"<p>"+g+"开售:	</p><ul><li><span>{#day}</span></li><li><em>天</em></li><li><span>{#hours}</span></li><li><em>:</em></li><li><span>{#minutes}</span></li><li><em>:</em></li><li><span>{#seconds}</span></li>",now:c,endTime:f.startTime,callback:function(b){d=rush.business.newBtnStatus("A2U1Q1S1",e.id);rush.business.displayBtnStatus(e,act,d)}});rush.business.timer=$($("#pro-operation-countdown")).data("countdown");if(!rush.business.timer){d=rush.business.newBtnStatus("A2U1Q1S1",e.id);rush.business.displayBtnStatus(e,act,d)}$("#goAddressId").show()}else{$("#goAddressId").hide()}ec.product.refreshStyle()},doIfSbomChanged:function(c){var a=rush.sbom.getCurrSkuId();rush.business.runningSkuId=a;rush.business.btnStatus=null;if(ec.product.productType==4&&c==1){var e=rush.sbom.getSbom(a);if(ec.product.isEasyBuy()){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show();$("#pro-operation").html('<a onclick="ec.product.orderEasyBuy()" class="product-button-priority" ><span>优享购</span></a><a target="_blank" href="'+e.gotoUrl+'" class="product-button02" ><span>参加抢购</span></a>')}else{$("#pro-operation").html('<a target="_blank" href="'+e.gotoUrl+'" class="product-button02" ><span>参加抢购</span></a>')}$("#pro-operation").css("visibility","visible");$("#product-operation").show();return}if(!rush.sbom.isRushProduct()||!rush.sbom.isRushSbom(a)){return}if(rush.sbom.isRushProduct()&&rush.sbom.isRushSbom(a)){$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").show()}var b=null,d=null;b=rush.sbom.getSbom(a);if(rush.sbom.isRushProduct()){rush.activity.afterLoaded({sbom:b,doCallBack:function(g){if(g.id!=rush.business.runningSkuId){return}var f=g.id;if(rush.sbom.isRushSbom(f)){act=rush.activity.getActivity(f);if(g&&act&&act.isRushBuySku){rush.qualification.afterChecked({sbom:g,act:act,doCallBack:function(j,h,k){if(j.id!=rush.business.runningSkuId){return}var i=rush.business.calculateBtnStatus(j,h,k);rush.business.displayBtnStatus(j,h,i)}})}else{btnStatus=rush.business.newBtnStatus("A0UXQXSX",g.id);rush.business.displayBtnStatus(g,act,btnStatus);return}}else{return}}})}else{return}},calculateBtnStatus:function(d,a,h){var c="AXUXQXSX";var g=new Date(),e=new Date(),b=new Date();try{g=rush.business.getSysDate();e.setTime(a.startTime.parseDate("yyyy-MM-dd HH:mm:ss"));b.setTime(a.endTime.parseDate("yyyy-MM-dd HH:mm:ss"))}catch(f){c="AXUXQXSX";return rush.business.newBtnStatus(c,d.id)}if(g>b){if(a.skuStatus==0){c="AXUXQXS2";return rush.business.newBtnStatus(c,d.id)}c="A3UXQXS1";return rush.business.newBtnStatus(c,d.id)}if(!a.qids||a.qids=="0"){result=1}else{if(h==2){result=2}else{if(h==1){result=1}else{result=0}}}if(g<e){if(rush.account.isLogin()){switch(result){case 1:c="A1U1Q1S1";break;case 2:c="A1U1Q2S1";break;default:c="A1U1Q0S1"}}else{c="A1U0QXS1"}return rush.business.newBtnStatus(c,d.id)}if(g>=e){if(a.skuStatus==0){c="AXUXQXS2";return rush.business.newBtnStatus(c,d.id)}else{if(a.skuStatus==2){c="A4U1Q0S1";return rush.business.newBtnStatus(c,d.id)}}if(rush.account.isLogin()){switch(result){case 1:c="A2U1Q1S1";break;case 2:c="A2U1Q2S1";break;default:c="A2U1Q0S1"}}else{c="A2U0QXS1"}return rush.business.newBtnStatus(c,d.id)}}};ec.pkg("deposit");ec.product.depositInfo={};ec.product.depositInit=function(a){if(ec.product.runningSkuId!=a){return}ec.product.depositInfo={};if($("#product-deposit-agreement-area")){$("#product-deposit-agreement-area").hide()}$("#pro-quantity-area").hide();$("#pro-quantity-area-nochange").hide();$("#pro-operation").css("visibility","hidden");$("#buyProcessIDD").hide();$("#pro-price-label-deposit").html("订金");$("#pro-price-label-deposit").show();$("#pro-price-deposit").html("暂无报价");$("#pro-price-old").html("");$("#pro-price-deposit").show();$("#pro-price-old").hide();$("#pro-operation").css("visibility","hidden");$("#tab-notice-button").hide();$("#tab-addcart-button").hide()};ec.product.isDespositSku=0;ec.product.runningSkuId=0;deposit.business={offsetTime:0,setOffsetTime:function(b,a){deposit.business.offsetTime=a-b},getSysDate:function(){return new Date(new Date().getTime()+deposit.business.offsetTime)}};ec.product.depositActivity=function(a){var b=ec.product.getSkuInfo(a);$("#product-recommend-all").hide();if($("#product-deposit-agreement-area")){$("#product-deposit-agreement-area").hide()}$("#pro-operation").css("visibility","hidden");ec.product.isDespositSku=0;ec.product.runningSkuId=a;new ec.ajax().get({url:"/product/queryDeposit.json",data:{sbomCode:b.code},timeout:10000,timeoutFunction:function(){if(ec.product.runningSkuId!=a){return}ec.product.isDespositSku=2;if(b&&b.buttonMode==8){ec.product.rushbuyActivity(1)}else{ec.product.depositInit(a);alert("查询预付定金活动信息超时，请重新刷新页面。")}$("#pro-price").html("暂无报价");$("#pro-price-deposit").html("暂无报价");$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("")},beforeSendFunction:ec.ui.loading.show,afterSendFunction:ec.ui.loading.hide,successFunction:function(e){$("#package_dl").remove();_updateSelect();if(ec.product.runningSkuId!=a){return}if(e.isSuccess=="false"||(e.resultCode==0&&e.promoActivity==null)||(e.resultCode==0&&e.promoActivity=="")){ec.product.isDespositSku=2;$("#pro-price").html("暂无报价");$("#pro-price-label-deposit").html("订金");$("#pro-price-label-deposit").show();$("#pro-price-deposit").show();$("#pro-price-deposit").html("暂无报价");$("#buyProcessIDD").hide();$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("");if(b&&b.buttonMode==8){ec.product.rushbuyActivity(1)}else{ec.product.depositInit(a)}return}ec.product.isDespositSku=1;ec.product.depositInit(a);var g=e.promoActivity.depositSkuList;var d="";if(g!=""){d=g[0]}if(d.isSurePrice<1){$("#pro-price").html("暂无报价")}else{$("#pro-price").html($("#pro-price-hide").val())}ec.product.depositInfo=e;if(e.promoActivity.description.length>0){if($("#pro-parts-area").length>0){$("#pro-parts-area").find("dt").text("")}}$("#buyProcessIDD").show();$("#balanceStartDateIDD").html(timestampToTime(e.deposit.balanceStartTime)+"&nbsp;~&nbsp;"+timestampToTime(e.deposit.balanceEndTime));if(b&&b.buttonMode!=8){$("#startDateIDD").html(timestampToTime(e.deposit.startTime)+"&nbsp;~&nbsp;"+timestampToTime(e.deposit.endTime))}else{$("#startDateIDD").html("提前锁定购买资格")}$("#pro-price-label-deposit").html("订金");$("#pro-price-label-deposit").removeClass("f24").addClass("type");$("#pro-price-label-deposit").show();$("#pro-price-deposit").html("<em>&yen;</em>"+d.depositPrice.toFixed(2));$("#pro-price-deposit").show();if(d.amountPrice>0){$("#pro-price-label-amount").html("可抵");$("#pro-price-label-amount").show();$("#pro-price-amount").html("<em>&yen;</em>"+d.amountPrice.toFixed(2));$("#pro-price-amount").show()}else{$("#pro-price-label-amount").html("");$("#pro-price-label-amount").hide();$("#pro-price-amount").hide();$("#pro-price-amount").html("")}if(ec.product.inventory.haveInventory(a)){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDeposit(1);">支付订金</a>');$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#product-operation").show()}else{$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.arrival()">到货通知</a>');$("#pro-quantity-area").show();$("#pro-operation").css("visibility","visible");$("#product-operation").show()}ec.product.refreshStyle();deposit.business.setOffsetTime(new Date().getTime(),e.serverCurrentTime);var c=deposit.business.getSysDate();if(e.unStart=="unStart"){$("#pro-operation").html('<a href="javascript:;" class="product-button02 disabled">活动即将开始</a><div id="pro-operation-countdown" class="product-time"></div>');$("#pro-operation").css("visibility","visible");$("#product-operation").show();var i=new Date(e.deposit.startTime).format("yyyy-MM-dd HH:mm:ss");var f=new Date(e.deposit.startTime).format("MM月dd日 HH:mm");var c=deposit.business.getSysDate();ec.ui.countdown2($("#pro-operation-countdown"),{html:"<p>"+f+"开售:	</p><ul><li><span>{#day}</span></li><li><em>天</em></li><li><span>{#hours}</span></li><li><em>:</em></li><li><span>{#minutes}</span></li><li><em>:</em></li><li><span>{#seconds}</span></li>",now:c,endTime:i,callback:function(j){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDeposit(1);">支付订金</a>');if(rush.business.timer){clearInterval(rush.business.timer);rush.business.timer=null}}});rush.business.timer=$($("#pro-operation-countdown")).data("countdown");if(!rush.business.timer){$("#pro-operation").html('<a href="javascript:;" class="product-button02" onclick="ec.product.payDeposit(1);">支付订金</a>');if(rush.business.timer){clearInterval(rush.business.timer);rush.business.timer=null}}ec.product.refreshStyle()}if(e.end=="end"){$("#pro-operation").html('<a href="javascript:;" class="product-button02 disabled">活动已结束</a>');$("#pro-operation").css("visibility","visible");$("#product-operation").show();ec.product.refreshStyle()}if(b&&b.buttonMode==8){ec.product.rushbuyActivity(2)}else{$("#goAddressId").hide()}}})};function timestampToTime(b){var a=new Date(b);Y=a.getFullYear()+".";M=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+".";D=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ";h=(a.getHours()<10?"0"+a.getHours():a.getHours())+":";m=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes());return Y+M+D+h+m}ec.product.showDepositAgreement=function(){var a='<div class="box-agreement-area">'+ec.product.depositInfo.promoActivity.ruleText+"</div>";new ec.box(a,{boxclass:"ol_box_4 ol_box_agreement",title:"订金支付协议",width:678,height:350,autoHeight:false}).open()};ec.product.pushAddress=function(){var a="";if(ec.account.isLogin()){a="0"}else{a="1"}var b={UID:ec.util.cookie.get("uid"),TID:getPtid(),TIME:getTime(),CONTENT:{SKUCode:$("#pro-sku-code2").text(),login:a}};ec.code.addAnalytics({hicloud:true});_paq.push(["trackLink","3000020503","link",b])};ec.product.payDeposit=function(a){if(!$("#pro-agreement-area-check").attr("checked")){var b='<div class="box-prompt-error-area"><div class="b"><p>您必须先勾选同意订金支付协议，才可以进行订金支付。</p></div></div>';new ec.box(b,{boxclass:"ol_box_4",title:"温馨提示",showCancel:false}).open();return}ec.account.afterLogin(function(){ec.binding.cart.withPhone(function(){dealDepositInfo(a)})})};dealDepositInfo=function(f){var i=$("#pro-quantity").val();var l=ec.product.getSku()||ec.product.defaultSku;var e=[];var j={};j.itemId=$("#pro-sku-code").val();j.qty=$("#pro-quantity").val();j.itemType="S0";var b=ec.product.gift.finalMainSbomGiftMap[ec.product.getSku()];if(b&&f==1){var a=[];for(var o in b){var c={sbomCode:b[o].giftSkuCode};a.push(c)}j.gifts=a}if(f==2){$('[id="comb-pro-'+l+'"]').find("input[name=skuId]:checked").each(function(){var r={};r.itemId=$(this).attr("data-scode");r.qty=1;r.itemType="S0";e.push(r)})}var q=$("#extendSelect").attr("data-scode");var d=$("#accidentSelect").attr("data-scode");j.subOrderItemReqArgs=[];var n={};var g={};if(q.length>0){n.itemId=q;n.qty=$("#pro-quantity").val();n.itemType="S1";n.mainSkuCode=$("#pro-sku-code").val();j.subOrderItemReqArgs.push(n);if(d.length>0){g.itemId=d;g.qty=$("#pro-quantity").val();g.itemType="S6";g.mainSkuCode=$("#pro-sku-code").val();j.subOrderItemReqArgs.push(g)}}else{if(d.length>0){g.itemId=d;g.qty=$("#pro-quantity").val();g.itemType="S6";g.mainSkuCode=$("#pro-sku-code").val();j.subOrderItemReqArgs.push(g)}}e.push(j);var p=ec.lang.json.stringify(e);var k="";k+='<input name="orderReqJson" type="text" value=\''+p+"'>";k+='<input name="state" type="text" value="0">';$("#order-confirm-deposit-form").html(k).submit()};