ec.pkg("ec.member.orderList");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});ec.load("jquery.movebar");ec.member.orderList.openAddRemarkView=function(a){$.ajax({url:"/member/addUserRemarkView?orderCode="+a+"&t="+new Date().getTime(),dataType:"jsonp",success:function(c){var d=$(c);if(d.length==1&&d.hasClass("errorMsg")){var b=encodeURIComponent(d.text());window.location.href="/member/prdRemark/errorMsg?msg="+b}else{$("div.u-4-5").html(c);ec.member.add.showView()}}})};ec.member.orderList.getUserOrderRemarkStatus=function(c){if($("#colid").val()=="0"||c=="0"){return}var a="";var b=true;$(".button-operate-revie").each(function(){if(b){a=$(this).attr("orderInfo");b=false}else{a+=","+$(this).attr("orderInfo")}});if(a!=""){new ec.ajax().get({url:domainRms+"/comment/getOrderCommentStatus.json?t="+new Date().getTime(),dataType:"jsonp",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(d){$(".button-operate-revie").each(function(){var g;var f=$(this).attr("orderInfo");if(d.data&&d.data!=undefined){for(var e=0;e<d.data.length;e++){g=d.data[e];if((f==g.orderCode)&&(g.status==1)){$(this).attr("href","javascript:ec.member.orderList.commentsRealName("+g.orderCode+")");$(this).attr("title","我要评论");$(this).attr("innerHTML","<span>我要评论</span>");$(this).parent(".p-button").removeClass("hide")}}}})}})}};ec.member.orderList.commentsRealName=function(a){new ec.ajax().get({url:domainMain+"/member/addUserRemarkView.json?t="+new Date().getTime(),dataType:"json",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(b){if(b.success){window.location.href="/member/addUserRemarkView?orderCode="+a}else{ec.account.syncCustomSession(function(c){if(c==null||c.customerInfo.userState==null){window.location.href="/member/addUserRemarkView?orderCode="+a;return}else{ec.member.orderList.vildateComments(a)}})}}})};ec.member.orderList.vildateComments=function(a){new ec.ajax().get({url:domainMain+"/member/addUserRemarkView.json?t="+new Date().getTime(),dataType:"json",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(b){if(b.success){window.location.href="/member/addUserRemarkView?orderCode="+a}else{ec.member.orderList.commentsTip()}}})};ec.member.orderList.commentsTip=function(){new ec.box($("#realNameComment").val(),{boxclass:"ol_box_4",title:"",width:540,showButton:false,autoHeight:false,onok:function(){}}).open()};ec.ready(function(){$("#ec_ui_confirm").click(function(b){b=b||window.event;b.stopPropagation()});$(document).bind("click",function(c){var c=c||window.event;var b=c.target||c.srcElement;if(b.innerHTML!="取消订单"&&b.innerHTML!="删除订单"){$("#ec_ui_confirm").hide()}});$("#li-order").addClass("current");$("#pathTitle").html("我的订单");ec.member.orderList.interfaceTpl=new ec.template($("#interface-tpl").val());window.onhashchange=function(){var b=window.location.hash;if(b&&b.length>0){b=b.substring(1,b.length);if(b.length>0){ec.member.orderList.openAddRemarkView(b)}else{window.location.reload()}}else{window.location.reload()}};var a=window.location.hash;if(a&&a.length>0){a=a.substring(1,a.length);if(a.length>0){ec.member.orderList.openAddRemarkView(a);return}}ec.member.orderList.getUserOrderRemarkStatus();if($(".list-group-item").length<1){$("#order-merge-pay").hide()}});ec.member.orderList.load=function(d){var b,a,c,e;if($("#checkid").val()=="nocomment"){b=domainRms+"/comment/getNoCommentOrders.json?t="+new Date().getTime();a="jsonp";c=0;e={pageNum:d.pageNumber,pageSize:5}}else{b=domainMain+"/member/order.json?t="+new Date().getTime();a="json";c=1;e={dateType:$("#colid").val(),tab:$("#checkid").val(),pageNumber:d.pageNumber,pageSize:5}}new ec.ajax().get({url:b,dataType:a,data:e,timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:ec.ui.loading.hide,successFunction:function(f){if(0==c){if(f.resultCode!=0){if(f.resultCode=="42003"){ec.account.loginName="";ec.account.afterLogin(function(){ec.member.orderList.load(d)})}else{alert("很抱歉！订单列表查询失败，请稍后重新操作")}return}}else{if(!f.success){if(f.code=="login"){ec.account.loginName="";ec.account.afterLogin(function(){ec.member.orderList.load(d)})}else{alert("很抱歉！订单列表查询失败，请稍后重新操作")}return}}ec.member.orderList.push(f,c);if(f.orderList&&f.orderList.length>0){if($("input[name='payCheck']").length==0||$("input[name='payCheck']").length==1){$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false);$("#myOrder-control-bottom").show();$("#myOrder-control-bottom-up").show()}}else{$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}}})};ec.member.orderList.push=function(v,r){var h=[],m,u,d,g,o=$("#colid").val(),l="",w="",b="";if(0==r){d=v.data.orderList;g=v.data.page}else{d=v.orderList;g=v.page}if(d&&d.length>0){for(var t=0;t<d.length;t++){m=d[t];u=(o==0&&m.isHisData==0)?"0":"1",b=(m.paymentStatus==1)?"已付款":"待支付";if(m.orderStatus=="4"||m.orderStatus=="8"){l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=b}else{if(m.orderStatus=="7"){l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=m.orderStatusText+"&nbsp;|&nbsp;"+b}else{l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=(m.orderStatus=="6")?b:(m.orderStatusText+"&nbsp;|&nbsp;"+b)}}h.push('<div class="list-group-item"><div class="o-info">');if(m.orderStatus==8){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">');if(m.paymentStatus==1){h.push("已取消&nbsp;|&nbsp;已付款")}else{if(m.paymentStatus==2){h.push("已取消")}else{if(m.paymentStatus==3){if(m.type==18){h.push("已支付订金")}else{h.push("已部分付款")}}else{h.push("待支付")}}}h.push("</div>")}else{if(m.orderStatus==12){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">');if(m.paymentStatus==2){h.push("关闭支付&nbsp;|&nbsp;未支付")}else{if(m.paymentStatus==1){h.push("关闭支付&nbsp;|&nbsp;已支付")}else{h.push("关闭支付&nbsp;|&nbsp;待支付")}}h.push("</div>")}else{if(m.orderStatus==7){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==26){h.push('<span class="icon-priority"></span>')}if(m.type==28){}else{h.push('<span class="o-logistics">');h.push('<a href="javascript:;" onmouseover="ec.member.orderList.openLog(this, '+m.orderCode+')">物流信息</a>');h.push('<div class="o-logistics-record" id="interface-dialog-'+m.orderCode+'">');h.push('<div class="o-logistics-list" id="interface-msg-'+m.orderCode+'">');h.push('<div class="o-logistics-list-loading">加载中</div></div><s></s></div></span>')}h.push('</div><div class="col-state">'+m.orderStatusText+"&nbsp;|&nbsp;");if(m.paymentStatus==1){h.push("已付款")}else{if(m.paymentStatus==2){h.push("已取消")}else{h.push("待支付")}}h.push("</div>")}else{h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==26){h.push('<span class="icon-priority"></span>')}if(m.orderStatus==6){h.push('<span class="o-logistics">');h.push('<a href="javascript:;" onmouseover="ec.member.orderList.openLog(this, '+m.orderCode+')">物流信息</a>');h.push('<div class="o-logistics-record" id="interface-dialog-'+m.orderCode+'">');h.push('<div class="o-logistics-list" id="interface-msg-'+m.orderCode+'">');h.push('<div class="o-logistics-list-loading">加载中</div></div><s></s></div></span>')}h.push('</div><div class="col-state">');if(m.orderStatus==4){h.push("审核未通过&nbsp;|&nbsp;")}else{if(m.orderStatus==12){h.push("关闭支付&nbsp;|&nbsp;")}else{if(m.orderStatus==3){h.push("审核通过&nbsp;|&nbsp;")}else{if(m.orderStatus==9){h.push("正在出库&nbsp;|&nbsp;")}else{if(m.orderStatus==5){h.push("已出库&nbsp;|&nbsp;")}else{if(m.orderStatus==6||m.orderStatus==15){h.push("已发货&nbsp;|&nbsp;")}else{if(m.orderStatus==7){h.push("已完成&nbsp;|&nbsp;")}else{if(m.orderStatus==14){h.push("已拒收&nbsp;|&nbsp;")}else{if(m.orderStatus==16){h.push("取消处理中&nbsp;|&nbsp;")}else{if(m.orderStatus==17){h.push("修改处理中&nbsp;|&nbsp;")}else{h.push(m.orderStatusText+"&nbsp;|&nbsp;")}}}}}}}}}}if(m.paymentStatus==1){h.push("已付款")}else{if(m.paymentStatus==3){h.push("已部分付款")}else{h.push("待支付")}}h.push("</div>")}}}h.push('</div><div class="o-pro"><table border="0" cellpadding="0" cellspacing="0"><tbody>');h.push(ec.member.orderList.productList(m));h.push("</tbody></table></div>");if(m.type==18){h.push(ec.member.orderList.depositList(m))}h.push("</div>")}$("#list-group").html(h.join(""));if($("#checkid").val()=="nocomment"){var c=[];for(var t=0;t<d.length;t++){for(var s=0;s<d[t].productList.length;s++){c.push(d[t].productList[s].skuCode);for(var q=0;q<d[t].productList[s].giftList.length;q++){c.push(d[t].productList[s].giftList[q].giftSkuCode)}}for(var s=0;s<d[t].bundlerList.length;s++){for(var q=0;q<d[t].bundlerList[s].productList.length;q++){c.push(d[t].bundlerList[s].productList[q].skuCode);for(var f=0;f<d[t].bundlerList[s].productList[q].giftList.length;f++){c.push(d[t].bundlerList[s].productList[q].giftList[f].giftSkuCode)}}}}var n=c.length;if(n<=50){ec.member.orderList.loadImg(c)}else{var e=Math.ceil(n/50);for(var t=0;t<e;t++){var s=t*50;if((t+1)==e){ec.member.orderList.loadImg(c.slice(s,n))}else{ec.member.orderList.loadImg(c.slice(s,s+50))}}}$(".button-operate-revie").each(function(){var x;var k=$(this).attr("orderInfo");if(d&&d.length>0){for(var j=0;j<d.length;j++){x=d[j];if(k==x.orderCode){$(this).attr("href","javascript:ec.member.orderList.commentsRealName("+x.orderCode+")");$(this).attr("title","我要评论");$(this).attr("innerHTML","<span>我要评论</span>");$(this).parent(".p-button").removeClass("hide")}}}});ec.member.orderList.renderPage(g)}else{ec.member.orderList.renderPage(g);ec.ui.scrollTo("#myOrder-cate");ec.member.orderList.getUserOrderRemarkStatus(u);ec.member.orderList.payClick()}}else{ec.member.orderList.bottomCheckBoxDisplay(false);$("#list-group").html('<div class="list-group-empty">您暂时没有相关记录。</div>');$("#list-pager").html("");ec.member.orderList.getUserOrderRemarkStatus(u);ec.member.orderList.payClick()}};ec.member.orderList.loadImg=function(a){new ec.ajax().get({url:pmsHttpDomain+"product/querySbomInfoByCode.json?t="+new Date().getTime()+"&sbomCode="+a.join("&sbomCode="),async:false,dataType:"jsonp",timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(c){if(!c.success){alert("很抱歉！商品图片查询失败，请稍后重新操作");return}for(var b=0;b<c.data.length;b++){$(".nocomment-"+c.data[b].sbomCode).attr("src",ec.mediaPath+"/"+c.data[b].photoPath+"100_100_"+c.data[b].photoName).attr("alt",c.data[b].name);$(".nocomment-"+c.data[b].sbomCode).parent("a").attr("href","/product/"+c.data[b].prdId+".html#"+c.data[b].sbomId);$(".nocomment-"+c.data[b].sbomCode).attr("href","/product/"+c.data[b].prdId+".html#"+c.data[b].sbomId);if($(".pl-"+c.data[b].sbomCode).html()){$(".pl-"+c.data[b].sbomCode).attr("orderinfo",$(".pl-"+c.data[b].sbomCode).attr("orderinfo").replace("${proId}",c.data[b].prdId))}}ec.member.orderList.bottomCheckBoxDisplay(true);ec.ui.scrollTo("#myOrder-cate");ec.member.orderList.payClick()}})};ec.member.orderList.bottomCheckBoxDisplay=function(a){if(a&&$("#checkid").val()!="nocomment"){$("#myOrder-control-bottom").show();$("#bottomCheckAllBox").attr("checked",false)}else{$("#myOrder-control-bottom").hide()}};ec.member.orderList.productList=function(m){var s=[],w,F,f=0,h=0,u=0,r,l,e,x,d,a="立即支付",t=false,A=["支付宝","网银支付","货到付款","退换货","快捷支付","","财付通","华为支付","线下支付","银联在线支付"],y=$("#colid").val(),C=(y==0&&m.isHisData==0)?"0":"1",l=m.paymentList||[];if(l.length>0){x="66";d="BALANCE";for(var B=0;B<l.length;B++){if(l[B].paymentMethod!="BALANCE"&&l[B].paymentType!="66"){x=l[B].paymentType;d=l[B].paymentMethod}}}_showPaymentText=function(g,b){g=parseInt(g,10);if(!g||g<1||!b){return""}if(b=="BALANCE"&&g=="66"){return"代金券支付"}if(g==17){return"微信支付"}if(g==1&&b=="HB"){return"花呗支付"}if(g==17||g==67){return"微信支付"}if(g==82&&b=="CMBLIFE_CMBLIFE"){return"掌上生活"}if(g==82&&b=="ICBC_ICBC"){return"工行信用卡支付"}if(g==82&&b=="ABC_ABC"){return"农行信用卡支付"}if(g==82&&b=="BOC_BOC"){return"中行信用卡支付"}if(g==84){return"网银支付"}if(g==86||g==87){return"快捷支付"}if(g==83&&b=="UNIONPAY_UNIONPAY"){return"银联在线支付"}if(g==83&&b=="HUAWEIPAY_HUAWEIPAY"){return"银联云闪付（Huawei Pay）"}if(g-1>9){return"在线支付"}return A[g-1]};r=m.bundlerList||[];e=m.productList||[];isRefund=m.isRefund;if(m.paymentStatus==3){a="支付余款"}if(r.length>0){for(var B=0;B<r.length;B+=1){f=f+r[B].productList.length}}if(e.length>0){h=e.length;for(var B=0;B<h;B+=1){if(e[B].giftList){u+=e[B].giftList.length}}}var G=0;if(r.length>0){for(var B=0;B<r.length;B+=1){F=r[B];q=F.productList.length;for(var D=0;D<q;D+=1){var w=F.productList[D];if(w.giftList&&w.giftList.length>0){G=G+w.giftList.length}}}}var q=0,o=0,n=0,k=[];for(var B=0;B<r.length;B+=1){F=r[B];q=F.productList.length;for(var D=0;D<q;D+=1){var w=F.productList[D];if(w.giftList&&w.giftList.length>0){n=w.giftList.length;o=o+n;for(var E=0;E<n;E+=1){var v=w.giftList[E];k.push('<tr><td class="col-pro-img"><p class="p-img">');k.push('<a title="'+v.giftName+'" href="/product/'+v.productId+".html#"+v.giftSkuId+'" target="_blank" >');if(v.photoPath){k.push('<img class="nocomment-'+v.skuCode+'" alt="'+v.giftName+'" src="'+ec.mediaPath+"/"+v.photoPath+"100_100_"+v.photoName+'"/>')}else{k.push('<img class="nocomment-'+v.giftSkuCode+'" alt="" src=""/>')}k.push('</a></p><s class="p-tag"><i class="tag-accessory"></i></s>');k.push('</td><td class="col-pro-info"><p class="p-name">');k.push('<a class="nocomment-'+v.giftSkuCode+'"title="'+v.giftName+'" href="/product/'+v.productId+".html#"+v.giftSkuId+'" target="_blank">'+v.giftName+"</a>");k.push('</p></td><td class="col-price">--</td>');k.push('<td class="col-quty">'+v.quantity+"</td></tr>")}}}for(var z=0;z<q;z+=1){w=F.productList[z];s.push('<tr><td class="col-pro-img"><p class="p-img">');s.push('<a title="'+w.skuName+'" href="/product/'+w.productId+".html#"+w.skuId+'" target="_blank" onclick="pushProMsg('+w.skuId+",'300130101')\">");if(w.photoPath){s.push('<img class="nocomment-'+w.skuCode+'" alt="'+w.skuName+'" src="'+ec.mediaPath+w.photoPath+"100_100_"+w.photoName+'"/>')}else{s.push('<img class="nocomment-'+w.skuCode+'" alt="" src=""/>')}s.push('</a></p></td><td class="col-pro-info"><p class="p-name">');if(w.productTypeInfo=="S0"||w.productTypeInfo=="P"){s.push("<b>[套餐]</b>")}s.push('<a class="nocomment-'+w.skuCode+'"title="'+w.skuName+'" target="_blank" href="/product/'+w.productId+".html#"+w.skuId+'" onclick="pushProMsg('+w.skuId+",'300130101')\">"+w.skuName+"</a>");s.push('</p></td><td class="col-price"><em>&yen;</em><span>');s.push((w.unitPrice||0).toFixed(2));s.push("</span></td>");if(z==0){s.push('<td class="col-quty" rowspan="'+q+'">'+F.quantity+"</td>");if(B==0){s.push('<td rowspan="'+(f+h+u+G)+'" class="col-pay">');s.push("<em>&yen;</em><span>"+m.paymentAmount.toFixed(2)+"</span>");if(l.length>0){s.push("<p><em>"+_showPaymentText(x,d)+"</em></p>")}s.push("</td>");if(m.orderStatus<5||m.orderStatus>7){s.push('<td rowspan="'+(f+h+u+G)+'" class="col-operate">');if(m.orderStatus==8||m.orderStatus==16||m.orderStatus==17){}else{if(m.orderStatus==4){if(m.type==19&&m.orderStatus!=14&&m.orderStatus!=11){s.push('<p class="p-link"><a href="/member/updateToOrder-'+m.orderCode+'">修改订单</a></p>');s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}else{if(m.orderStatus==12){}else{if(m.type&&m.type==3){}else{if(y==0||m.isHisData!=1){if(m.payFlag&&m.payFlag==1){if(m.type==18){if((m.paymentStatus==2||m.paymentAmountTotal<m.depositAmount)&&2!=m.isBalancePayStart){s.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+m.orderCode+'"><span>支付订金</span></a></p>')}else{if(m.paymentStatus==3&&m.isBalancePayStart==0){if(0!=m.cashPay){s.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+m.orderCode+'"><span>支付尾款</span></a></p>')}else{s.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>等待尾款确定</span></a></p>')}}else{if((m.paymentStatus==3&&m.isBalancePayStart==1)||m.isBalancePayStart==4){s.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>等待支付尾款</span></a></p>')}else{if((m.paymentStatus==2||m.paymentStatus==3)&&m.isBalancePayStart==2){s.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>支付时间已过</span></a></p>')}}}}}else{s.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+m.orderCode+'"><span>');s.push(a);s.push("</span></a></p>")}}if(m.type!=14&&m.type!=28){if(m.type!=5&&m.orderStatus!=14){if(m.orderStatus!=9&&m.orderStatus!=11){s.push('<p class="p-link"><a href="/member/updateToOrder-'+m.orderCode+'">修改订单</a></p>')}}if((m.type!=3&&m.type!=17&&m.orderStatus!=14)||(m.orderStatus==9)){if((m.type==9||m.type==25||m.type==19)&&m.orderStatus==9){}else{if(m.orderStatus!=11){s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}}}else{if(m.type==28){if(m.orderStatus<7){s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}else{if(m.orderStatus<7){s.push('<p class="p-link"><a href="/member/updateToOrder-'+m.orderCode+'">修改订单</a></p>');if(m.paymentStatus==2&&m.orderStatus!=11){s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}}}}}}}}if((m.orderStatus==8&&m.canceledOrderDelPermission)||(m.orderStatus==7&&(m.timeDifference>=16||ec.member.orderList.GetDateDiff(m.updateDate)>=16))){s.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+m.orderCode+"');\">删除订单</a></p>")}s.push('<p class="p-link"><a href="/member/order-'+m.orderCode+"?isHisData="+C+'">订单详情</a></p>');if(m.isRefund==1){s.push('<p class="p-link"><a href="/member/refund?ordercode='+m.orderCode+"&isLive="+C+'">退款详情</a></p>')}s.push("</td>")}}}if(m.orderStatus>=5&&m.orderStatus<=7){if(B==0&&z==0){s.push('<td rowspan="'+(f+h+u+G)+'" class="col-operate">');if(m.shopCode!="VMALL-HUAWEIDEVICE"&&m.orderStatus==6){s.push('<p class="p-button"><a class="button-operate-receipt" onclick="ec.member.orderList.confirmDelivery(this, '+w.orderCode+", "+w.orderStatus+')" target="_blank"><span>确认收货</span></a></p>')}if(m.shopCode=="VMALL-HUAWEIDEVICE"&&m.orderStatus==6){}if(!w.remarkId&&m.orderStatus==7){if(w.productId){s.push('<p class="p-button hide"><a class="button-operate-revie pl-'+w.skuCode+'" href="javascript:;" orderInfo = "'+m.orderCode+'"><span>我要评论</span></a></p>')}else{s.push('<p class="p-button hide"><a class="button-operate-revie pl-'+w.skuCode+'" href="javascript:;" orderInfo = "'+m.orderCode+'"><span>我要评论</span></a></p>')}}var c=w.productType!=2&&m.type!=12&&m.type!=14&&m.type!=28&&m.type!=3&&m.type!=9&&m.type!=19&&m.orderStatus==7;if(y==0){if(m.orderStatus==7&&(m.timeDifference>=16||ec.member.orderList.GetDateDiff(m.updateDate)>=16)){s.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+m.orderCode+"');\">删除订单</a></p>")}else{if(c){s.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+m.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+m.orderCode+')">退换货</a></p>')}}}else{if(m.orderStatus==7&&(m.timeDifference>=16||ec.member.orderList.GetDateDiff(m.updateDate)>=16)){s.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+m.orderCode+"');\">删除订单</a></p>")}else{if(c){s.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+m.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+m.orderCode+')">退换货</a></p>')}}}s.push('<p class="p-link"><a href="/member/order-'+m.orderCode+"?isHisData="+C+'">订单详情</a></p>');if(m.isRefund==1){s.push('<p class="p-link"><a href="/member/refund?ordercode='+m.orderCode+"&isLive="+C+'">退款详情</a></p>')}s.push("</td>")}}s.push("</tr>")}}if(k){s.push(k.join(""))}for(var B=0;B<e.length;B++){w=e[B];q=(w.giftList)?(w.giftList.length+1):1;s.push('<tr><td class="col-pro-img"><p class="p-img">');s.push('<a title="'+w.skuName+'" href="/product/'+w.productId+".html#"+w.skuId+'" target="_blank" onclick="pushProMsg('+w.skuId+",'300130101')\">");if(w.photoPath){s.push('<img class="nocomment-'+w.skuCode+'" alt="'+w.skuName+'" src="'+ec.mediaPath+w.photoPath+"100_100_"+w.photoName+'"/>')}else{s.push('<img class="nocomment-'+w.skuCode+'" alt="" src=""/>')}s.push('</a></p></td><td class="col-pro-info"><p class="p-name">');s.push('<a title="'+w.skuName+'" target="_blank" ');s.push('class="nocomment-'+w.skuCode+'"href="/product/'+w.productId+".html#"+w.skuId+'" onclick="pushProMsg('+w.skuId+",'300130101')\">"+w.skuName+"</a>");s.push('</p></td><td class="col-price">');if(m.type==18&&w.productType==4&&m.balanceAmount==null){s.push("<span>");s.push("暂无报价")}else{s.push("<em>&yen;</em><span>");s.push((w.unitPrice||0).toFixed(2))}s.push('</span></td><td class="col-quty">');s.push(w.quantity+"</td>");if(0>=f){if(B==0){s.push('<td rowspan="'+(h+u)+'" class="col-pay">');s.push("<p><em>&yen;</em><span>");if(m.type==18){s.push(m.paymentAmountTotal.toFixed(2)+"</span></p>")}else{s.push(m.paymentAmount.toFixed(2)+"</span></p>")}if(l.length>0){s.push("<p><em>"+_showPaymentText(x,d)+"</em></p>")}s.push("</td>")}if(B==0&&(m.orderStatus<5||m.orderStatus>7)){s.push('<td rowspan="'+((f+h+u+G))+'" class="col-operate">');if((m.paymentType==1||m.paymentType==2||m.paymentType==5)&&m.paymentStatus==2&&m.orderStatus!=4&&m.orderStatus!=8){}if(m.orderStatus==8||m.orderStatus==16||m.orderStatus==17){}else{if(m.orderStatus==4){if(m.type==19&&m.orderStatus!=14&&m.orderStatus!=11){s.push('<p class="p-link"><a href="/member/updateToOrder-'+m.orderCode+'">修改订单</a></p>');s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}else{if(m.orderStatus==12){}else{if(m.type&&m.type==3){}else{if(y==0||m.isHisData!=1){if(m.payFlag&&m.payFlag==1){if(m.type==18){var c=(m.paymentStatus==2||m.paymentAmountTotal<m.depositAmount)&&2!=m.isBalancePayStart;if(c){s.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+m.orderCode+'"><span>支付订金</span></a></p>')}else{if(m.paymentStatus==3&&m.isBalancePayStart==0){if(0!=m.cashPay){s.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+m.orderCode+'"><span>支付尾款</span></a></p>')}else{s.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>等待尾款确定</span></a></p>')}}else{if((m.paymentStatus==3&&m.isBalancePayStart==1)||m.isBalancePayStart==4){s.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>等待支付尾款</span></a></p>')}else{if((m.paymentStatus==2||m.paymentStatus==3)&&m.isBalancePayStart==2){s.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>支付时间已过</span></a></p>')}}}}}else{s.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+m.orderCode+'"><span>');s.push(a);s.push("</span></a></p>")}}if(m.type!=14&&m.type!=28){if(m.type!=5&&m.orderStatus!=14){if(m.orderStatus!=9&&m.orderStatus!=11){s.push('<p class="p-link"><a href="/member/updateToOrder-'+m.orderCode+'">修改订单</a></p>')}}if((m.type!=3&&m.type!=17&&m.orderStatus!=14)||(m.orderStatus==9)){if((m.type==9||m.type==25||m.type==19)&&m.orderStatus==9){}else{if(m.orderStatus!=11){s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}}}else{if(m.type==28){if(m.orderStatus<7){s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}else{if(m.orderStatus<7){s.push('<p class="p-link"><a href="/member/updateToOrder-'+m.orderCode+'">修改订单</a></p>');if(m.paymentStatus==2&&m.orderStatus!=11){s.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+m.orderCode+'" onclick="ec.member.orderList.cancel(this, '+m.paymentStatus+","+m.type+');">取消订单</a></p>')}}}}}}}}}if((m.orderStatus==8&&m.canceledOrderDelPermission)||(m.orderStatus==7&&(m.timeDifference>=16||ec.member.orderList.GetDateDiff(m.updateDate)>=16))){s.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+m.orderCode+"');\">删除订单</a></p>")}s.push('<p class="p-link"><a href="/member/order-'+m.orderCode+"?isHisData="+C+'">订单详情</a></p>');if(m.isRefund==1){s.push('<p class="p-link"><a href="/member/refund?ordercode='+m.orderCode+"&isLive="+C+'">退款详情</a></p>')}s.push("</td>")}}if(m.orderStatus>=5&&m.orderStatus<=7){if(0>=f&&B==0){s.push('<td rowspan="'+(f+h+u+G)+'" class="col-operate">');if(m.shopCode!="VMALL-HUAWEIDEVICE"&&m.orderStatus==6){s.push('<p class="p-button"><a class="button-operate-receipt" onclick="ec.member.orderList.confirmDelivery(this, '+w.orderCode+", "+w.orderStatus+')" target="_blank"><span>确认收货</span></a></p>')}if(m.shopCode=="VMALL-HUAWEIDEVICE"&&m.orderStatus==6){}if(!w.remarkId&&m.orderStatus==7){if(w.productId){s.push('<p class="p-button hide"><a class="button-operate-revie pl-'+w.skuCode+'" href="javascript:;" orderInfo="'+m.orderCode+'"><span>我要评论</span></a></p>')}else{s.push('<p class="p-button hide"><a class="button-operate-revie pl-'+w.skuCode+'" href="javascript:;" orderInfo="'+m.orderCode+'"><span>我要评论</span></a></p>')}}var c=w.productType!=2&&m.type!=12&&m.type!=14&&m.type!=28&&m.type!=3&&m.type!=9&&m.type!=19&&m.orderStatus==7;if(y==0){if(m.orderStatus==7&&(m.timeDifference>=16||ec.member.orderList.GetDateDiff(m.updateDate)>=16)){s.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+m.orderCode+"');\">删除订单</a></p>")}else{if(c){s.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+m.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+m.orderCode+')">退换货</a></p>')}}}else{if(m.orderStatus==7&&(m.timeDifference>=16||ec.member.orderList.GetDateDiff(m.updateDate)>=16)){s.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+m.orderCode+"');\">删除订单</a></p>")}else{if(c){s.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+m.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+m.orderCode+')">退换货</a></p>')}}}s.push('<p class="p-link"><a href="/member/order-'+m.orderCode+"?isHisData="+C+'">订单详情</a></p>');if(m.isRefund==1){s.push('<p class="p-link"><a href="/member/refund?ordercode='+m.orderCode+"&isLive="+C+'">退款详情</a></p>')}s.push("</td>")}}s.push("</tr>");if(w.giftList&&w.giftList.length>0){s.push(ec.member.orderList.giftList(w.giftList))}}return s.join("")};ec.member.orderList.giftList=function(c){var b=[];for(var a=0;a<c.length;a++){gif=c[a];b.push('<tr><td class="col-pro-img"><p class="p-img">');b.push('<a title="'+gif.giftName+'" href="/product/'+gif.productId+".html#"+gif.giftSkuId+'" target="_blank" >');if(gif.photoPath){b.push('<img class="nocomment-'+gif.skuCode+'" alt="'+gif.giftName+'" src="'+ec.mediaPath+gif.photoPath+"100_100_"+gif.photoName+'" />')}else{b.push('<img class="nocomment-'+gif.giftSkuCode+'" alt="" src="" />')}b.push('</a></p><s class="p-tag"><i class="tag-accessory"></i></s>');b.push('</td><td class="col-pro-info"><p class="p-name">');b.push('<a class="nocomment-'+gif.skuCode+'"title="'+gif.giftName+'" href="/product/'+gif.productId+".html#"+gif.giftSkuId+'" target="_blank">'+gif.giftName+"</a>");b.push('</p></td><td class="col-price">--</td><td class="col-quty">');b.push(gif.quantity+"</td></tr>")}return b.join("")};ec.member.orderList.skuList=function(c){var b=[];if(c!=null&&c.length>0){for(var a=0;a<c.length;a+=1){b.push("<em>"+c[a]+"</em>")}}return b.join("")};ec.member.orderList.depositList=function(a){var b=[];b.push('<div class="o-deposit">');b.push('<table border="0" cellpadding="0" cellspacing="0">');b.push('<tbody><tr><td class="col-deposit"><p class="d-name">阶段1：订金</p></td>');b.push('<td class="col-price"><em>¥</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-quty">-</td>');if(a.paymentStatus==2){b.push('<td class="col-pay"><span>--</span></td>');b.push('<td class="col-operate">待支付</td>')}else{if(a.paymentStatus==3){if(a.paymentAmountTotal>=a.depositAmount){b.push('<td class="col-pay"><em>¥</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-operate">已支付</td>')}else{if(a.paymentAmountTotal<a.depositAmount&&a.paymentAmountTotal>0){b.push('<td class="col-pay"><em>¥</em><span>'+a.paymentAmountTotal.toFixed(2)+"</span></td>");b.push('<td class="col-operate">部分支付订金</td>')}}}else{b.push('<td class="col-pay"><em>¥</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-operate">已支付</td>')}}b.push('</tr><tr class="disabled">');if(a.balanceStartTime!=""&&a.balanceStartTime!=null){b.push('<td class="col-deposit">阶段2：尾款('+a.balanceStartTime+"至"+a.balanceEndTime+"支付)</td>")}else{b.push('<td class="col-deposit">阶段2：尾款(暂时无法获取尾款支付时间，请您稍后再试试)')}b.push('<td class="col-price">');if(null!=a.balanceAmount){b.push("<em>¥</em><span>");b.push((a.balanceAmount).toFixed(2))}else{b.push("<span>");b.push("暂无报价")}b.push("</span></td>");b.push('<td class="col-quty">-</td>');b.push('<td class="col-pay">');if(null!=a.balancePay){b.push("<em>¥</em><span>");b.push(a.balancePay.toFixed(2))}else{b.push("<span>");b.push("--")}b.push("</span></td>");if(a.paymentStatus==1){b.push('<td class="col-operate">已支付</td>')}else{if(a.paymentStatus==2&&a.isBalancePayStart==0){b.push('<td class="col-operate">待支付</td>')}else{if(a.isBalancePayStart==0){if(a.paymentAmountTotal<=a.depositAmount){b.push('<td class="col-operate">待支付</td>')}else{if(a.paymentAmountTotal<a.cashPay&&a.paymentAmountTotal>a.depositAmount){b.push('<td class="col-operate">部分支付尾款</td>')}else{if(a.paymentAmountTotal==a.cashPay){b.push('<td class="col-operate">已支付</td>')}}}}else{if(a.isBalancePayStart==1){b.push('<td class="col-operate">支付时间未到</td>')}else{if(a.isBalancePayStart==4){b.push('<td class="col-operate"></td>')}else{if(a.isBalancePayStart==2){b.push('<td class="col-operate">支付期已过</td>')}}}}}}b.push("</tr></tbody></table></div>");return b.join("")};ec.member.orderList.exchangeTip=function(a){new ec.box($("#exchange-agreement").val(),{boxclass:"ol_box_4 ol_box_agreement",title:"退换货办理协议",width:678,height:350,autoHeight:false,onok:function(){location.href=$(a).attr("data-href")}}).open()};ec.member.orderList.exchangeTip=function(b,a){$.ajax({type:"POST",url:"/member/exchange/getReturnExchangeFlag.json",data:{orderCode:a,isLive:$("#colid").val()},async:false,dataType:"json",success:function(c){if(null!=c&&c.success){var d=c.returnExchangeFlag;if(d==0){new ec.box($("#exchange-timeout").val(),{boxclass:"ol_box_4",width:528,height:300,autoHeight:false,showButton:false}).open()}else{new ec.box($("#exchange-agreement").val(),{boxclass:"ol_box_4 ol_box_agreement",title:"退换货办理协议",width:678,height:350,autoHeight:false,onok:function(){location.href=$(b).attr("data-href")+"/"+d}}).open()}}else{alert("获取请求失败");return false}}})};ec.member.orderList.del=function(c,a){var b='<span style="font-size:16px;">确认删除此订单?</span><br/><span style="font-size:14px;color:#333;">订单删除后将无法恢复,请谨慎操作!</span>';if(ec.ui.confirm(c,b)){new ec.ajax().get({url:"/member/order/del/"+a+".json",data:{isLive:$("#colid").val()},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:ec.ui.loading.hide,successFunction:function(e){var f="";if(!e.success){var f="登录已超时,请重新登录";var d=[];if(e.code!="login"){f=e.msg}d.push('<div class="box-prompt-error-area">');d.push('<div class="h"><i></i></div>');d.push('<div class="b"><span id="prompt-delorder" style="color:#3a3a3a;">'+f+"</span></div>");d.push("</div>");d.push('<div class="box-custom-button"><a class="box-ok box-button-style-1" href="javascript:;"><span>确定</span></a></div>');$("#msg-delorder-ok").html(d.join(""))}else{var d=[];d.push('<div class="box-prompt-success-area">');d.push('<div class="h"><i></i></div>');d.push('<div class="b"><span id="prompt-delorder">温馨提示：订单删除成功</span></div>');d.push("</div>");d.push('<div class="box-custom-button"><a class="box-ok box-button-style-1" href="javascript:;"><span>确定</span></a></div>');$("#msg-delorder-ok").html(d.join(""))}new ec.box($("#msg-delorder-ok").val(),{boxclass:"ol_box_4",boxid:"orderDelBox",title:"",width:600,modal:true,showButton:false,onok:function(g){if(e.code!="login"){window.location.href="/member/order?t="+new Date().getTime()}g.close()},onclose:function(g){if(e.code!="login"){window.location.href="/member/order?t="+new Date().getTime()}}}).open()}})}};var _del;ec.member.orderList.cancel=function(d,b,c){$("#cancelReson").val("");var a=$(d).attr("data-ordercode");_del=function(e){if(e){e.close()}new ec.ajax().get({url:"/member/cancelOrder-"+a+".json",data:{cancelReson:$("#cancelReson").val()},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},errorFunction:function(f){ec.ui.loading.hide()},afterSendFunction:ec.ui.loading.hide,successFunction:function(i){if(!i.success){ec.showError(i);return}var h=[],k=i.order;var f=$(d).closest("td").html("<p class='p-link'><a href='/member/order-"+k.code+"' >订单详情</a></p>").closest(".list-group-item");var g=f.find(".o-info");var j="已取消";if(i.orderStatus==16){j="取消处理中"}if(k.paymentStatus=="1"){j+="&nbsp;|&nbsp;已付款"}g.find(".col-state").html(j);h.push('<div class="col-info">');if(k.type!=18&&(k.paymentStatus==2||k.paymentStatus==3)&&(k.orderStatus==3||(k.orderStatus<3&&k.orderSource!=2))){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+k.paymentStatus+'" value="'+k.orderCode+'"/>')}h.push('<span class="o-date">');h.push(new Date(k.orderDate).format("yyyy-MM-dd HH:mm"));h.push('</span><span class="o-no">');h.push('订单号：<a href="/member/order-'+k.code+'" title="'+k.code+'">'+k.code+"</a></span>");if(k.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">'+j+"</div></div>");g.html(h.join(""));ec.member.orderList.orderCount();ec.member.orderList.box=new ec.box($("#cancel-msg-tpl").val(),{boxclass:"ol_box_4",title:"订单取消申请已提交",showButton:false,onok:function(l){l.close()}}).open();return}})};ec.member.orderList.box=new ec.box($("#order-cancel").val(),{boxclass:"ol_box_4",title:"订单取消申请",boxid:"orderDelBox",width:800,modal:true,showButton:false,}).open();ec.member.orderList.orderCount()};ec.member.orderList.seltime=function(g,c){if($(g).parent("li").hasClass("current")){return}$("#colid").val(c);$("#checkid").val("all");$("#myOrder-cate li").removeClass("current");$("#myOrder-cate li:first").addClass("current");$(g).parent("li").addClass("current").siblings().removeClass("current");var a={pageNumber:1},d=$("#count-seltime-2").attr("data-num"),b=$("#count-seltime-3").attr("data-num"),f=$("#nocommentNum").attr("data-num"),e=$("#nocommentNum").attr("data-his");ec.member.orderList.load(a,c);if(c==0){$("#nocommentNum").parents("li").hide();$("#nocommentNum").text(e);if(e>0){$("#nocommentNum").show()}else{$("#nocommentNum").hide()}$("#count-seltime-2").text(0).closest("li").hide();$("#count-seltime-3").text(0).closest("li").hide()}else{$("#nocommentNum").parents("li").show();$("#count-seltime-2").text(d).closest("li").show();if(d>0){$("#count-seltime-2").show()}else{$("#count-seltime-2").hide()}$("#count-seltime-3").text(b).closest("li").show();if(b>0){$("#count-seltime-3").show()}else{$("#count-seltime-3").hide()}$("#nocommentNum").text(f);if(f>0){$("#nocommentNum").show()}else{$("#nocommentNum").hide()}}};ec.member.orderList.check=function(c,b){if($(c).parent("li").hasClass("current")){return}$("#checkid").val(b);$(c).parent("li").addClass("current").siblings().removeClass("current");var a={pageNumber:1};ec.member.orderList.load(a,b)};ec.member.orderList.renderPage=function(a){if(a.totalPage==1){$("#list-pager").hide();return}else{$("#list-pager").show()}$("#list-pager").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:5,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.member.orderList.load})};ec.member.orderList.openLog=function(e,c){var b="/member/logisticslog.json",f=ec.member.orderList,d=$("#interface-dialog-"+c),a=$("#interface-msg-"+c);new ec.ajax().get({url:b,data:{orderCode:c,isHisData:$("#colid").val()},timeout:10000,timeoutFunction:function(){a.html('<div class="o-logistics-list-loading">超时，请重试！</div>')},successFunction:function(g){if(!g.success){a.html('<div class="o-logistics-list-loading">超时，请重试！</div>');return}if((null!=g.logisticsLogList)&&(g.logisticsLogList.length>0)){a.html(ec.member.orderList.interfaceTpl.parse("interface",g.logisticsLogList))}else{a.html('<div class="o-logistics-list-empty">暂无物流信息</div>')}$(".o-logistics tbody tr:first").addClass("tr-latest")}})};ec.member.orderList.confirmDelivery=function(c,a,b){new ec.box($("#box-confirm").val(),{boxclass:"ol_box_4",width:600,title:"确认收货成功",showButton:false,onok:function(d){new ec.ajax().get({url:"/member/confirmDelivery-"+a+".json",timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:ec.ui.loading.hide,successFunction:function(e){if(!e.success){alert("确认收货失败！");return}$(c).hide();var f="/member/addUserRemarkView?orderCode="+a;d.setTitle("温馨提示");d.setContent($("#box-pj").val().replace("/member/prdRemarkView.html",f));d.setPosition()},errorFunction:function(){alert("确认收货失败！")}})}}).open()};ec.member.orderList.tapcheckAll=function(){if($("#checkAllBox").attr("checked")){$("input[name='payCheck']").each(function(){this.checked=true});$("#bottomCheckAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false});$("#bottomCheckAllBox").attr("checked",false)}};ec.member.orderList.mergePay=function(){var e=$("#topButton").attr("class");if(e=="button-operate-merge-pay"){var c="";var a=document.getElementsByName("payCheck");var b=ec.member.orderList.checkPayCheck(a);if(!b){alert("请选择要合并付款的订单")}else{for(var d=0;d<a.length;d++){if(a[d].checked){c+=a[d].value+"|"}}window.location.href="/payment/order-"+c}}};ec.member.orderList.checkPayCheck=function(c){var a=false;for(var b=0;b<c.length;b++){if(c[b].checked){a=true;break}}return a};ec.member.orderList.orderCount=function(){new ec.ajax().get({url:domainMain+"/member/orderCount.json?t="+new Date().getTime(),async:false,timeout:10000,successFunction:function(a){if(!a.success){return}var b=parseInt(a.orderCount.unpaidOrderCount+a.orderCount.partPaidOrderCount);if(b!=0){$("#count-seltime-2").show();$("#count-seltime-2").text(b);$("#count-seltime-2").attr("data-num",b)}else{$("#count-seltime-2").hide();$("#count-seltime-2").text(b);$("#count-seltime-2").attr("data-num",b)}$("#count-seltime-3").text(a.orderCount.unreceiptOrderCount?a.orderCount.unreceiptOrderCount:0);$("#count-seltime-3").attr("data-num",a.orderCount.unreceiptOrderCount?a.orderCount.unreceiptOrderCount:0)}})};ec.member.orderList.allOrderCount=function(){new ec.ajax().get({url:domainRms+"/comment/getNoCommentPrdCount.json?t="+new Date().getTime(),dataType:"jsonp",data:{tab:"nocomment",dateType:"1"},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(a){var b=parseInt($("#count-seltime-2-wechat").html())+parseInt($("#count-seltime-3-wechat").html());if(b>0){$("#li-order-small span").html("小程序订单<em>("+b+")</em>");ec.util.cookie.set("vmallOrderCountWechat",b)}else{$("#li-order-small span").html("小程序订单");ec.util.cookie.set("vmallOrderCountWechat",0)}if(a.resultCode!=0){alert("很抱歉！待评价查询失败，请稍后重新操作");return}var g,e,d,f;d=parseInt(a.data.count?a.data.count:0);f=0;if(d>0){$("#nocommentNum").text(d).show()}else{$("#nocommentNum").text(0).hide()}$("#nocommentNum").attr("data-num",d);$("#nocommentNum").attr("data-his",f);e=f;if(e>0){$("#count-seltime-1").text(e).show()}else{$("#count-seltime-1").text(0).hide()}g=parseInt(a.data.count?a.data.count:0)+parseInt($("#count-seltime-2").html())+parseInt($("#count-seltime-3").html());if(g>0){$("#count-seltime-0").text(g).show()}else{$("#count-seltime-0").text(0).hide()}var c=g+e;if(c>0){$("#li-order span").html("我的订单<em>("+c+")</em>");ec.util.cookie.set("vmallOrderCount",c)}else{$("#li-order span").html("我的订单");ec.util.cookie.set("vmallOrderCount",0)}$("#ec-tab").navMove({boxClass:"ec-tab-arrow"})}})};ec.member.orderList.urlStatus=function(){var a=window.location.href;if(a.search(/unpaid/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(1).find("a");ec.member.orderList.check(b,"unpaid")}else{if(a.search(/nocomment/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(2).find("a");ec.member.orderList.check(b,"nocomment")}else{if(a.search(/send/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(3).find("a");ec.member.orderList.check(b,"send")}}}};ec.member.orderList.payClick=function(){$("input[name='payCheck']").bind("click",function(){var a=0;$("input[name='payCheck']").each(function(b){if(this.checked){a++}});if(a==$("input[name='payCheck']").length&&$("input[name='payCheck']").length>1){$("#checkAllBox").attr("checked",true);$("#bottomCheckAllBox").attr("checked",true)}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false)}})};ec.ready(function(){if(ec.isIE6){$(".o-logistics").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})}$("#ec-tab").navMove({boxClass:"ec-tab-arrow"});ec.member.orderList.urlStatus();$("#checkAllBox").click(function(){if(this.checked){$("input[name='payCheck']").each(function(a){this.checked=true});$("#bottomCheckAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false});$("#bottomCheckAllBox").attr("checked",false)}});$("#bottomCheckAllBox").click(function(){if(this.checked){$("input[name='payCheck']").each(function(){this.checked=true});$("#checkAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false});$("#checkAllBox").attr("checked",false)}});ec.member.orderList.allOrderCount();ec.member.orderList.GetDateDiff=function(a){var c=a;var b=new Date().getTime();var d=parseInt(Math.abs(c-b)/(1000*60*60*24));return d}});$(function(){$("#cancelOption li").live("click",function(){$(this).children("input").attr("checked","checked");$("#selectReson").html($("input[name='resonType']:checked")[0].nextSibling.nodeValue);$("#cancelReson").val($("input[name='resonType']:checked").val());$("#selectReson").addClass("click");$("#cancelErrorMessage").hide();$(".order-cancel").find(".order-cancel-pulldown").css({border:"1px solid #d6d6d6"})});$("#okButton").live("click",function(){if($("#cancelReson").val()==""){$("#cancelErrorMessage").show();$(".order-cancel").find(".order-cancel-pulldown").css({border:"1px solid #ca141d"});return}_del();ec.member.orderList.box.close()});$("#cancelButton").live("click",function(){ec.member.orderList.box.close()});if($("input[name='payCheck']").length==0||$("input[name='payCheck']").length==1){$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}$("input[name='payCheck']").bind("click",function(){var a=0;$("input[name='payCheck']").each(function(b){if(this.checked){a++}});if(a==$("input[name='payCheck']").length&&$("input[name='payCheck']").length>1){$("#checkAllBox").attr("checked",true);$("#bottomCheckAllBox").attr("checked",true)}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false)}})});function pushProMsg(a,b){var c={UID:ec.util.cookie.get("uid"),TID:getPtid(),TIME:getTime(),CONTENT:{SKUID:a,click:"1"}};ec.code.addAnalytics({hicloud:true});_paq.push(["trackLink",b,"link",c])};